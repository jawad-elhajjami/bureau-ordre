/*! 20240429192337 - 20230504
* Dynamsoft JavaScript Library
* Product: Dynamic Web TWAIN
* Web Site: https://www.dynamsoft.com
*
* Copyright 2024, Dynamsoft Corporation
* Author: Dynamsoft Support Team
* Version: 18.5
*/
!function(){"use strict";function e(e,n,t,r,i,o,a){try{var s=e[o](a),u=s.value}catch(er){return void t(er)}s.done?n(u):Promise.resolve(u).then(r,i)}function n(n){return function(){var t=this,r=arguments;return new Promise((function(i,o){var a=n.apply(t,r);function s(n){e(a,i,o,s,u,"next",n)}function u(n){e(a,i,o,s,u,"throw",n)}s(undefined)}))}}function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}var r={exports:{}},i={exports:{}};!function(e){function n(t){return e.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports["default"]=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports}(i);var o=i.exports;!function(e){var n=o["default"];function t(){e.exports=t=function(){return r},e.exports.__esModule=!0,e.exports["default"]=e.exports;var r={},i=Object.prototype,o=i.hasOwnProperty,a=Object.defineProperty||function(e,n,t){e[n]=t.value},s="function"==typeof Symbol?Symbol:{},u=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function f(e,n,t){return Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}),e[n]}try{f({},"")}catch(O){f=function(e,n,t){return e[n]=t}}function d(e,n,t,r){var i=n&&n.prototype instanceof g?n:g,o=Object.create(i.prototype),s=new y(r||[]);return a(o,"_invoke",{value:w(e,t,s)}),o}function T(e,n,t){try{return{type:"normal",arg:e.call(n,t)}}catch(O){return{type:"throw",arg:O}}}r.wrap=d;var h={};function g(){}function p(){}function _(){}var m={};f(m,u,(function(){return this}));var S=Object.getPrototypeOf,I=S&&S(S(P([])));I&&I!==i&&o.call(I,u)&&(m=I);var E=_.prototype=g.prototype=Object.create(m);function v(e){["next","throw","return"].forEach((function(n){f(e,n,(function(e){return this._invoke(n,e)}))}))}function b(e,t){function r(i,a,s,u){var c=T(e[i],e,a);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==n(f)&&o.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,s,u)}),(function(e){r("throw",e,s,u)})):t.resolve(f).then((function(e){l.value=e,s(l)}),(function(e){return r("throw",e,s,u)}))}u(c.arg)}var i;a(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,i){r(e,n,t,i)}))}return i=i?i.then(o,o):o()}})}function w(e,n,t){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return D()}for(t.method=i,t.arg=o;;){var a=t.delegate;if(a){var s=C(a,t);if(s){if(s===h)continue;return s}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if("suspendedStart"===r)throw r="completed",t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);r="executing";var u=T(e,n,t);if("normal"===u.type){if(r=t.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:t.done}}"throw"===u.type&&(r="completed",t.method="throw",t.arg=u.arg)}}}function C(e,n){var t=n.method,r=e.iterator[t];if(undefined===r)return n.delegate=null,"throw"===t&&e.iterator["return"]&&(n.method="return",n.arg=undefined,C(e,n),"throw"===n.method)||"return"!==t&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+t+"' method")),h;var i=T(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,h;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=undefined),n.delegate=null,h):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function W(e){var n={tryLoc:e[0]};1 in e&&(n.catchLoc=e[1]),2 in e&&(n.finallyLoc=e[2],n.afterLoc=e[3]),this.tryEntries.push(n)}function A(e){var n=e.completion||{};n.type="normal",delete n.arg,e.completion=n}function y(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(W,this),this.reset(!0)}function P(e){if(e){var n=e[u];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var t=-1,r=function n(){for(;++t<e.length;)if(o.call(e,t))return n.value=e[t],n.done=!1,n;return n.value=undefined,n.done=!0,n};return r.next=r}}return{next:D}}function D(){return{value:undefined,done:!0}}return p.prototype=_,a(E,"constructor",{value:_,configurable:!0}),a(_,"constructor",{value:p,configurable:!0}),p.displayName=f(_,l,"GeneratorFunction"),r.isGeneratorFunction=function(e){var n="function"==typeof e&&e.constructor;return!!n&&(n===p||"GeneratorFunction"===(n.displayName||n.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,f(e,l,"GeneratorFunction")),e.prototype=Object.create(E),e},r.awrap=function(e){return{__await:e}},v(b.prototype),f(b.prototype,c,(function(){return this})),r.AsyncIterator=b,r.async=function(e,n,t,i,o){void 0===o&&(o=Promise);var a=new b(d(e,n,t,i),o);return r.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},v(E),f(E,l,"Generator"),f(E,u,(function(){return this})),f(E,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var n=Object(e),t=[];for(var r in n)t.push(r);return t.reverse(),function i(){for(;t.length;){var e=t.pop();if(e in n)return i.value=e,i.done=!1,i}return i.done=!0,i}},r.values=P,y.prototype={constructor:y,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method="next",this.arg=undefined,this.tryEntries.forEach(A),!e)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=undefined)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function t(t,r){return a.type="throw",a.arg=e,n.next=t,r&&(n.method="next",n.arg=undefined),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],a=i.completion;if("root"===i.tryLoc)return t("end");if(i.tryLoc<=this.prev){var s=o.call(i,"catchLoc"),u=o.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return t(i.catchLoc,!0);if(this.prev<i.finallyLoc)return t(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return t(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return t(i.finallyLoc)}}}},abrupt:function(e,n){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=n&&n<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=n,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(e,n){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&n&&(this.next=n),h},finish:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),A(t),h}},"catch":function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.tryLoc===e){var r=t.completion;if("throw"===r.type){var i=r.arg;A(t)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,t){return this.delegate={iterator:P(e),resultName:n,nextLoc:t},"next"===this.method&&(this.arg=undefined),h}},r}e.exports=t,e.exports.__esModule=!0,e.exports["default"]=e.exports}(r);var a=(0,r.exports)(),s=a;try{regeneratorRuntime=a}catch(za){"object"==typeof globalThis?globalThis.regeneratorRuntime=a:Function("r","regeneratorRuntime = r")(a)}var u,c,l=t(s);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function d(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function T(e){var n=function(e,n){if("object"!==f(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(t!==undefined){var r=t.call(e,n||"default");if("object"!==f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"===f(n)?n:String(n)}function h(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,T(r.key),r)}}function g(e,n,t){return n&&h(e.prototype,n),t&&h(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function p(e){var n=e?new Date(e):new Date,t="yyyy-MM-dd HH:mm:ss.SSSZ",r={"M+":n.getUTCMonth()+1,"d+":n.getUTCDate(),"H+":n.getUTCHours(),"h+":n.getUTCHours()%12||12,"m+":n.getUTCMinutes(),"s+":n.getUTCSeconds(),"q+":Math.floor((n.getUTCMonth()+3)/3),"S+":n.getUTCMilliseconds()};for(var i in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(n.getUTCFullYear()+"").substr(4-RegExp.$1.length))),r)new RegExp("("+i+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?r[i]:("000"+r[i]).substr(("000"+r[i]).length-RegExp.$1.length)));return t}function _(e){return e===c}function m(e){return e!==c}function S(e){return null===e}u="object"===("undefined"==typeof window?"undefined":f(window))?window:{};var I={"[object Function]":"function","[object AsyncFunction]":"function","[object String]":"string","[object Object]":"object","[object Boolean]":"boolean","[object Number]":"number","[object Array]":"array"};function E(e){return S(e)||_(e)?String(e):I[{}.toString.call(e)]||"object"}function v(e){return"function"===E(e)}function b(e){return"string"===E(e)}function w(e){return"object"===E(e)}function C(e){return"boolean"===E(e)}function W(e){return"number"===E(e)}function A(e){return Array.isArray?Array.isArray(e):"array"===E(e)}function y(e){if(null==e)return[];if(A(e))return e;var n=f(e.length),t=f(e);if("number"!==n||e.alert||"string"===t||"function"===t&&(!("item"in e)||"number"!==n))return[e];for(var r=[],i=0,o=e.length;i<o;i++)r[i]=e[i];return r}var P,D,O={debug:!1,showConsoleError:!1};function L(){return P}function N(e){P=e}function R(e,n,t,r){if(O.debug&&D&&v(D.log)){var i=p((new Date).getTime()),o=y(arguments);D.log(["[",i,"] ",o].join(""))}}function x(e,n,t,r){if((O.debug||O.showConsoleError)&&D&&v(D.error)){var i=p((new Date).getTime()),o=y(arguments);D.error(["[",i,"] ",o].join(""))}}function F(e,n,t,r){if(O.debug&&D&&v(D.warn)){var i=p((new Date).getTime()),o=y(arguments);D.warn(["[",i,"] ",o].join(""))}}function k(e,n,t,r){if(O.debug&&D&&v(D.info)){var i=p((new Date).getTime()),o=y(arguments);D.info(["[",i,"] ",o].join(""))}}u&&m(u.console)&&(v((D=u.console).log)&&v(D.error)?P={log:R,error:x,info:k,warn:F,debug:function(e,n,t,r){if(O.debug&&D&&v(D.debug)){var i=p((new Date).getTime()),o=y(arguments);D.debug(["[",i,"] ",o].join(""))}}}:(D=!1,P=!1));var M={queue:[],doNextStarted:!1,timer:null,pushToDo:function(e,n,t){M.queue.push({obj:e,method:n,args:t})},doNext:function(){if(M.doNextStarted)if(0!=M.queue.length){var e=M.queue[0],n=e.obj,t=e.method,r=e.args;if(M.queue.splice(0,1),n&&v(n[t])){var i=!1;if(r.length>2){var o=r[r.length-2],a=r[r.length-1];v(o)&&v(a)&&(r[r.length-2]=function(){try{o.apply(n,arguments)}catch(e){}M.timer=setTimeout(M.doNext,0)},r[r.length-1]=function(){try{a.apply(n,arguments)}catch(e){}M.timer=setTimeout(M.doNext,0)},i=!0)}try{n[t].apply(n,r)}catch(s){}i||(M.timer=setTimeout(M.doNext,0))}else if(null===n&&v(t)){try{t.apply(null,r)}catch(u){}M.timer=setTimeout(M.doNext,0)}else R("not invoke a function: "+t),M.timer=setTimeout(M.doNext,0)}else M.stop();else M.stop()},start:function(){M.doNextStarted||(M.doNextStarted=!0,M.timer=setTimeout(M.doNext,0))},stop:function(){clearTimeout(M.timer),M.timer=null,M.doNextStarted=!1,M.queue=[]}},B=!0,G=!1;function U(e,n,t){if(e){var r,i,o,a=0,s=e.length;if(t=t||null,_(s)||v(e))for(o=Object.keys(e);a<o.length&&(r=o[a],n.call(t,e[r],r,e)!==G);a++);else for(i=e[0];a<s&&n.call(t,i,a,e)!==G;i=e[++a]);}return e}var H={fire:function(e){var n,t=this;t.exec=t.exec||{},e=e.toLowerCase(),n=Array.prototype.slice.call(arguments,1),U(t.exec[e]||[],(function(e){var r=e.f,i=e.c||t;try{r.apply(i,n)}catch(o){R(o)}}))},on:function(e,n,t){var r=this;r.exec=r.exec||{},e=e.toLowerCase(),r.exec[e]=r.exec[e]||[],r.exec[e].push({f:n,c:t})},off:function(e,n,t){var r=this.exec;if(r)if(e)if(e=e.toLowerCase(),n)for(var i=r[e]||[],o=i.length-1;o>=0;o--)i[o]===n&&i.splice(o,1);else r[e]=null;else this.exec=null}};function j(e){return null!=e&&e==e.window}function V(e){e&&/\S/.test(e)&&(u.execScript?u.execScript(e):function(e){u.eval.call(u,e)}(e))}var X,K="";var z,J,Y,q,Q=navigator,Z=!0;if("userAgentData"in Q){var $=Q.userAgentData,ee=[];$.platform&&""!=$.platform&&("brands"in $&&Array.isArray($.brands)&&$.brands.length>0?ee=$.brands:"uaList"in $&&Array.isArray($.uaList)&&$.uaList.length>0&&(ee=$.uaList),ee.length>0&&(Z=!1,J=$.platform.toLowerCase(),z=function(e,n,t){var r,i,o,a,s,u,c,l,f,d=!1,T=!1,h=!1,g=e.mobile,p=!1,_=K,m=navigator.maxTouchPoints||0;for(i=n.length,r=0;r<i;r++){var S=n[r].brand.toLowerCase();if(S.indexOf("chrome")>=0){h=!0,_=n[r].version;break}if(S.indexOf("edge")>=0){d=!0,_=n[r].version;break}if(S.indexOf("opera")>=0){T=!0,_=n[r].version;break}}return h||d||T||(h=!0,_="100"),o=/windows/g.test(t),a=/mac/g.test(t),s=/linux/g.test(t),u=/android/g.test(t),c=/harmony/g.test(t),l=/(chromeos|chrome\sos)/g.test(t),f=/iphone/g.test(t),o||u||s||f||(p=/macintel/g.test(t)&&m>1),(u||c||f||p)&&(g=!0),{bUseUserAgent:!1,bWin:o,bMac:a,bLinux:s,bAndroid:u,bHarmonyOS:c,bChromeOS:l,bIE:!1,bEdge:d,bUC:!1,bPlaybook:!1,bBlackBerry:!1,bHuaWeiBrowser:!1,bOpera:T,bFirefox:!1,bChrome:h,bJSDom:!1,biPhone:f,biPad:p,bPad:u&&!e.mobile,bSafari:!1,bMobile:g,strBrowserVersion:_,bHTML5Edition:!0,IEVersion:0,IEMode:0}}($,ee,J)))}Z&&(Y||(Y=Q.userAgent.toLowerCase()),q||(q=Q.platform.toLowerCase()),z=function(e,n){var t,r=e.toLowerCase(),i=n.toLowerCase(),o=/harmonyos/g.test(r);"linux"==i&&r.indexOf("windows nt")>=0&&(i="harmonyos",o=!0);var a=!o&&/cros/.test(r),s=!o&&/android/g.test(r)||/android/g.test(i),u=/iphone/g.test(r)||/iphone/g.test(i),c=/macintosh/.test(r),l=navigator.maxTouchPoints||0,f=/ipad/g.test(r)||(c||"macintel"==i)&&l>1,d=/ucweb|ucbrowser/g.test(r),T=!d&&/nexus/g.test(r)&&/version\/[\d.]+.*safari\//g.test(r),h=/playbook/g.test(r),g=/hp-tablet/g.test(r),p=/blackberry|bb10/g.test(r),_=/symbian/g.test(r),m=/windows phone/g.test(r),S=/mobile/g.test(r),I=/arm64|aarch64/g.test(r),E=/mips64/g.test(r),v=/huaweibrowser/g.test(r),b=/jsdom/g.test(r),w=h||f||g,C=!w&&!a&&(u||T||p||_||m||s||o||S),W=!C&&!w&&!a,A=W&&/win32|win64|windows/.test(i),y=A&&/win64|x64/.test(r),P=W&&/mac68k|macppc|macintosh|macintel/.test(r),D=W&&/linux/.test(i),O="win64"==i||/wow64|x86_64|win64|x64/.test(r)||I||E,L=/wow64/g.test(r),N=G,R=/opera|opr/g.test(r),x=/360se/g.test(r),F=/maxthon/g.test(r),k=/tencenttraveler|qqbrowser/g.test(r),M=/the world/g.test(r),U=/metasr/g.test(r),H=/avant/g.test(r),j=/firefox|fxios/g.test(r),V=/gecko/g.test(r),X=!(j||v)&&/edge\/|edga\/|edgios\/|edg\//g.test(r),z=!(p||h||d||R||X||v||b)&&/chrome|crios/g.test(r),J=!1,Y=0,q=0,Q=K;if(A&&!X&&!j&&!z){var Z=r.indexOf("msie "),$=r.indexOf("trident"),ee=r.indexOf("rv:");J=-1!=Z||-1!=$||-1!=ee}if(!(P||u||f||A||p||h||T)||d||R||X||J||j||(t=r.match(/version\/([\d.]+).*safari\//))&&(p||h||T||(N=B,z=G),Q=t[1]),X){var ne=r.indexOf("edge/");ne>-1?ne+=5:(ne=r.indexOf("edg/"))>-1?ne+=4:(ne=r.indexOf("edga/"))>-1?ne+=5:(ne=r.indexOf("edgios/"))>-1&&(ne+=7),ne>-1&&(t=(Q=r.slice(ne)).indexOf(" "))>-1&&(Q=Q.slice(0,t))}else if(j)if((t=r.indexOf("firefox/"))>-1){var te=(t=r.slice(t+8)).indexOf(" ");te>-1&&(t=t.slice(0,te)),Q=t,(te=t.indexOf("."))>-1&&(t=Q.slice(0,te))}else(u||f)&&(t=r.indexOf("fxios/"))>-1&&(Q=t=(t=r.slice(t+6)).slice(0,t.indexOf(" ")));else if(J){var re=r.indexOf("msie "),ie=r.indexOf("trident"),oe=r.indexOf("rv:");-1!=re?t=(t=r.slice(re+5)).slice(0,t.indexOf(";")):-1!=oe?t=(t=(t=r.slice(oe+3)).slice(0,t.indexOf(";"))).slice(0,t.indexOf(")")):-1!=ie&&(t=(t=r.slice(ie+7)).slice(0,t.indexOf(";"))),Q=t}else if(N)(t=Q.indexOf("."))>-1&&(t=Q.slice(0,t));else if(d)(t=r.indexOf("ucweb"))>-1?Q=r.slice(t+5):(t=r.indexOf("ucbrowser/"))>-1&&(t=(Q=r.slice(t+10)).indexOf(" "))>-1&&(Q=Q.slice(0,t));else if(R)(t=r.indexOf("version/"))>-1?Q=r.slice(t+8):(t=r.indexOf("opr/"))>-1&&(Q=r.slice(t+4));else if(_)(t=r.indexOf("browserng/"))>-1&&(Q=r.slice(t+10));else if(m)(t=r.indexOf("iemobile/"))>-1&&(Q=r.slice(t+9));else if(z){var ae=r.indexOf("chrome/");ae>-1?(t=(Q=r.slice(ae+7)).indexOf(" "))>-1&&(Q=Q.slice(0,t)):(ae=r.indexOf("crios/"))>-1&&(t=(Q=r.slice(ae+6)).indexOf(" "))>-1&&(Q=Q.slice(0,t)),(t=Q.indexOf("."))>-1&&(t=Q.slice(0,t))}else if(v){var se=r.indexOf("huaweibrowser");se>-1&&(t=(Q=r.slice(se+14)).indexOf(" "))>-1&&(Q=Q.slice(0,t))}else if(b){var ue=r.indexOf("jsdom");ue>-1&&(t=(Q=r.slice(ue+6)).indexOf(" "))>-1&&(Q=Q.slice(0,t))}if(X||J){var ce=window.document;ce&&ce.documentMode?Y=ce.documentMode:(Y=5,ce.compatMode&&"CSS1Compat"==ce.compatMode&&(Y=7)),J&&(q=parseInt(Q))}return(P||D)&&(O=!0,P&&(t=r.match(/mac os x (\d+)(_|\.)(\d+)/))&&t.length>3&&(10==t[1]&&t[3]<14||t[1]<10)&&(O=!1)),A||P||D||I||E||(C=!0),{bUseUserAgent:!0,bWin:A,bMac:P,bLinux:D,bMobile:C,bPad:w,bChromeOS:a,bHarmonyOS:o,bArm64:I,bMips64:E,bEmbed:I||E,bAndroid:s,biPhone:u,biPad:f,bWin64:y,bWOW64:L,bOSx64:O,bIE:J,bEdge:X,bChrome:z,bFirefox:j,bSafari:N,bOpera:R,bNexus:T,bUC:d,b360SE:x,bMaxthon:F,bTencentTraveler:k,bTheWorld:M,bMetaSr:U,bAvant:H,bHuaWeiBrowser:v,bJSDom:b,bGecko:V,bHTML5Edition:!0,strBrowserVersion:Q,IEVersion:q,IEMode:Y}}(Y,q));var ne=null===(X=null==u?void 0:u.location)||void 0===X?void 0:X.protocol;function te(e){return z.bGecko&&"mousewheel"===e?"DOMMouseScroll":e}function re(e,n,t){var r=te(n);e&&e.addEventListener(r,t,!1)}function ie(e,n,t){var r=te(n);e&&e.removeEventListener(r,t,!1)}function oe(e){var n=e||u.event;n.preventDefault&&n.preventDefault(),n.stopPropagation&&n.stopPropagation(),n.returnValue=!1,n.cancelBubble=!0}function ae(e,n){var t=u.document.createEvent("HTMLEvents");t.initEvent(e,B,B),n.dispatchEvent&&n.dispatchEvent(t)}ne||(ne="http:"),z.protocol=ne,z.bSSL="https:"===ne,z.bFileSystem="https:"!==ne&&"http:"!==ne;var se,ue,ce,le,fe=u.document,de=[],Te=de.push,he=de.slice,ge=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,pe=function(){ue()};function _e(e,n,t,r){var i,o,a,s=n&&n.ownerDocument,u=n?n.nodeType:9;if(t=t||[],"string"!=typeof e||!e||1!==u&&9!==u&&11!==u)return t;if(!r&&((n?n.ownerDocument||n:fe)!==ce&&ue(n),n=n||ce,11!==u&&(a=ge.exec(e))))if(i=a[1]){if(9===u){if(!(o=n.getElementById(i)))return t;if(o.id===i)return t.push(o),t}else if(s&&(o=s.getElementById(i))&&le(n,o)&&o.id===i)return t.push(o),t}else{if(a[2])return Te.apply(t,n.getElementsByTagName(e)),t;if((i=a[3])&&n.getElementsByClassName)return Te.apply(t,n.getElementsByClassName(i)),t}return t}Te.apply(he.call(fe.childNodes),fe.childNodes),ue=_e.setDocument=function(e){var n,t=e?e.ownerDocument||e:fe;return t!==ce&&9===t.nodeType&&t.documentElement?(fe!==(ce=t)&&(n=ce.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",pe,!1):n.attachEvent&&n.attachEvent("onunload",pe)),le=function(e,n){if(n)for(;n=n.parentNode;)if(n===e)return!0;return!1},ce):ce},_e.contains=function(e,n){return(e.ownerDocument||e)!==ce&&ue(e),le(e,n)},_e.error=function(e){throw new Error("Syntax error: "+e)},se=_e.getText=function(e){var n,t="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)t+=se(e)}else if(3===i||4===i)return e.nodeValue}else for(;n=e[r++];)t+=se(n);return t},ue();var me={encodeChars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",decodeChars:[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1]},Se={UTF16ToUTF8:function(e){for(var n,t,r=[],i=e.length,o=0;o<i;o++){var a=e.charCodeAt(o);if(a>0&&a<=127)r.push(e.charAt(o));else if(a>=128&&a<=2047)n=192|a>>6&31,t=128|63&a,r.push(String.fromCharCode(n),String.fromCharCode(t));else if(a>=2048&&a<=65535){n=224|a>>12&15,t=128|a>>6&63;var s=128|63&a;r.push(String.fromCharCode(n),String.fromCharCode(t),String.fromCharCode(s))}}return r.join("")},UTF8ToUTF16:function(e){var n,t,r,i,o=[],a=e.length;for(n=0;n<a;n++)0==((t=e.charCodeAt(n))>>7&255)?o.push(e.charAt(n)):6==(t>>5&255)?(i=(31&t)<<6|63&(r=e.charCodeAt(++n)),o.push(String.fromCharCode(i))):14==(t>>4&255)&&(i=(255&(t<<4|(r=e.charCodeAt(++n))>>2&15))<<8|((3&r)<<6|63&e.charCodeAt(++n)),o.push(String.fromCharCode(i)));return o.join("")},encode:function(e){for(var n,t,r,i=this.UTF16ToUTF8(e),o=[],a=0,s=i.length;a<s;){if(n=255&i.charCodeAt(a++),a==s){o.push(me.encodeChars.charAt(n>>2)),o.push(me.encodeChars.charAt((3&n)<<4)),o.push("==");break}if(t=i.charCodeAt(a++),a==s){o.push(me.encodeChars.charAt(n>>2)),o.push(me.encodeChars.charAt((3&n)<<4|(240&t)>>4)),o.push(me.encodeChars.charAt((15&t)<<2)),o.push("=");break}r=i.charCodeAt(a++),o.push(me.encodeChars.charAt(n>>2)),o.push(me.encodeChars.charAt((3&n)<<4|(240&t)>>4)),o.push(me.encodeChars.charAt((15&t)<<2|(192&r)>>6)),o.push(me.encodeChars.charAt(63&r))}return o.join("")},encodeArray:function(e){for(var n,t,r,i=[],o=0,a=e.length;o<a;){if(n=255&e[o++],o==a){i.push(me.encodeChars.charAt(n>>2)),i.push(me.encodeChars.charAt((3&n)<<4)),i.push("==");break}if(t=255&e[o++],o==a){i.push(me.encodeChars.charAt(n>>2)),i.push(me.encodeChars.charAt((3&n)<<4|(240&t)>>4)),i.push(me.encodeChars.charAt((15&t)<<2)),i.push("=");break}r=255&e[o++],i.push(me.encodeChars.charAt(n>>2)),i.push(me.encodeChars.charAt((3&n)<<4|(240&t)>>4)),i.push(me.encodeChars.charAt((15&t)<<2|(192&r)>>6)),i.push(me.encodeChars.charAt(63&r))}return i.join("")},decode:function(e,n){for(var t,r,i,o,a=this,s=[],u=0,c=e.length;u<c;){do{t=me.decodeChars[255&e.charCodeAt(u++)]}while(u<c&&-1==t);if(-1==t)break;do{r=me.decodeChars[255&e.charCodeAt(u++)]}while(u<c&&-1==r);if(-1==r)break;n?s.push(t<<2|(48&r)>>4):s.push(String.fromCharCode(t<<2|(48&r)>>4));do{if(61==(i=255&e.charCodeAt(u++)))return n?s:a.UTF8ToUTF16(s.join(""));i=me.decodeChars[i]}while(u<c&&-1==i);if(-1==i)break;n?s.push((15&r)<<4|(60&i)>>2):s.push(String.fromCharCode((15&r)<<4|(60&i)>>2));do{if(61==(o=255&e.charCodeAt(u++)))return n?s:a.UTF8ToUTF16(s.join(""));o=me.decodeChars[o]}while(u<c&&-1==o);if(-1==o)break;n?s.push((3&i)<<6|o):s.push(String.fromCharCode((3&i)<<6|o))}return n?s:a.UTF8ToUTF16(s.join(""))}},Ie={fromUTF16:function(e){for(var n,t=[],r=0,i=e.length;r<i;)(n=e.charCodeAt(r))>=1&&n<=127?t.push(e.charAt(r)):n>2047?(t.push(String.fromCharCode(224|n>>12&15)),t.push(String.fromCharCode(128|n>>6&63)),t.push(String.fromCharCode(128|n>>0&63))):(t.push(String.fromCharCode(192|n>>6&31)),t.push(String.fromCharCode(128|n>>0&63))),r++;return t.join("")},toUTF16:function(e){for(var n,t,r,i=[],o=0,a=e.length;o<a;)switch((n=e.charCodeAt(o++))>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:i.push(e.charAt(o-1));break;case 12:case 13:t=e.charCodeAt(o++),i.push(String.fromCharCode((31&n)<<6|63&t));break;case 14:t=e.charCodeAt(o++),r=e.charCodeAt(o++),i.push(String.fromCharCode((15&n)<<12|(63&t)<<6|(63&r)<<0))}return i.join("")}};function Ee(e){if(null==e||"object"!=f(e))return e;var n,t,r;if(e instanceof Date)return(n=new Date).setTime(e.getTime()),n;if(e instanceof Array){for(n=[],r=e.length,t=0;t<r;t++)n[t]=Ee(e[t]);return n}if(e instanceof Object){for(t in n={},e)e.hasOwnProperty(t)&&(n[t]=Ee(e[t]));return n}return 0}function ve(e){return Math.random().toString(16).substring(2,2+e)}function be(e){var n=[ve(8),"-",ve(4),"-",ve(4),"-",ve(4),"-",ve(8)];return e&&n.unshift(e),n.join("")}var we=Date.now||function(){return+new Date},Ce=function(){return""+we()};function We(){for(var e,n=we()%1e4,t=[],r=0;r<5;r++)e=Math.floor(10*Math.random()),0!=r||0!=e?t.push(e):r=-1;return n<10?t.push("000"):n<100?t.push("00"):n<1e3&&t.push("0"),t.push(n),t.join("")}function Ae(e,n){var t;for(t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e}function ye(e,n,t,r){return new(t||(t=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(n){o(n)}}function s(e){try{u(r["throw"](e))}catch(n){o(n)}}function u(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,s)}u((r=r.apply(e,n||[])).next())}))}var Pe=!1;"wakeLock"in navigator&&(Pe=!0);var De=null;function Oe(){Pe&&(null==De?function(){ye(this,void 0,void 0,l.mark((function e(){return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.wakeLock.request("screen");case 3:De=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](0),De=null;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))}():De.release().then((function(){De=null})))}function Le(){return De}var Ne=Array.prototype;function Re(e,n,t){return Ne.filter.call(e,n,t||this)}function xe(e,n){return Ne.indexOf.call(n,e)}function Fe(e){var n,t,r=[],i=e.length;for(n=0;n<i;n++){for(t=n+1;t<i;t++)e[n]===e[t]&&(t=++n);r.push(e[n])}return r}var ke=/^(\/?)([\s\S]+\/(?!$)|\/)?((?:\.{1,2}$|[\s\S]+?)?(\.[^.\/]*)?)$/;function Me(e,n){var t,r=[];for(t=0;t<e.length;t++){var i=e[t];i&&"."!==i&&(".."===i?r.length&&".."!==r[r.length-1]?r.pop():n&&r.push(".."):r.push(i))}return r}function Be(e){var n="/"===e.charAt(0),t="/"===e.slice(-1);return(e=Me(Re(e.split("/"),(function(e){return!!e})),!n).join("/"))||n||(e="."),e&&t&&(e+="/"),(n?"/":"")+e}var Ge=function(){function e(){d(this,e)}return g(e,[{key:"resolve",value:function(){var e,n,t="",r=arguments,i=!1;for(e=r.length-1;e>=0&&!i;e--)b(n=r[e])&&n&&(t=n+"/"+t,i="/"===n.charAt(0));return(i?"/":"")+Me(Re(t.split("/"),(function(e){return!!e})),!i).join("/")||"."}},{key:"join",value:function(){return Be(Re(y(arguments),(function(e){return e&&b(e)})).join("/"))}},{key:"relative",value:function(e,n){e=Be(e),n=Be(n);var t,r,i=Re(e.split("/"),(function(e){return!!e})),o=[],a=Re(n.split("/"),(function(e){return!!e})),s=Math.min(i.length,a.length);for(t=0;t<s&&i[t]===a[t];t++);for(r=t;t<i.length;)o.push(".."),t++;return(o=o.concat(a.slice(r))).join("/")}},{key:"basename",value:function(e,n){var t;return t=(e.match(ke)||[])[3]||"",n&&t&&t.slice(-1*n.length)===n&&(t=t.slice(0,-1*n.length)),t}},{key:"dirname",value:function(e){var n=e.match(ke)||[],t=n[1]||"",r=n[2]||"";return t||r?(r&&(r=r.substring(0,r.length-1)),t+r):"."}},{key:"extname",value:function(e){return(e.match(ke)||[])[4]||""}}]),e}(),Ue={}.hasOwnProperty;function He(e){if(!e||"object"!==E(e)||e.nodeType||e.window==e)return G;var n,t;try{if((t=e.constructor)&&!Ue(e,"constructor")&&!Ue(t.prototype,"isPrototypeOf"))return G}catch(r){return G}for(n in e);return _(n)||Ue(e,n)}var je="object"===("undefined"==typeof HTMLElement?"undefined":f(HTMLElement));function Ve(e){return je?e instanceof HTMLElement:e&&"object"===f(e)&&(1===e.nodeType||9===e.nodeType)&&"string"==typeof e.nodeName}function Xe(e){var n=e;if(Ve(e))for(;!n&&n!=document.body;)n=n.parentNode;else n=0;return!!n}function Ke(e,n){return 0===e.lastIndexOf(n,0)}function ze(e,n){var t=e.length-n.length;return t>=0&&e.indexOf(n,t)===t}function Je(e){return null==e?K:String.prototype.trim.call(e)}function Ye(e){var n;if(e)for(n in e)if(!_(n))return!1;return!0}function qe(e){return b(e)?e.replace(/[^\x20-\x7E]/g,""):e}function Qe(e,n,t){return e.replace(new RegExp(n,"gi"),t)}function Ze(e){return e.charAt(0).toUpperCase()+e.substr(1)}var $e="none",en={getOffset:function(e,n,t){var r,i;e=e||u.event;for(var o,a,s=t||e.target,c=0,l=0,f=0,d=0,T=!1,h=u.document;s&&!isNaN(s.offsetLeft)&&!isNaN(s.offsetTop);)a=s.scrollLeft,o=s.scrollTop,"BODY"===s.tagName?T?(a=0,o=0):(a|=null===(r=h.documentElement)||void 0===r?void 0:r.scrollLeft,o|=null===(i=h.documentElement)||void 0===i?void 0:i.scrollTop):"fixed"===s.style.position&&(T=!0),c+=s.offsetLeft-a,l+=s.offsetTop-o,s=s.offsetParent;return n&&(f=n.Left,d=n.Top),{x:c=e.clientX-c-f,y:l=e.clientY-l-d}},getElDimensions:function(e,n){var t,r;return e?(t=e.style.display,e.style.display="",r=n?{offsetTop:e.offsetTop,offsetLeft:e.offsetLeft,offsetWidth:e.offsetWidth,offsetHeight:e.offsetHeight}:{clientTop:e.clientTop,clientLeft:e.clientLeft,clientWidth:e.clientWidth?e.clientWidth:parseInt(e.style.width)?parseInt(e.style.width):0,clientHeight:e.clientHeight?e.clientHeight:parseInt(e.style.height)?parseInt(e.style.height):0},e.style.display=t,r):{offsetTop:0,offsetLeft:0,offsetWidth:0,offsetHeight:0}}};function nn(e){return document.getElementById(e)}function tn(e){var n=b(e)?nn(e):e;n&&(n.length>0&&(n=n[0]),n.style.display=$e)}function rn(e){var n=b(e)?nn(e):e;n&&(n.length>0&&(n=n[0]),n.style.display=K)}function on(e){var n=b(e)?nn(e):e;n&&(n.length>0&&(n=n[0]),n.style.display===$e?n.style.display=K:n.style.display=$e)}function an(e){if(e)for(;e.firstChild;)e.removeChild(e.firstChild)}function sn(e){return encodeURIComponent(String(e))}function un(e){return decodeURIComponent(e.replace(/\+/g," "))}var cn=!0,ln=document,fn=ln&&ln.documentElement,dn=ln.getElementsByTagName("head")[0]||fn,Tn=ln.createElement("script").readyState?function(e,n){var t=e.onreadystatechange;e.onreadystatechange=function(){var r=e.readyState;if("loaded"===r||"complete"===r){e.onreadystatechange=null,t&&t();n.call(this,{type:"load",path:[e]})}else"loading"===r||n.call(this,{type:"error",path:[e]})}}:function(e,n){e.addEventListener("load",n,G),e.addEventListener("error",n,G)};function hn(e,n,t){return gn(e,n,!1,t)}function gn(e,n,t,r){var i,o,a=r;if(v(a)||(a=function(){}),b(e)&&e!=K)return i=ln.createElement("script"),o=["",e].join(K),i.src=o,n&&(i.async=cn),i.charset="utf-8",Tn(i,a),t?dn.appendChild(i):dn.insertBefore(i,dn.firstChild),i;a()}function pn(e,n,t){return _n(e,n,!1,t)}function _n(e,n,t,r){var i=r;if(v(i)||(i=function(){}),z.bJSDom)i("ok");else if(A(e)){var o=e.length,a=function(e){e&&"load"==e.type?o--:(e&&"error"==e.type&&x(["Failed to load resource: ",e.target.src,"."].join("")),i()),o<=0&&i("ok")};o<=0?i("ok"):U(e,(function(e){gn(e,n,t,a)}))}else i()}function mn(e,n){return Sn(e,!1,n)}function Sn(e,n,t){var r,i=t;if(v(i)||(i=!1),b(e)&&e!=K){if(!z.bJSDom)return(r=ln.createElement("link")).href=e,r.rel="stylesheet",r.async=cn,i&&Tn(r,i),n?dn.appendChild(r):dn.insertBefore(r,dn.firstChild),r;i&&i()}else i&&i()}function In(e,n){return En(e,!1,n)}function En(e,n,t){if(z.bJSDom)t&&t("ok");else if(A(e)){var r=e.length,i=function(e){e&&"load"==e.type&&r--,e&&"load"!=e.type&&(e&&"error"==e.type&&x(["Failed to load resource: ",e.target.href,"."].join("")),t()),r<=0&&t("ok")};U(e,(function(e){Sn(e,n,i)}))}else t&&t()}function vn(e){var n,t;if(!z.bJSDom){var r=document;if(r&&b(t=e.body)&&t!=K){(n=r.createElement("script")).charset="utf-8",z.bIE?n.text=t:n.appendChild(r.createTextNode(t)),e.language?n.language=e.language:n.language="javascript",e.type?n.type=e.type:n.type="text/javascript";var i=r&&r.documentElement,o=r.getElementsByTagName("head")[0]||i;o.insertBefore(n,o.firstChild)}}}function bn(e){vn({body:e})}function wn(e){vn({body:e,language:"vbscript",type:"text/vbscript"})}var Cn,Wn,An=new(function(){function e(){d(this,e),this.nil=undefined,this.bNode=!1,this.noop=function(){},this.mix=Ae,this.clone=Ee,this.keys=Object.keys,this.now=Ce,this.getFormatedNow=p,this.getRandom=We,this.guid=be,this.get=nn,this.show=rn,this.hide=tn,this.toggle=on,this.empty=an,this.stringify=u.JSON.stringify,this.parse=u.JSON.parse,this.isDef=m,this.isUndef=_,this.isUndefined=_,this.isNull=S,this.isNaN=isNaN,this.isFunction=v,this.isString=b,this.isObject=w,this.isBoolean=C,this.isNumber=W,this.isArray=A,this.type=E,this.isPlainObject=He,this.isDOM=Ve,this.isDOMInBody=Xe,this.each=U,this.getLogger=L,this.setLogger=N,this.log=R,this.error=x,this.warn=F,this.info=k,this.filter=Re,this.indexOf=xe,this.uniq=Fe,this.startsWith=Ke,this.endsWith=ze,this.replaceAll=Qe,this.upperCaseFirst=Ze,this.removeNonPrintableChar=qe,this.trim=Je,this.makeArray=y,this.isEmptyObject=Ye,this.Path=new Ge,this.DOM=en,this.isWindow=j,this.globalEval=V,this.obj={customEvent:H},this.addEventListener=re,this.removeEventListener=ie,this.stopPropagation=oe,this.fireEvent=ae,this.base64=Se,this.utf8=Ie,this.btoa=function(e){return u.btoa(e)},this.atob=function(e){return u.atob(e)},this.asyncQueue=M,this.sizzle=_e,this.toggleWakeLock=Oe,this.getWakeLock=Le,this.urlEncode=sn,this.urlDecode=un,this.scriptOnload=Tn,this.addAllCss=En,this.getAllCss=In,this.addCss=Sn,this.getCss=mn,this.addScripts=_n,this.getScripts=pn,this.addScript=gn,this.getScript=hn,this.addJS=bn,this.addVBS=wn}return g(e,[{key:"debug",get:function(){return O.debug},set:function(e){O.debug=e}},{key:"showConsoleError",get:function(){return O.debug},set:function(e){O.showConsoleError=e}}]),e}()),yn=!!("object"==("undefined"==typeof global?"undefined":f(global))&&global.process&&global.process.release&&global.process.release.name&&"undefined"==typeof HTMLCanvasElement)?global:self||{},Pn=yn.Dynamsoft;Pn?Pn.Lib||(Pn.Lib={}):(Pn={Lib:{},DWT:{}},yn&&(yn.Dynamsoft=Pn)),Cn=An.mix(Pn.Lib,An),(Wn=Pn).DWT||(Wn.DWT={}),Wn.DWT.LTS||(Wn.DWT.LTS={}),Wn.Lib.UI||(Wn.Lib.UI={}),Wn.Lib.html5||(Wn.Lib.html5={});var Dn,On="18",Ln="5",Nn="".concat(On,",").concat(Ln,",").concat("0",",").concat("0312"),Rn="".concat(On,",").concat("5",",").concat("0",",").concat("0312");function xn(e,n,t){return(n=T(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}!function(e){e.NONE=0,e.TRACE=1,e.DEBUG=2,e.INFO=4,e.WARN=8,e.ERROR=16}(Dn||(Dn={}));var Fn=An.getLogger(),kn=function(){function e(){d(this,e)}return g(e,null,[{key:"LogLevel",get:function(){return this._logLevel},set:function(e){this._logLevel=e}},{key:"LogFunc",set:function(e){this._logFunc=e}},{key:"all",value:function(e,n){if((this._logLevel&e)==e)if(this._logFunc)this._logFunc(n,e);else switch(e){case Dn.DEBUG:Fn.debug(n);break;case Dn.ERROR:Fn.error(n);break;case Dn.INFO:Fn.info(n);break;case Dn.WARN:Fn.warn(n);break;case Dn.TRACE:Fn.trace(n)}}},{key:"trace",value:function(e){this.all(Dn.TRACE,e)}},{key:"debug",value:function(e){this.all(Dn.DEBUG,e)}},{key:"info",value:function(e){this.all(Dn.INFO,e)}},{key:"warn",value:function(e){this.all(Dn.WARN,e)}},{key:"error",value:function(e){this.all(Dn.ERROR,e)}}]),e}();function Mn(e){var n;window.console&&(e instanceof Error||An.isString(e)?(n=e,Pn.navInfoSync.bIE&&(n=An.stringify(e))):n=An.stringify(e),window.console.error(n))}xn(kn,"_logLevel",Dn.ERROR),xn(kn,"_logFunc",undefined),z.bIE&&z.bSSL||z.bAndroid;var Bn,Gn,Un={JSVersion:Rn,ServerVersionInfo:Nn,ServerLinuxVersionInfo:Nn,ServerMacVersionInfo:Nn,ServerAndroidVersionInfo:Nn,ActiveXVersion:"18,0,0,1025",ActiveXPdfVersion:"11.5.2.0312",PdfVersion:"11.5.2.0312",PdfLinuxVersion:"11.5.2.0312",PdfMacVersion:"11.5.2.0312"};function Hn(){var e=Pn.DWT.ServiceInstallerLocation;return An.isString(e)&&e.length>0?("/"!=e[e.length-1]&&(e+="/"),e):(e=Pn.DWT.ResourcesPath,An.isString(e)&&e.length>0?"/"!=e[e.length-1]&&(e+="/"):e="Resources/",e+"dist/")}!function(e){e.enumUnknown=-1,e.enumChrome=1,e.enumFirefox=2,e.enumEdge=3,e.enumSafari=4,e.enumIE=5,e.enumOpera=6,e.enumHuaWeiBrowser=7}(Bn||(Bn={})),function(e){e.enumUnknown=-1,e.enumWindow=0,e.enumMac=1,e.enumLinux=2,e.enumEmbed=3,e.enumChromeOS=4,e.enumHarmonyOS=5,e.enumAndroid=6,e.enumiOS=7}(Gn||(Gn={}));var jn={getDSPath:function(e){var n=Hn(),t=e;return t||(t=z.bWin?".msi":z.bMac?".pkg":Pn.navInfo.bArm64?"-arm64.deb":Pn.navInfo.bMips64?"-mips64el.deb":Pn.navInfo.bAndroid?".apk":z.bLinux||z.bChromeOS||z.bHarmonyOS?".deb":".msi"),[n,"DynamsoftServiceSetup",t].join("")},getLinuxHTML5DebPath:function(){return jn.getDSPath(".deb")},getLinuxHTML5RpmPath:function(){return jn.getDSPath(".rpm")},getEnumPlatform:function(){return z.bAndroid?Gn.enumAndroid:z.bMac?Gn.enumMac:z.bChromeOS?Gn.enumChromeOS:z.bHarmonyOS?Gn.enumHarmonyOS:Pn.navInfo.bEmbed?Gn.enumEmbed:z.bLinux?Gn.enumLinux:z.biPhone||z.biPad?Gn.enumiOS:Gn.enumWindow},getEnumBrowser:function(){return z.bEdge?Bn.enumEdge:z.bChrome?Bn.enumChrome:z.bFirefox?Bn.enumFirefox:z.bIE?Bn.enumIE:z.bSafari?Bn.enumSafari:z.bHuaWeiBrowser?Bn.enumHuaWeiBrowser:z.bOpera?Bn.enumOpera:Bn.enumUnknown}},Vn=!0,Xn=!1,Kn=z.bHTML5Edition,zn=0,Jn=Xn;z.bIE&&(""===(zn=z.IEVersion)||zn>=10?Pn.DWT.IfUseActiveXForIE10Plus?(Kn=Xn,Jn=Vn,z.bHTML5Edition=Kn):Kn=Vn:(Kn=Xn,zn>=9&&(Jn=Vn))),Jn||Kn||(Kn=Vn);var Yn={name:"Dynamic Web TWAIN",bHTML5Edition:Kn,bActiveXEdition:Jn,_iImageCaptureDriverType:3,_iBrokerProcessType:1,getChromeEditionPath:jn.getDSPath,getPKGPath:function(){return Hn()+"DynamicWebTWAINMacEdition.pkg"},getMSIPath:function(){return Hn()+"DynamicWebTWAINPlugIn.msi"},getActiveXCABx86Path:function(){return Hn()+"DynamicWebTWAIN.cab"},getActiveXCABx64Path:function(){return Hn()+"DynamicWebTWAINx64.cab"},onlineResources:"https://demo.dynamsoft.com/DWT/Resources/",strMIMEType:"Application/DynamicWebTwain-Plugin",strFullClassID:"E7DA7F8D-27AB-4EE9-8FC0-3FEC9ECFE758",scripts:{},dwtConfigLoaded:!1,dwtConfigLoading:!1,getServerVersionInfo:function(e){var n=Un.ServerVersionInfo;return z.bWin||(z.bMac?n=Un.ServerMacVersionInfo:z.bAndroid?n=Un.ServerAndroidVersionInfo:(z.bLinux||z.bChromeOS||z.bHarmonyOS)&&(n=Un.ServerLinuxVersionInfo)),e?n:An.replaceAll(n,",","")},getDWTPrefix:function(){return!0===Pn.DWT.CustomMode?"dwtc_":"dwt_"},loadResourcePath:!1,loadingResourcePath:!1,handshakeCode:undefined,organizationID:undefined,licenseServer:undefined,sessionPassword:"",bPublicLTS:!0,refProductKey:undefined,ltsDebug:!1,bDWTLoading:!1,bDWTUnloading:!1,bAndroidConnected:!1,unloadQueue:[],appendBrowserLicenseWhenServiceMode:function(){},bDCPChecked:!1,bDWTChecked:!1,bChromeEdition:Kn};function qn(e){var n=e.toLowerCase().replace(Yn.name.toLowerCase()+" ","");return(n=An.replaceAll(n,"[.]",",")).split(",")}var Qn,Zn=!1,$n=!0;!function(e){e.TWAINSCANNER=16,e.WIASCANNER=32,e.TWAINX64SCANNER=64,e.ICASCANNER=128,e.SANESCANNER=256,e.ESCLSCANNER=512,e.WIFIDIRECTSCANNER=1024,e.WIATWAINSCANNER=2048}(Qn||(Qn={}));var et=Qn.TWAINSCANNER|Qn.WIASCANNER|Qn.TWAINX64SCANNER|Qn.ICASCANNER|Qn.SANESCANNER|Qn.ESCLSCANNER|Qn.WIFIDIRECTSCANNER|Qn.WIATWAINSCANNER;Qn.TWAINSCANNER,Qn.WIASCANNER,Qn.TWAINX64SCANNER,Qn.ICASCANNER,Qn.SANESCANNER,Qn.TWAINSCANNER,Qn.WIATWAINSCANNER,Qn.TWAINX64SCANNER,Qn.ICASCANNER,Qn.SANESCANNER;var nt=Qn.TWAINSCANNER|Qn.WIASCANNER|Qn.WIATWAINSCANNER;Qn.ESCLSCANNER,Qn.WIFIDIRECTSCANNER,Qn.TWAINSCANNER,Qn.WIATWAINSCANNER;var tt=g((function Ja(){d(this,Ja)}));var rt=g((function Ya(){d(this,Ya)}));function it(e,n){var t,r=e.name,i="",o=e.deviceType;o==Qn.TWAINSCANNER?t="":o==Qn.TWAINX64SCANNER?t="Twain64-":o==Qn.WIASCANNER?t="WIA-":o==Qn.WIATWAINSCANNER?(r=An.replaceAll(r,"WIA-",""),t="WIATWAIN-"):t=o==Qn.ICASCANNER?"ICA-":o==Qn.SANESCANNER?"Sane-":o==Qn.ESCLSCANNER?"eSCL-":(Qn.WIFIDIRECTSCANNER,""),n&&n.attrs&&n.attrs.ty&&(i=" on ["+n.attrs.ty+"]"),e.displayName=[t,r,i].join("")}function ot(e){if(e.ProductName){var n=e.ProductName;e.ProductName=An.base64.decode(n)}if(e.ProductFamily){var t=e.ProductFamily;e.ProductFamily=An.base64.decode(t)}if(e.Manufacturer){var r=e.Manufacturer;e.Manufacturer=An.base64.decode(r)}if(e.Version&&e.Version.Info){var i=e.Version.Info;e.Version.Info=An.base64.decode(i)}}function at(e){var n=new rt;return n.strDevice=An.stringify(e),e.deviceInfo&&(n.deviceInfo=An.clone(e.deviceInfo)),e.deviceType&&(n.deviceType=An.clone(e.deviceType)),e.displayName&&(n.displayName=An.clone(e.displayName)),e.name&&(n.name=An.clone(e.name)),e.serviceInfo&&(n.serviceInfo=function(e){var n=new tt;return n.server=e.server,n.normal=!0,e.attrs&&(n.attrs=An.clone(e.attrs)),n}(e.serviceInfo)),An.isBoolean(e.isSystemDefaultPrinter)?n.isSystemDefaultPrinter=e.isSystemDefaultPrinter:n.isSystemDefaultPrinter=!1,n}Cn.removeNonPrintableChar;var st,ut=function(){function e(n,t,r,i){d(this,e);var o=this;o._md5=r,o._length=t,o._content=i}return g(e,[{key:"getLength",value:function(){return this._length}},{key:"getMD5",value:function(){return this._md5}},{key:"getData",value:function(e,n){var t=this,r=n;return An.isNumber(e)&&An.isNumber(n)?e<0||n<=0?"":0==e&&r==t._length?t._content:(e+r>t._length&&(r=t._length-e),t._content.substr(e,r)):""}}]),e}();Cn.html5.Base64Result=ut,function(e){e.SMF_NAME=1,e.SMF_TWAINVERSION=2,e.SMF_TWAINPROTOCOL=4,e.SMF_ICAUUID=8,e.SMF_ICAMODULEVERSION=16,e.SMF_ICALOCATIONTYPE=32}(st||(st={})),String.prototype.startsWith||(String.prototype.startsWith=function(e){return 0==this.indexOf(e)});var ct,lt,ft=function(e){var n,t=e,r=t._license||"",i=JSON.parse(JSON.stringify(t._licenseServer)),o=t._sessionPassword,a=0;if(r.startsWith("t")||r.startsWith("f"))a=0;else if(0===r.length||r.startsWith("P")||r.startsWith("L")||r.startsWith("Y")||r.startsWith("A"))a=1;else{a=2;var s=r.indexOf(":");if(-1!=s&&(r=r.substring(s+1)),r.startsWith("DLS2")){var u;try{var c=r.substring(4);c=Dynamsoft.Lib.atob(c),u=JSON.parse(c)}catch(f){throw new Error("Format Error: The license string you specified is invalid, please check to make sure it is correct.")}if("number"==typeof(r=u.handshakeCode?u.handshakeCode:u.organizationID?u.organizationID:"")&&(r=JSON.stringify(r)),0===i.length){var l=[];u.mainServerURL&&(l[0]=u.mainServerURL),u.standbyServerURL&&(l[1]=u.standbyServerURL),i=function(e){if(null==e)e=[];else{e instanceof Array||(e=[e]);for(var n=0;n<e.length;++n){if(document&&document.createElement){var t=document.createElement("a");t.href=e[n],e[n]=t.href}e[n].lastIndexOf("/")!=e[n].length-1&&(e[n]+="/")}}return e}(l)}!o&&u.sessionPassword&&(o=u.sessionPassword),n=u.remark}("200001"===r||r.startsWith("200001-"))&&(i&&i.length||(r="")),r||(a=1)}return 1===a&&(r=""),{lt:a,l:r,ls:i,sp:o,rmk:n}};function dt(e,n){return(null==e?void 0:e.port)==(null==n?void 0:n.port)&&(null==e?void 0:e.protocol)==(null==n?void 0:n.protocol)&&(null==e?void 0:e.server)==(null==n?void 0:n.server)&&(null==e?void 0:e.ssl)==(null==n?void 0:n.ssl)&&(null==e?void 0:e.useWS)==(null==n?void 0:n.useWS)}function Tt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ht(e,n){return ht=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,n){return e.__proto__=n,e},ht(e,n)}function gt(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&ht(e,n)}function pt(e,n){if(n&&("object"===f(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return Tt(e)}function _t(e){return _t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_t(e)}!function(e){e.OK=0,e.Custom=-1,e.NWB=-4200,e.WS_DISCONN=-4201,e.CB=-5e3,e.JSON_REQUIRED=-5001,e.OBJECT_DISPOSED=-5002,e.INVALID_TASK=-5003,e.OBJECT_DISPOSING=-5004}(ct||(ct={})),function(e){e.WS_DISCONN="The Web Socket connection failed.",e.JSON_REQUIRED="The input is not a JSON object or JSON styled string.",e.OBJECT_DISPOSED="The object has been disposed.",e.INVALID_TASK="The task is invalid.",e.OBJECT_DISPOSING="The object need to be disposed."}(lt||(lt={}));var mt=function(){function e(){d(this,e)}return g(e,null,[{key:"message",value:function(e){return this._errorMessage[e]}},{key:"init",value:function(){this._errorMessage[ct.OK]="Successful.",this._errorMessage[ct.WS_DISCONN]=lt.WS_DISCONN,this._errorMessage[ct.JSON_REQUIRED]=lt.JSON_REQUIRED,this._errorMessage[ct.OBJECT_DISPOSED]=lt.OBJECT_DISPOSED,this._errorMessage[ct.INVALID_TASK]=lt.INVALID_TASK,this._errorMessage[ct.OBJECT_DISPOSING]=lt.OBJECT_DISPOSING}}]),e}();xn(mt,"_errorMessage",Object.create(null)),mt.init();var St,It=function(){function e(n,t){d(this,e),xn(this,"_code",ct.OK),this.name="DSError",this.message=null!=t?t:"string"==typeof n?n:mt.message(n),this._code="string"==typeof n?ct.Custom:n}return g(e,[{key:"code",get:function(){return this._code}}]),e}();!function(e){e.GET_TASKID=0,e.GET_EVENT_TASKID=1,e.ONMESSAGE_PROCESS_DATA=2,e.ONMESSAGE_GET_TASKID=3,e.ONMESSAGE_GET_EVENT_TASKID=4,e.HANDLE_RAW_MESSAGE=5,e.HANDLE_PROCESSED_MESSAGE=6}(St||(St={}));var Et,vt,bt=function(){function e(n){d(this,e),xn(this,"_serverInfo",undefined),xn(this,"_disposed",!1),this._serverInfo=n,this._ref=1}var t,r,i,o;return g(e,[{key:"serverInfo",get:function(){return this._serverInfo}},{key:"requestSync",value:function(e,n){return kn.error("requestSync should be implemented in child class"),undefined}},{key:"request",value:function(){var e=n(l.mark((function t(e,n,r,i){return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return kn.error("request should be implemented in child class"),e.abrupt("return",null);case 2:case"end":return e.stop()}}),t)})));return function(n,t,r,i){return e.apply(this,arguments)}}()},{key:"send",value:(o=n(l.mark((function a(e,n,t){return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:kn.error("reqsenduestSync should be implemented in child class");case 1:case"end":return e.stop()}}),a)}))),function(e,n,t){return o.apply(this,arguments)})},{key:"testConnection",value:(i=n(l.mark((function s(e,n,t,r){return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return kn.error("testConnection should be implemented in child class"),e.abrupt("return");case 2:case"end":return e.stop()}}),s)}))),function(e,n,t,r){return i.apply(this,arguments)})},{key:"disposed",get:function(){return this._disposed}},{key:"dispose",value:(r=n(l.mark((function u(){return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._ref--,!(this._ref>0)){e.next=3;break}return e.abrupt("return",!1);case 3:return this._disposed=!0,e.next=6,this._terminate();case 6:case"end":return e.stop()}}),u,this)}))),function(){return r.apply(this,arguments)})},{key:"_terminate",value:(t=n(l.mark((function c(){return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),c)}))),function(){return t.apply(this,arguments)})},{key:"addRef",value:function(){this._ref++}}]),e}(),wt={ErrStr_Service_NOT_INSTALLED:"Please make sure the Dynamsoft Service has been installed.",ErrStr_BROWSER_NOT_SUPPORT:"Error: This browser is currently not supported.",ErrStr_CreateID_ContainerIdDuplicated:"Error: Duplicate ContainerId detected while creating a Dynamic Web TWAIN object.",ErrStr_CreateID_WebTwainIdDuplicated:"Error: Duplicate WebTwainId detected while creating a Dynamic Web TWAIN object.",ErrStr_CreateID_NotContainer:"Error: The ID of the target DIV for the new DWT object is invalid.",ErrStr_CreateID_ContainerIdInvalid:"Error: The ContainerId cannot be empty string while creating a Dynamic Web TWAIN object.",ErrStr_CreateID_WebTwainIdInvalid:"Error: The WebTwainId cannot be empty string while creating a Dynamic Web TWAIN object."};function Ct(){return An.isString(Yn.handshakeCode)||An.isString(Yn.organizationID)||Yn.bPublicLTS||An.isString(Pn.DWT.ProductKey)&&An.startsWith(Pn.DWT.ProductKey,"DLS2")}function Wt(e,n,t){e._errorCode=n,e._errorString=t}function At(e){var n=Pn.DWT.licenseException;n.code=e._errorCode,n.message=e._errorString,n.fromLTS=!1}function yt(){return Pn.DWT.bChromeExtension?"":"Please contact the site administrator."}function Pt(e){Wt(e,-1033,"Invalid index.")}function Dt(e){Wt(e,-1034,"Invalid value.")}function Ot(e){Wt(e,Et.LicenseInvalid,Ct()?"The license is invalid.":"The current product key is empty or invalid."),At(e)}function Lt(e,n){e._errorCode=Et.LicenseExpired;var t="";if(n&&""!=n&&(-1==n.indexOf("on")&&(t=" on "+n),e.__licenseInfo&&(e.__licenseInfo.ExpireDate=n)),Ct()){var r,i,o,a,s;if(r=Pn.DWT.EnumInstance.dwt_desktop,e._bRemoteMode)i=null!==(o=null===(a=e._dmService)||void 0===a||null===(s=a.attrs)||void 0===s?void 0:s.UUID)&&void 0!==o?o:"";else i="";e._errorString="The license has expired"+t+". Please contact the application developer.",Pn.DWT.lcexp(r,i).then((function(){e._errorString=Pn.DWT.licenseException.message}))}else e._errorString="The current product key has expired"+t+". Please contact the application developer.",At(e)}function Nt(e,n){Ct()?111==n?(e._errorCode=Et.LicenseExpiredForDLS,e._errorString="The license for v"+On+" Service Core Module has expired."):(e._errorCode=Et.LicenseNoCoreForDLS,e._errorString="The license for v"+On+" Service Core Module is not found."):(e._errorCode=Et.LicenseNoCore,e._errorString="The current product key is missing the Service Core license. "+yt()),At(e)}function Rt(e){e._errorCode=-2339,Ct()?e._errorString="The license for the module pdf rasterizer is not found or has expired.":e._errorString="The current product key does not support pdf rasterizer. "+yt(),At(e)}function xt(e){Wt(e,-2352,"The indices are out of range.")}function Ft(e){Wt(e,-2359,"The index is out of range.")}function kt(e){Wt(e,-2360,"The index is null or undefined.")}function Mt(e){Wt(e,-2391,"Invalid event name.")}function Bt(e){Wt(e,-2416,"Invalid parameter.")}function Gt(e){Wt(e,-2426,"You have used a full license with a trial license which is not permitted. Please check and update Dynamsoft.DWT.ProductKey.")}function Ut(e){Wt(e,-2433,"The ActiveX edition does not support this method or property.")}function Ht(e){Wt(e,-2506,"The ThumbnailViewer object has been disposed.")}function jt(e,n,t){Wt(e,-2816,["HTTP process error: ",t," (",n,")."].join(""))}function Vt(e){Wt(e,-2828,"Invalid PDF Convert Mode Value.")}z.bSSL,z.bSSL,function(e){e.LicenseInvalid=-2325,e.LicenseExpired=-2326,e.LicenseParseFailed=-2546,e.LicenseExpiredForDLS=-2808,e.LicenseNoCoreForDLS=-2809,e.LicenseNoCore=-2810,e.LicenseIsFuture=-2396,e.LicenseVersionNotCurrent=-2539}(Et||(Et={})),Pn.DWT.EnumDWT_LicenseErrorCode=Et,function(e){e.UserCancelled=-1032,e.CORSErrorFromService=-2137,e.CommonError=-2201,e.ModuleNotExists=-2371,e.MustUpgrade=-2207,e.RemoteDynamsoftServiceStopped=-2613,e.ResponseDataTypeError=-2801,e.HTSTError=-2817,e.SSLCertExpired=-2818,e.SSLCertInvalid=-2819,e.CORSError=-2820,e.DWTPortNotReady=-2821,e.HTTPRedirected=-2823,e.BboError=-2827}(vt||(vt={}));var Xt=/[#\/\?@]/g,Kt=/[#\?]/g,zt={scheme:1,userInfo:2,hostname:3,port:4,path:5},Jt=new RegExp("^(?:([\\w\\d+.-]+):)?(?://(?:([^/?#@]*)@)?([\\w\\d\\-\\u0100-\\uffff.+%]*|\\[[^\\]]+\\])(?::([0-9]+))?)?(.+)?$");function Yt(e,n){return An.isString(e)&&An.isString(n)?e.toLowerCase()===n.toLowerCase():e===n}function qt(e,n){return encodeURI(e).replace(n,(function(e){return"%"+function(e){return 1===e.length?"0"+e:e}(e.charCodeAt(0).toString(16))}))}var Qt,Zt=function(){function e(n){if(d(this,e),xn(this,"scheme",""),xn(this,"userInfo",""),xn(this,"hostname",""),xn(this,"port",""),xn(this,"path",""),n instanceof e)return An.clone(n);e.getComponents(n,this)}return g(e,[{key:"clone",value:function(){var n=new e,t=this;return An.each(zt,(function(e,r){n[r]=t[r]})),n}},{key:"getScheme",value:function(){return this.scheme}},{key:"setScheme",value:function(e){return this.scheme=e,this}},{key:"getHostname",value:function(){return this.hostname}},{key:"setHostname",value:function(e){return this.hostname=e,this}},{key:"setUserInfo",value:function(e){return this.userInfo=e,this}},{key:"getUserInfo",value:function(){return this.userInfo}},{key:"setPort",value:function(e){return this.port=e,this}},{key:"getPort",value:function(){return this.port}},{key:"setPath",value:function(e){return this.path=e,this}},{key:"getPath",value:function(){return this.path}},{key:"isSameOriginAs",value:function(e){var n=this;return Yt(n.hostname,e.hostname)&&Yt(n.scheme,e.scheme)&&Yt(n.port,e.port)}},{key:"toString",value:function(e){var n,t,r,i,o,a=[],s=this;return(n=s.scheme)&&(a.push(qt(n,Xt)),a.push(":")),(t=s.hostname)&&(a.push("//"),(o=s.userInfo)&&(a.push(qt(o,Xt)),a.push("@")),a.push(encodeURIComponent(t)),(i=s.port)&&(a.push(":"),a.push(i))),(r=s.path)&&(t&&!An.startsWith(r,"/")&&(r="/"+r),a.push(qt(r,Kt))),a.join("")}}],[{key:"getComponents",value:function(e,n){var t=(e=e||K).match(Jt)||[],r=n||{};return An.each(zt,(function(e,n){r[n]=t[e]})),r}}]),e}(),$t=An.each,er=An.error,nr=An.isFunction,tr=An.isString,rr=z.bIE&&z.IEVersion<=9,ir=z.bIE&&z.IEVersion<=10,or=window,ar=new Zt(location.href),sr=ar&&/^(?:about|app|app\-storage|.+\-extension|file|widget)$/.test(ar.getScheme()),ur=!1,cr=function(){try{return new or.XMLHttpRequest}catch(e){}},lr=function(){try{var e=Zn;return $t(["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.3.0","Msxml3.XMLHTTP"],(function(n){try{if(!e)return e=new or.ActiveXObject(n),Zn}catch(t){er("new xhr error: "+t.message)}})),e}catch(n){}},fr=!(sr||!or.XMLHttpRequest)&&"withCredentials"in(cr()||[]),dr=or.ActiveXObject?function(e){return rr?lr():!sr&&cr()||lr()}:cr,Tr=function(e){return ur},hr=/^(?:GET|HEAD)$/,gr=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,pr={xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},_r=Qt;ir&&(_r=An.noop);var mr,Sr,Ir=function(){function e(){d(this,e),xn(this,"url",!1),xn(this,"onSuccess",!1),xn(this,"onError",!1),xn(this,"onComplete",!1),xn(this,"method","GET"),xn(this,"async",!0),xn(this,"xhrFields",!1),xn(this,"mimeType",!1),xn(this,"username",!1),xn(this,"password",!1),xn(this,"data",!1),xn(this,"dataType","text"),xn(this,"headers",!1),xn(this,"contentType","application/x-www-form-urlencoded; charset=UTF-8"),xn(this,"beforeSend",!1),xn(this,"afterSend",!1),xn(this,"timeout",0),xn(this,"cache",!0),xn(this,"crossDomain",!1),xn(this,"retry",0)}return g(e,[{key:"setRequestHeader",value:function(e,n){this.headers[e]=n}},{key:"getAllResponseHeaders",value:function(){return 2===this.state?this.responseHeadersString:null}},{key:"getNativeXhr",value:function(){return this.nativeXhr}},{key:"getResponseHeader",value:function(e){var n,t;if(e=e.toLowerCase(),2===this.state){if(!(t=this.responseHeaders))for(t=this.responseHeaders={};n=gr.exec(this.responseHeadersString);)t[n[1].toLowerCase()]=n[2];n=t[e]}return n===undefined?null:n}},{key:"overrideMimeType",value:function(e){return this.state||(this.mimeType=e),this}},{key:"abort",value:function(e){return this.state=3,this.status=0,this.statusText=null!=e?e:"abort",this.nativeXhr&&this.nativeXhr.abort(),this._callback(),this}},{key:"_ioReady",value:function(e,n){var t=!1,r=this;if(2!==this.state&&3!==this.state){1===this.state&&(this.state=2),this.readyState=4,e>=200&&e<300||304===e?304===e?(n="not modified",t=!0):(n="success",t=!0):e<0&&(e=0);try{e>=200&&this.handleResponseData()}catch(i){er(i,"error"),n=i.message||"parser error"}return(e<200||!t)&&this.retry>0?(this.retry=this.retry-1,void setTimeout((function(){r.sendInternal()}),200)):(this.status=e,this.statusText=n,this._callback(t),t)}}},{key:"_callback",value:function(e){var n=this,t=this.timeoutTimer;t&&(clearTimeout(t),this.timeoutTimer=0),$t([e?this.onSuccess:this.onError,this.onComplete],(function(e){nr(e)&&e.apply(n.context,[n.responseData,n.statusText,n])})),this.responseData=null}},{key:"handleResponseData",value:function(){var e,n=this.dataType,t=this.nativeXhr;if("blob"===n||"arraybuffer"===n)if(rr){var r,i,o;if("responseBody"in t)r=t.responseBody,i=or.dsVbsBinGetLength(r),e=new or.VBArray(or.dsVbsBinGetBytes(r,0,i)).toArray();else for(e=[],i=(r=t.responseText).length,o=0;o<i;++o)e.push(255&r.charCodeAt(o));r=null}else e=or.Blob?t.response:"responseBody"in t?t.responseBody:t.responseText;else if("json"==n)e=t.responseType&&"json"==t.responseType.toLowerCase()?t.response:t.responseText?An.parse(t.responseText):An.parse(t.response);else if("user-defined"===n)e=t.response!==undefined?t.response:t.responseText;else{this.responseText=e=t.responseText||"";try{var a=t.responseXML;a&&a.documentElement&&(this.responseXML=a)}catch(s){}}this.responseData=e}},{key:"sendInternal",value:function(e){var n,t,r,i,o,a,s,u,c,l,f,d=this;if(t=(n=this._setup(e)).method,tr(t)&&(t=t.toUpperCase()),o=n.contentType,r=n.url,i=n.dataType,u=n.mimeType,tr(r)&&(this.nativeXhr=a=dr(n.crossDomain),a)){try{if(this.state=1,n.username?a.open(t,r,n.async,n.username,n.password):a.open(t,r,n.async),(n.async||z.bIE)&&i&&"user-defined"!=i&&"responseType"in a)try{a.responseType=i}catch(T){}}catch(h){return void(this.state<2?(er(h,"error"),this._ioReady(-1,"open error: "+(An.isNumber(h.number)?"("+h.number+")":"")+(h.message||""))):er(h))}"withCredentials"in(s=n.xhrFields||{})&&(fr||delete s.withCredentials),$t(s,(function(e,n){try{a[n]=e}catch(T){er(T)}})),u&&a.overrideMimeType&&a.overrideMimeType(u),!1===(c=n.headers||{})["X-Requested-With"]&&delete c["X-Requested-With"],"setRequestHeader"in a&&(o&&a.setRequestHeader("Content-Type",n.contentType),a.setRequestHeader("Accept",i&&pr[i]?pr[i]+("*"===i?"":", */*; q=0.01"):pr["*"]),$t(c,(function(e,n){a.setRequestHeader(n,e)}))),"GET"!=t||n.cache||(a.setRequestHeader("If-Modified-Since","0"),a.setRequestHeader("Cache-Control","no-cache")),f=(l=!hr.test(n.method))&&n.data||null,l&&rr&&(f=n.data),n.async&&n.timeout>0&&(n.timeout<300&&(n.timeout=300),this.timeoutTimer=setTimeout((function(){d.abort("timeout")}),n.timeout));try{if(this.state=1,nr(this.beforeSend))if(!1===this.beforeSend(a,d))return void this.abort("cancel");a.send(f),f=null,n.data=null,nr(this.afterSend)&&this.afterSend(d)}catch(T){this.state<2?(er(T,"error"),this._ioReady(-1,"send error: "+(T.message||""))):er(T)}if(!n.async||4===a.readyState)return d._xhrCallback();a.onreadystatechange=function(){d._xhrCallback()}}}},{key:"_xhrCallback",value:function(e,n){var t,r=this.nativeXhr;try{if(4===r.readyState||n)if(Tr()||(r.onreadystatechange=_r),n)4!==r.readyState&&r.abort();else{Tr()||(this.responseHeadersString=r.getAllResponseHeaders());var i,o=r.status;try{i=r.statusText}catch(a){er("xhr statusText error: "),er(a),i=""}t=this._ioReady(o,i)}}catch(a){er(a,"error"),r.onreadystatechange=_r,n||this._ioReady(-1,a.message||"process error")}return t}},{key:"_setup",value:function(n){var t,r,i,o,a;if(n){for(r in this.context=n.context,delete n.context,n instanceof e&&(n=n.config),this.config=n,o=n.url,An.startsWith(o,"//")&&(n.url=o="http:"+o),(An.startsWith(o,"http://")||An.startsWith(o,"https://"))&&(a=new Zt(o)),t=n.dataType?n.dataType.toLowerCase():"text",n.dataType=t,n.method?n.method=n.method.toUpperCase():n.method="GET",a&&!("crossDomain"in n)&&(n.crossDomain=!a.isSameOriginAs(ar)),i=n.headers)i[r]===Qt&&delete i[r];An.mix(this,n)}return this.state=1,this}},{key:"dispose",value:function(){this.responseHeaders=null,this.responseHeadersString=null,this.responseData=null,this.responseText=null,this.responseXML=null,this.context=null,this.config=null,this.onSuccess=null,this.onError=null,this.onComplete=null,this.xhrFields=null,this.data=null,this.headers=null,this.beforeSend=null,this.afterSend=null}}]),e}();var Er=z.bIE&&z.IEVersion<=9;mr=self&&self.fetch?self.fetch:window.fetch;var vr=0;var br,wr,Cr,Wr,Ar=(br=null,Wr=!1,vr=wr=0,mr?Cr=function(e,n){var t=!1,r="text",i=!1;if(n&&(n.dataType&&(r=n.dataType),n.fetchRaw&&(i=!0),n.timeout)){var o=n.timeout;o<300&&(o=300);var a=new AbortController;n.signal=a.signal,setTimeout((function(){t||a.abort()}),o)}Wr=!1;var s=mr(e,n).then((function(e){if(e.ok){var n,r;if(t=!0,!br)return e;if(br.__clickCancel)return br.__clickCancel=!1,br.__cancelBeforObjectCreated=!1,Wr=!0,e;br.IfShowCancelDialogWhenImageTransfer?(yr(!0),r=br.on("cancel",(function(){Wr=!0}))):yr(!1);var i=e.headers.get("Content-Length"),o=0;br._onPercent&&vr==wr&&br._onPercent({loaded:o,total:i});var a=null==e||null===(n=e.body)||void 0===n?void 0:n.getReader(),s=new ReadableStream({start:function(e){a?setTimeout((function n(){return a.read().then((function(t){if(t.done||Wr)return Wr?a.cancel():r&&br.off("cancel",r),e.close(),void(r=null);var s=t.value;o+=s.length,br._onPercent&&vr==wr&&br._onPercent({loaded:o,total:i});try{return e.enqueue(s),n()}catch(u){An.error(u)}}))}),0):e.close()}}),u=e.headers.get("Content-Type");return u&&""!=u||(u="application/octet-stream"),new Response(s,{headers:{"Content-Type":u}})}if("opaqueredirect"==e.type)throw{code:vt.HTTPRedirected,message:"The http url redirected."};var c;throw jt(c={},e.status,e.statusText),{code:c._errorCode,message:c._errorString,httpCode:e.status}}));return i?s:(s="blob"==r?s.then((function(e){var n=e.headers.get("content-type");return"text/json"==n?e.json():z.bLinux?e.arrayBuffer().then((function(e){return new Blob([e],{type:n})})):e.blob()})):"json"==r?s.then((function(e){return e.json()})):"arraybuffer"==r?s.then((function(e){return"text/json"==e.headers.get("content-type")?e.json():e.arrayBuffer()})):s.then((function(e){return e.text()}))).then((function(e){var n;if(Wr)throw Wt(n={},-2615,"User cancelled the operation."),{code:n._errorCode,message:n._errorString};return e}))}:(Er&&An.addVBS(["Function dsVbsBinGetAt(strBinary,iOffset)\r\n"," dsVbsBinGetAt=AscB(MidB(strBinary,iOffset+1,1))\r\n","End Function\r\n","Function dsVbsBinGetBytes(strBinary,iOffset,iLength)\r\n"," Dim aBytes()\r\n"," ReDim aBytes(iLength-1)\r\n"," For i=0 To iLength-1\r\n","  aBytes(i)=dsVbsBinGetAt(strBinary,iOffset+i)\r\n"," Next\r\n"," dsVbsBinGetBytes=aBytes\r\n","End Function\r\n","Function dsVbsBinGetLength(strBinary)\r\n"," dsVbsBinGetLength=LenB(strBinary)\r\n","End Function"].join("")),Cr=function(e,n){return new(Cn.nativePromise||window.Promise)((function(t,r){var i,o=!1;i={url:e,async:!0,onSuccess:function(e,n,r){var i=!1;if(r.responseHeadersString&&-1!=r.responseHeadersString.indexOf("text/json")&&(An.isArray(e)||e instanceof ArrayBuffer)&&(i=!0),i){var o=e;e instanceof ArrayBuffer&&(o=new Uint8Array(e));var a=String.fromCharCode.apply(null,o);t(a)}else t(e)},onError:function(e,n,t){var i;jt(i={},t.status,n),r({code:i._errorCode,message:i._errorString,httpCode:t.status})},dataType:"text",method:Sr,data:Sr,headers:Sr,contentType:Sr,mimeType:Sr},n&&(n.method&&(i.method=n.method),n.body&&(i.data=n.body),n.headers&&(i.headers||(i.headers={}),An.each(n.headers,(function(e,n){"content-type"==n.toLowerCase()&&(o=!0),i.headers[n]=e}))),n.dataType&&(i.dataType=n.dataType),n.contentType&&(i.contentType=n.contentType),An.isNumber(n.timeout)&&n.timeout>0&&(i.timeout=n.timeout)),o&&(i.contentType=!1),"blob"==i.dataType&&Er&&(i.mimeType="text/plain; charset=x-user-defined"),br&&(br._onPercent&&(i.beforeSend=function(e,n,t){e.upload.addEventListener("progress",(function(e){br._onPercent&&vr==wr&&br._onPercent(e)}),!1)}),br.IfShowCancelDialogWhenImageTransfer?yr(!0):yr(!1));var a=function(e){if(e&&tr(e.url)){var n=new Ir;return e.async?(n.sendInternal(e),n):n.sendInternal(e)}An.log("the url is error.")}(i);br&&br.IfShowCancelDialogWhenImageTransfer&&br.on("cancel",(function(){a.abort()}))}))}),Cr);function yr(e){var n=An.sizzle(".dynamsoft-btnCancel");if(n.length>0){var t=n[0];t.style.display=e?"":"none"}}function Pr(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=_t(e);if(n){var i=_t(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return pt(this,t)}}function Dr(e,n){!function(e,n){if(n.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,n),n.add(e)}function Or(e,n,t){if(!n.has(e))throw new TypeError("attempted to get private field on non-instance");return t}var Lr=An.getLogger(),Nr=new WeakSet,Rr=new WeakSet,xr=function(e){gt(o,e);var t,r,i=Pr(o);function o(){var e;d(this,o);for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return Dr(Tt(e=i.call.apply(i,[this].concat(t))),Rr),Dr(Tt(e),Nr),e}return g(o,[{key:"send",value:(r=n(l.mark((function a(e,n,t){return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Lr.error("HTTP Client send not supported");case 1:case"end":return e.stop()}}),a)}))),function(e,n,t){return r.apply(this,arguments)})},{key:"requestSync",value:function(e,n,t){return undefined}},{key:"request",value:function(e,n,t,r){return Or(this,Rr,kr).call(this,e,n,t,undefined,undefined,r)}},{key:"testConnection",value:(t=n(l.mark((function s(e,n,t,r){return l.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Or(this,Rr,kr).call(this,undefined,undefined,e,n,t,r));case 1:case"end":return i.stop()}}),s,this)}))),function(e,n,r,i){return t.apply(this,arguments)})}]),o}(bt);function Fr(e){var n=this.serverInfo,t="";return t=n.ssl?"https://":"http://",t+=n.server,n.port&&(t+=":",t+=n.port),e&&(An.startsWith(e,"/")||An.endsWith(t,"/")||(t+="/"),An.endsWith(e,"/")?t+=e.slice(0,-1):t+=e),t}function kr(e,n,t,r,i,o){return Mr.apply(this,arguments)}function Mr(){return(Mr=n(l.mark((function e(n,t,r,i,o,a){var s,u;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=null!=r?r:{},n&&(s.body=n),s.method||(s.method="POST"),a&&(s.timeout=a),u=Or(this,Nr,Fr).call(this,t),Lr.debug("HTTP URL: "+u),e.next=9,Ar(u,s);case 9:return e.abrupt("return",e.sent);case 12:if(e.prev=12,e.t0=e["catch"](0),!(e.t0 instanceof It||e.t0&&e.t0.code&&e.t0.message)){e.next=18;break}throw e.t0;case 18:if(!e.t0.message){e.next=20;break}throw new It(e.t0.message);case 20:case"end":return e.stop()}}),e,this,[[0,12]])})))).apply(this,arguments)}function Br(e){try{return"object"===f(e)?e:(e="string"!=typeof e?An.stringify(e):e,An.parse(e))}catch(n){throw n instanceof It?n:new It(ct.JSON_REQUIRED)}}function Gr(e){return Math.random().toString(16).substring(2,2+e)}function Ur(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=_t(e);if(n){var i=_t(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return pt(this,t)}}function Hr(e,n){!function(e,n){if(n.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,n),n.add(e)}function jr(e,n,t){if(!n.has(e))throw new TypeError("attempted to get private field on non-instance");return t}var Vr,Xr=An.getLogger(),Kr=1006,zr=new WeakSet,Jr=new WeakSet,Yr=new WeakSet,qr=new WeakSet,Qr=new WeakSet,Zr=new WeakSet,$r=new WeakSet,ei=function(e){gt(a,e);var t,r,i,o=Ur(a);function a(e){var n;return d(this,a),Hr(Tt(n=o.call(this,e)),$r),Hr(Tt(n),Zr),Hr(Tt(n),Qr),Hr(Tt(n),qr),Hr(Tt(n),Yr),Hr(Tt(n),Jr),Hr(Tt(n),zr),xn(Tt(n),"_defaultRetries",1),xn(Tt(n),"_ws",Vr),xn(Tt(n),"_events",{}),xn(Tt(n),"_bHeartBeatStarted",!1),xn(Tt(n),"_heartBeatTicks",6e4),n._ws=Vr,n.bUseParentWS=!1,n._tasks=Object.create(null),n.bReady=!1,n._blob_callbacks=[],n._processing_blob=!1,n}return g(a,[{key:"ws",get:function(){return this._ws}},{key:"requestSync",value:function(e,n,t){return Xr.error("WebSocket Client requestSync not supported"),undefined}},{key:"send",value:(i=n(l.mark((function s(e,n,t){var r,i,o,a,u;return l.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(r=t.client,s.prev=1,(i=t.taskId)!==undefined){s.next=7;break}return s.next=6,n(e,St.GET_TASKID,r._requestTaskId,t);case 6:i=s.sent;case 7:if(o=r._tasks[i]){s.next=11;break}throw Xr.error("invalid task id: "+i),new It(ct.INVALID_TASK);case 11:return s.next=13,jr(r,Qr,si).call(r,!1);case 13:return s.next=15,jr(r,Zr,ci).call(r,e,n,t,o);case 15:Xr.debug("begin to send data "+i),r.disposed||r._ws.send(e),e=null,Xr.debug("end to send data "+i),s.next=27;break;case 21:s.prev=21,s.t0=s["catch"](1),Xr.debug("failed to send data."),Xr.error(s.t0),delete r._tasks[i],null===(a=o)||void 0===a||null===(u=a.resolver)||void 0===u||u.reject(s.t0.message);case 27:case"end":return s.stop()}}),s,null,[[1,21]])}))),function(e,n,t){return i.apply(this,arguments)})},{key:"request",value:function(e,n,t,r){var i=this._defaultRetries,o=null!=n?n:jr(this,qr,oi),a=null!=t?t:{client:this,userData:this};return jr(this,$r,fi).call(this,e,o,a,i,!1,undefined,r)}},{key:"connected",get:function(){var e;return(null===(e=this._ws)||void 0===e?void 0:e.readyState)==WebSocket.OPEN}},{key:"testConnection",value:function(e,n,t,r){return jr(this,Qr,si).call(this,!0,null!=n?n:0,t,r)}},{key:"_terminate",value:(r=n(l.mark((function u(){var e,n;return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(n in Xr.debug("terminate WSClient"),this.fireEvent("disposed"),e=!1,this._tasks)this._tasks[n]!==undefined&&this._tasks[n].resolver&&(e=!0);if(this._lic_callback=Vr,this._blob_callbacks=[],this._processing_blob=!1,this._ws&&(this._ws.onopen=null,this._ws.onerror=null,this._ws.onmessage=null,this._ws.onclose=null,this._ws.close()),this._ws=Vr,this._tasks=Object.create(null),!e){t.next=12;break}throw new It(ct.OBJECT_DISPOSING);case 12:case"end":return t.stop()}}),u,this)}))),function(){return r.apply(this,arguments)})},{key:"setRetry",value:function(e){this._defaultRetries=null!=e?e:1}},{key:"addEvent",value:function(e,n,t){var r=this._events[e];r||(this._events[e]={},r=this._events[e]),An.isString(n)&&An.isFunction(t)&&(r[n]=t)}},{key:"removeEvent",value:function(e,n){var t=this._events[e];t&&An.isString(n)&&delete t[n]}},{key:"clearEvent",value:function(e){this._events[e]&&(this._events[e]={})}},{key:"fireEvent",value:function(e){var n,t=this._events[e];if(t){var r=Object.keys(t);for(n=0;n<r.length;n++)An.isFunction(t[r[n]])&&t[r[n]]()}}},{key:"getRequestTaskId",value:function(){return this._requestTaskId?this._requestTaskId:0}}],[{key:"_waitForPreBlob",value:(t=n(l.mark((function c(e){return l.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e._processing_blob){n.next=3;break}return setTimeout((function(){a._waitForPreBlob(e)}),500),n.abrupt("return");case 3:a._preBlobResolv&&a._preBlobResolv();case 4:case"end":return n.stop()}}),c)}))),function(e){return t.apply(this,arguments)})}]),a}(bt);function ni(e){var n="";return n=e.ssl?"wss://":"ws://",n+=e.server,e.port&&(n+=":",n+=e.port),n}function ti(e,n,t,r){var i=this;return new Cn.Promise((function(o,a){try{var s,u,c=a,l=o;if(r&&(u=setTimeout((function(){var e=new It("createWebSocket timed out.");Xr.debug(e.message),c&&(c(e),c=null,l=null),u&&clearTimeout(u),s&&s.close()}),r)),e.bUseParentWS){var f=window,d=parent,T=f.WebSocket;try{for(;f!=d&&d&&d.WebSocket;)T=d.WebSocket,f=d.window,d=d.parent}catch(h){T=window.WebSocket}s=t?new T(n,t):new T(n)}else s=t?new WebSocket(n,t):new WebSocket(n);s.onopen=function(){u&&clearTimeout(u),e._ws=s,l&&(l(s),c=null,l=null)},s.onerror=function(n){s.close(),e.bReady=!1,u&&clearTimeout(u),i.fireEvent("error"),c&&(c(new It("websocket error")),c=null,l=null)},s.onmessage=function(n){jr(e,Yr,ri).call(e,e,n.data)},s.onclose=function(n){e.bReady=!1,u&&clearTimeout(u),i.fireEvent("close"),c&&(n&&n.code==Kr?c(new It("websocket error")):c(n),c=null,l=null)}}catch(g){if(g instanceof It||g&&g.code&&g.message)throw g;if(g.message)throw new It(g.message)}}))}function ri(e,n){return ii.apply(this,arguments)}function ii(){return(ii=n(l.mark((function e(n,t){var r,i,o,a,s,u,c,d,T,h;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n,e.prev=1,a={client:r,userData:undefined},"object"!==f(t)){e.next=17;break}if(!(r._blob_callbacks.length>0)){e.next=17;break}if(!r._processing_blob){e.next=9;break}return e.next=8,new Cn.Promise((function(e){ei._preBlobResolv=e,ei._waitForPreBlob(r)}));case 8:ei._preBlobResolv=null;case 9:return r._processing_blob=!0,s=r._blob_callbacks.shift(),e.next=13,s(t);case 13:return e.sent,r._processing_blob=!1,e.abrupt("return");case 17:if(!(r.bReady&&An.isString(t)&&(t.indexOf("Function not found")>0||t.indexOf("Version not found")>0))){e.next=19;break}return e.abrupt("return");case 19:if(r._cbToGetTaskId){e.next=21;break}return e.abrupt("return");case 21:return e.next=23,r._cbToGetTaskId(t,St.ONMESSAGE_PROCESS_DATA,r._requestTaskId,a);case 23:return u=e.sent,c=!1,e.next=27,r._cbToGetTaskId(u,St.ONMESSAGE_GET_TASKID,r._requestTaskId,a);case 27:if(o=e.sent){e.next=36;break}if(!u.Detail||!u.Domain){e.next=32;break}return r._lic_callback&&r._lic_callback(u),e.abrupt("return");case 32:return e.next=34,r._cbToGetTaskId(u,St.ONMESSAGE_GET_EVENT_TASKID,r._requestTaskId,a);case 34:(o=e.sent)&&(c=!0);case 36:if(i=r._tasks[o]){e.next=46;break}if(!c){e.next=42;break}i={},e.next=44;break;case 42:return""!=o&&Xr.log("invalid task id: "+o),e.abrupt("return");case 44:e.next=48;break;case 46:if(!i.timedout){e.next=48;break}return e.abrupt("return");case 48:return e.next=50,r._cbToGetTaskId(t,St.HANDLE_RAW_MESSAGE,r._requestTaskId,i.ctx);case 50:if((d=e.sent)!==undefined){e.next=55;break}return e.next=54,r._cbToGetTaskId(u,St.HANDLE_PROCESSED_MESSAGE,r._requestTaskId,i.ctx);case 54:d=e.sent;case 55:d&&!c&&(i.tmid&&clearTimeout(i.tmid),delete r._tasks[o],i.resolver&&i.resolver.resolve(d)),e.next=64;break;case 58:e.prev=58,e.t0=e["catch"](1),Xr.debug("failed to handle message."),e.t0 instanceof Error?Xr.error(e.t0):Xr.error(An.stringify(e.t0)),delete r._tasks[o],null===(T=i)||void 0===T||null===(h=T.resolver)||void 0===h||h.reject(e.t0.message);case 64:case"end":return e.stop()}}),e,null,[[1,58]])})))).apply(this,arguments)}function oi(e,n,t){return ai.apply(this,arguments)}function ai(){return(ai=n(l.mark((function e(n,t,r){var i,o;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next=e.t0===St.GET_TASKID?3:e.t0===St.HANDLE_RAW_MESSAGE?7:9;break;case 3:return(o=Br(n)).cmdId=null!==(i=o.cmdId)&&void 0!==i?i:(r=void 0,a=void 0,a=[Gr(8),"-",Gr(4),"-",Gr(4),"-",Gr(4),"-",Gr(8)],r&&a.unshift(r),a.join("")),Cn.Promise.resolve(["cmdId"]),e.abrupt("break",9);case 7:return Cn.Promise.resolve(n),e.abrupt("break",9);case 9:case"end":return e.stop()}var r,a}),e)})))).apply(this,arguments)}function si(e,n,t,r){return ui.apply(this,arguments)}function ui(){return ui=n(l.mark((function e(n,t,r,i){var o,a,s,u;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.connected&&!this.disposed){e.next=2;break}return e.abrupt("return");case 2:if(!(s=this)._connectPromise){e.next=7;break}return e.next=6,s._connectPromise;case 6:return e.abrupt("return");case 7:return t=null!==(o=t)&&void 0!==o?o:this._defaultRetries,r=null!==(a=r)&&void 0!==a?a:100,u=jr(s,zr,ni).call(s,s.serverInfo),Xr.debug("WebSocket URL: "+u+", try to create websocket "+t+"/"+r),s._connectPromise=new Cn.Promise((function(e,n){var o=function(r){jr(s,Jr,ti).call(s,s,u,s.serverInfo.protocol,i).then((function(n){e(n)}))["catch"]((function(e){Xr.debug("create websocket failed: "+e.message),r<t?a(r):n(e)}))};function a(e,n,t){setTimeout((function(){o(++e)}),r)}o(0)})),e.prev=12,e.next=15,s._connectPromise;case 15:e.next=20;break;case 17:throw e.prev=17,e.t0=e["catch"](12),e.t0;case 20:return e.prev=20,s._connectPromise=null,e.finish(20);case 23:case"end":return e.stop()}}),e,this,[[12,17,20,23]])}))),ui.apply(this,arguments)}function ci(e,n,t,r){return li.apply(this,arguments)}function li(){return(li=n(l.mark((function e(n,t,r,i){var o,a,s,u;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this,a=r.eventTaskId,s=r.lastEventTaskId,a!==undefined){e.next=7;break}return e.next=6,t(n,St.GET_EVENT_TASKID,o._requestTaskId,r);case 6:a=e.sent;case 7:a&&(o._tasks[a]?r&&r.userData&&r.userData.command&&((u=o._tasks[a]).ctx=r,s&&((u=o._tasks[s]).ctx=r)):(u={id:i.id,resolver:null,ctx:r,timedout:!1},o._tasks[a]=u,s&&(o._tasks[s]=u)));case 8:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function fi(e,n,t,r,i,o,a){return di.apply(this,arguments)}function di(){return(di=n(l.mark((function e(n,t,r,i,o,a,s){var u,c,f,d;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=this,e.prev=1,r.client=u,e.next=5,jr(u,Qr,si).call(u,o,i,a,s);case 5:if("0"!=(c=r.taskId)){e.next=12;break}return u.disposed||u._ws.send(n),n=null,e.abrupt("return");case 12:if(c!==undefined){e.next=16;break}return e.next=15,t(n,St.GET_TASKID,null,r);case 15:c=e.sent;case 16:return c===undefined&&Xr.debug("websocket send: task id is invalid."),(f={}).promise=new Cn.Promise((function(e,n){f.resolve=e,f.reject=n})),d={id:c,resolver:f,ctx:r,timedout:!1},u._tasks[c]=d,u._requestTaskId=c,e.next=24,jr(u,Zr,ci).call(u,n,t,r,d);case 24:return u._cbToGetTaskId=t,s&&(d.tmid=setTimeout((function(){Xr.debug("ws request time out."),d.timedout=!0,d.resolver.reject("request timed out.")}),s)),u.disposed||u._ws.send(n),Xr.debug("end to send task "+c),n=null,e.abrupt("return",f.promise);case 32:if(e.prev=32,e.t0=e["catch"](1),c&&delete u._tasks[c],!(e.t0 instanceof It||e.t0&&e.t0.code&&e.t0.message)){e.next=39;break}throw e.t0;case 39:if(!e.t0.message){e.next=41;break}throw new It(e.t0.message);case 41:return e.prev=41,n=null,e.finish(41);case 44:case"end":return e.stop()}}),e,this,[[1,32,41,44]])})))).apply(this,arguments)}function Ti(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return hi(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return hi(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==t["return"]||t["return"]()}finally{if(s)throw o}}}}function hi(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function gi(e,n){!function(e,n){if(n.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,n),n.add(e)}function pi(e,n,t){if(!n.has(e))throw new TypeError("attempted to get private field on non-instance");return t}var _i=new WeakSet,mi=new WeakSet,Si=function(){function e(){d(this,e),gi(this,mi),gi(this,_i),xn(this,"_maxWebSocketCon",10),xn(this,"_wsClients",[])}var t;return g(e,[{key:"removeTerminatedWSClient",value:function(){this._wsClients=this._wsClients.filter((function(e){return!e.disposed}))}},{key:"getClient",value:function(e,n){return e.useWS?pi(this,mi,Ei).call(this,e,n):new xr(e)}},{key:"closeClient",value:(t=n(l.mark((function r(e){var n,t,i,o;return l.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=this._wsClients,t=Ti(n),r.prev=2,t.s();case 4:if((i=t.n()).done){r.next=12;break}if(!dt((o=i.value).serverInfo,e)){r.next=10;break}if(o.disposed){r.next=10;break}return r.next=10,o.dispose();case 10:r.next=4;break;case 12:r.next=17;break;case 14:r.prev=14,r.t0=r["catch"](2),t.e(r.t0);case 17:return r.prev=17,t.f(),r.finish(17);case 20:this.removeTerminatedWSClient();case 21:case"end":return r.stop()}}),r,this,[[2,14,17,20]])}))),function(e){return t.apply(this,arguments)})},{key:"terminate",value:function(){var e=this._wsClients.slice();this._wsClients=[],e.forEach((function(e){e.dispose()}))}}],[{key:"Instance",get:function(){return this._gClientPool||(this._gClientPool=new e),this._gClientPool}}]),e}();function Ii(e){this.removeTerminatedWSClient();var n,t=Ti(this._wsClients);try{for(t.s();!(n=t.n()).done;){var r=n.value;if(dt(r.serverInfo,e)&&!r.disposed)return r.addRef(),r}}catch(i){t.e(i)}finally{t.f()}return null}function Ei(e,n){var t;return n||(t=pi(this,_i,Ii).call(this,e)),t||(this._wsClients.length<this._maxWebSocketCon?((t=new ei(e)).addEvent("disposed","1",(function(){Si.Instance.removeTerminatedWSClient()})),this._wsClients.push(t),t):null)}function vi(e){An.log(e)}xn(Si,"_gClientPool",null),Cn.ClientPool=Si,Cn.install={_divDWTNonInstallContainerID:"dwt-NonInstallContainerID",_divDWTemessageContainer:"",_dlgInstall:!1},Cn.install._strNonInstallDIV=['<div style="text-align:center;" id="',Cn.install._divDWTNonInstallContainerID,'"></div>'].join(""),Cn._zdgb_xkz_dhk=function(){var e=Cn.install._dlgInstall;if(e){var n=An.sizzle(".dynamsoft-dialog-closeTimer",e);if(n.length>0){var t=n[0],r=parseInt(t.style.width);(r-=1)<=0?Pn.DWT.CloseDialog():(t.style.width=r+"%",setTimeout(Cn._zdgb_xkz_dhk,100))}}},Cn.ShowLicenseDialog=Pn.DWT.ShowMessage,Cn.createLoadingBarContent=function(){};var bi,wi="Checking Product Key format...";function Ci(e,n){!function(e,n){if(n.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,n),n.add(e)}function Wi(e,n,t){if(!n.has(e))throw new TypeError("attempted to get private field on non-instance");return t}!function(e){e.CM_RENDERALL=1,e.CM_IMAGEONLY=2,e.CM_AUTO=3,e.CM_RENDERALLWITHANNOTATION=4}(bi||(bi={}));var Ai=On+".",yi=parseInt(On),Pi={ActiveX:0,Plugin:1,HTML5:2,WinMacLinux:3,Barcode1D:4,Barcode2D:5,BarcodeWriter:6,OCR:7,Webcam:8,PDFRasterizer:9,OCRPro:10,QR:50,PDF417:51,DataMatrix:52};function Di(e){return An.isString(e)?An.trim(e):e}var Oi=new WeakSet,Li=new WeakSet,Ni=new WeakSet,Ri=new WeakSet,xi=new WeakSet,Fi=new WeakSet,ki=new WeakSet,Mi=new WeakSet,Bi=new WeakSet,Gi=function(){function e(){d(this,e),Ci(this,Bi),Ci(this,Mi),Ci(this,ki),Ci(this,Fi),Ci(this,xi),Ci(this,Ri),Ci(this,Ni),Ci(this,Li),Ci(this,Oi),xn(this,"isLTS",Ct)}return g(e,[{key:"isLongKey",value:function(e){if(An.isString(e)&&e.length>0){var n=e.charAt(0);if("f"==n||"t"==n)return!0;if(An.startsWith(e,"DLS"))return!1;if(An.isNumber(e))return!1;var t=parseInt(e)+"-";return!An.startsWith(e,t)}return!1}},{key:"isLicenseMixed",value:function(e,n){var t,r=!1,i=e||Pn.DWT.ProductKey;(Pn.DWT.lclex(),n)&&((Di(Pn.DWT.organizationID)||Di(Pn.DWT.handshakeCode))&&i&&(r=!0,Wt(t={},-2444,"A license can only be specified once and has already been set using the ProductKey API.")));if(!r&&An.isString(i))if(i=An.trim(i),An.startsWith(i,"f")||An.startsWith(i,"t"));else if(""==i);else if(An.startsWith(i,"DLS2"))try{Wi(this,Li,Hi).call(this,i)}catch(a){r=!0,Wt(t={},-2440,""),t._errorString=a.message}else{Wi(this,Oi,Ui).call(this,i).LTS||(r=!0,function(e){Wt(e,Et.LicenseParseFailed,"The license is invalid.")}(t={}))}if(r&&t){At(t);var o=Pn.DWT.licenseException;An.error(o.message)}return r}},{key:"reparseProductKey",value:function(e){e&&vi("Parsing Product Key...");var n=Di(Pn.DWT.organizationID),t=Di(Pn.DWT.handshakeCode),r=n||t,i=An.trim(Pn.DWT.ProductKey);if(!r){var o=Wi(this,Oi,Ui).call(this,i);o.LTS&&(t=Di(o.handshakeCode),r=(n=Di(o.organizationID))||t)}if(r)return this._innerResetLicense(),An.isNumber(i)&&(n=i),Yn.handshakeCode=t,Yn.organizationID=n,Yn.licenseServer=Pn.DWT.licenseServer,Yn.sessionPassword=Pn.DWT.sessionPassword,void(Yn.bPublicLTS=Wi(this,Ni,ji).call(this,Yn.licenseServer,r));var a=!1;if(Yn.refProductKey!==i&&(this._innerResetLicense(),An.isString(i)&&i.length>0&&(Yn.refProductKey=i,a=!0)),a)if(this.isLongKey(Yn.refProductKey))Yn.bPublicLTS=!1;else{var s,u={_pLoad:{isEmpty:$n},_license:Yn.refProductKey,_licenseServer:[]};try{s=ft(u)}catch(l){An.error(l),s=!1}if(s&&An.isString(s.l)){var c=An.trim(s.l);""==c?Yn.organizationID=c:-1!=c.indexOf("-")?Yn.handshakeCode=c:Yn.organizationID=c,An.isArray(s.ls)&&s.ls.length>0&&(Yn.licenseServer=s.ls),Yn.bPublicLTS=Wi(this,Ni,ji).call(this,Yn.licenseServer,c),Yn.sessionPassword=s.sp}else Yn.bPublicLTS=!1}}},{key:"_innerResetLicense",value:function(){Yn.refProductKey="",Yn.handshakeCode=undefined,Yn.organizationID=undefined,Yn.licenseServer=undefined,Yn.sessionPassword="",Yn.bPublicLTS=!0}},{key:"checkOSForAllowCore",value:function(e,n,t){if(Yn.bHTML5Edition){if(e)return Wi(this,Bi,Yi).call(this,n);var r=t._bRemoteMode,i=t.__serverPlatform;return this.isOSOK(n,r,i)}return $n}},{key:"checkLocalPlatformForRemoteService",value:function(e){var n,t,r,i=e.__licenseInfo,o=jn.getEnumPlatform(),a=!1;for(n=0;n<i.Detail.length;n++)if(t=i.Detail[n],(r=Wi(this,ki,zi).call(this,t.EnumLicenseType,t.LicenseType)).Core&&An.isString(t.Version)&&0==t.Version.indexOf(Ai)){if(a=Wi(this,Bi,Yi).call(this,t.OS))break;if(a=this.isOSOK(t.OS,true,o))break;if(!e._blts&&e._bScanForProxyRemote&&r.RemoteScan)break}return a||(o==Gn.enumWindow?function(e){Wt(e,-2344,"The current product key does not support Windows OS. "+yt()),At(e)}(e):o==Gn.enumLinux?function(e){Wt(e,-2346,"The current product key does not support Linux OS. "+yt()),At(e)}(e):o==Gn.enumMac?function(e){Wt(e,-2345,"The current product key does not support MAC OS. "+yt()),At(e)}(e):function(e){Wt(e,-2347,"The current product key does not support your OS. "+yt()),At(e)}(e)),a}},{key:"checkProductKey",value:function(e,n,t){var r,i=Pn.DWT.licenseException;return!n.Camera&&(e.__licenseInfo||(e.__licenseInfo={}),(r=Wi(this,xi,Xi).call(this,e,e.__licenseInfo,Zn,n,t))||(i.code=e._errorCode,i.message=e._getErrorString(),i.fromLTS=!1),r)}},{key:"isBindDomainOK",value:function(e){if(An.isUndefined(e)||null==e||""==e||"*"==e||"*.*"==e)return $n;var n=location.hostname,t=Zn;if(""==n)return $n;for(var r=n.toLowerCase().split("."),i=r.length,o=e.toLowerCase().split(";"),a=0;a<o.length;a++){var s=o[a];if("*.*"==s){t=$n;break}var u=s.split("."),c=u.length;if(c>0&&c-1<=i){for(var l=$n,f=c-1;f>0;f--){if(u[f].indexOf("*")>-1){t=$n;break}if(f+i-c>=0){if(r[f+i-c]!=u[f]){l=Zn;break}}else if("*"!=u[f]){l=Zn;break}}if(l&&("*"==u[0]||i>=c&&r[i-c]==u[0])){t=$n;break}}}return t}},{key:"isExpiredOrFuture",value:function(e,n){if(""==e)return Zn;if(!n){var t=e.length;if(t>2&&"/"==e[t-2]&&"0"==e[t-1])return Zn}var r=Qi(e),i=(new Date).getTime(),o=i+5184e6;return r.getTime()<i||n&&r.getTime()>o?$n:Zn}},{key:"willTrialExpire",value:function(e){if(""==e)return Zn;var n=Qi(e),t=(new Date).getTime();return n.getTime()<t+432e6&&n.getTime()>t?$n:Zn}},{key:"isOSOK",value:function(e,n,t){var r=!1,i=!1,o=!1,a=!1,s=!1,u=!1,c=!1,l=!1;return""==e||"0"==e?$n:(n?t==Gn.enumWindow?o=!0:t==Gn.enumLinux?i=!0:t==Gn.enumMac?r=!0:t==Gn.enumEmbed?s=!0:t==Gn.enumChromeOS?u=!0:t==Gn.enumAndroid?c=!0:t==Gn.enumHarmonyOS?l=!0:t==Gn.enumiOS&&(a=!0):(r=z.bMac,i=z.bLinux,o=z.bWin,a=z.biPhone||z.biPad,u=z.bChromeOS,s=Pn.navInfo.bEmbed,c=z.bAndroid,l=z.bHarmonyOS),(e=e.toLowerCase()).indexOf("windows")>-1&&o||e.indexOf("mac")>-1&&r||e.indexOf("linux")>-1&&(i||u||l)||e.indexOf("android")>-1&&c||e.indexOf("ios")>-1&&a||e.indexOf("embed")>-1&&s?$n:Zn)}},{key:"isBrowserOK",value:function(e){if(An.isString(e)){if(""==e||"0"==e)return $n;var n=(e=e.toLowerCase()).split(";"),t=Zn;return An.each(n,(function(e){("chrome"==An.trim(e)&&(z.bChrome||z.bSafari||z.bOpera||z.bEdge)||"ie"==An.trim(e)&&z.bIE||"firefox"==An.trim(e)&&z.bFirefox)&&(t=$n)})),t}return Zn}},{key:"isAllowLicenseType",value:function(e,n){return n.Core?e.Core:n.PDFRasterizer?e.PDFRasterizer:n.Webcam||n.Camera?e.Webcam:n.barcode1D?e.barcode1D:n.QR?e.QR:n.PDF417?e.PDF417:n.DataMatrix?e.DataMatrix:n.OCR?e.OCR:n.OCRPro?e.OCRPro:e.Core}},{key:"setNoAllowedLicenseTypeError",value:function(e,n,t){t.Core?Nt(e):t.Webcam||t.Camera?n||t.Camera?function(e){e._errorCode=-2431,Ct()?e._errorString="The license for the Camera Addon is not found or has expired.":Wt(e,-2431,"The current product key does not support Camera Addon. "+yt()),At(e)}(e):function(e){e._errorCode=-2338,Ct()?e._errorString="The license for the module direct show is not found or has expired.":e._errorString="The current product key does not support Webcam. "+yt(),At(e)}(e):t.PDFRasterizer?n?function(e){e._errorCode=-2370,Ct()?e._errorString="The license for the module pdf rasterizer is not found or has expired.":e._errorString="The current product key does not support Pdf Rasterizer Wasm. "+yt(),At(e)}(e):Rt(e):t.OCR?function(e){e._errorCode=-2340,Ct()?e._errorString="The license for the module ocr is not found or has expired.":e._errorString="The current product key does not support OCR. "+yt(),At(e)}(e):t.OCRPro?function(e){e._errorCode=-2341,Ct()?e._errorString="The license for the module ocr pro is not found or has expired.":e._errorString="The current product key does not support OCR pro. "+yt(),At(e)}(e):Ot(e)}},{key:"getLicenseDateString",value:function(e){var n,t=e.getFullYear();return[(n=e.getMonth()+1)>=10?""+n:"0"+n,"/",e.getDate()>=10?""+e.getDate():"0"+e.getDate(),"/",t].join("")}},{key:"hasPDFRProductKey",value:function(e){return!!this.checkProductKey(e,{PDFRasterizer:!0},!0)||(e._resetErr(),!1)}},{key:"checkPDFProductKeyWhenNeeds",value:function(e,n){var t;if((n==Pn.DWT.EnumDWT_ImageType.IT_PDF||n==Pn.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF)&&(Yn.bHTML5Edition?e.__addon&&e.__addon.PDF&&(t=e._getConvertMode()):e.Addon&&e.Addon.PDF&&(t=e._getConvertMode()),t==bi.CM_RENDERALL||t==bi.CM_RENDERALLWITHANNOTATION))return this.checkProductKey(e,{PDFRasterizer:!0},!0);return $n}},{key:"getPublicLicenseContent",value:function(e){var n=[],t=e;if(!An.isString(t)){if(An.isUndefined(t))return"";t=t instanceof Error||"message"in t?t.message:""+t}var r=t.indexOf("["),i=t.indexOf("]",r),o=t.indexOf("(",i),a=t.indexOf(")",o);if(-1==r||-1==i||-1==o||-1==a)return t;r>0&&n.push(t.substring(0,r));var s=t.substring(r+1,i),u=t.substring(o+1,a);return n.push(['<a href="',u,'" target="_blank" class="dynamsoft-major-color">',s,"</a>"].join("")),n.push(t.substring(a+1)),n.join("")}},{key:"getLTSLicense",value:function(){return Yn.bPublicLTS?"":Yn.handshakeCode||Yn.organizationID}}]),e}();function Ui(e){var n,t,r=e,i=e.indexOf("-"),o=-1!=i;return t={},o&&(r=e.substring(0,i)),n=Number(r),isNaN(n)||String(Number(n))!==r||(o?t.handshakeCode=e:t.organizationID=e,t.LTS=$n),t}function Hi(e){ft({_pLoad:{isEmpty:$n},_license:e,_licenseServer:[]})}function ji(e,n){var t=!0;if(An.isArray(e)&&e.length>0){var r=e[0];An.isString(r)&&""!=r&&-1==r.indexOf("https://mlts.dynamsoft.com")&&(t=!1)}return t&&(!n||"200001"===n||An.startsWith(n,"200001-"))}function Vi(e,n,t){return this.checkOSForAllowCore(e,n,t)}function Xi(e,n,t,r,i){var o,a=!1;if(Yn.bHTML5Edition&&An.isFunction(e._needCheckProxyRemoteScanLicense)&&(a=e._needCheckProxyRemoteScanLicense()),n&&n.LTS){if(!n||!An.isArray(n.Detail)||0==n.Detail.length)return this.isLTS()?Nt(e):Ot(e),Zn}else if(!n||!An.isArray(n.Detail)||0==n.Detail.length)return this.isLTS()?Nt(e):Ot(e),Zn;var s,u,c,l,f=0,d=0,T=[],h=[],g=Zn,p=Zn,_=Zn,m=Zn,S=Zn;if(!this.isBindDomainOK(n.Domain))return function(e){Wt(e,-2342,"The domain of your current site does not match the domain bound in the current product key. "+yt()),At(e)}(e),Zn;for(n.Detail.length>0&&(o="FALSE"!=(c=n.Detail[0]).Trial),u=1;u<n.Detail.length;u++)if("FALSE"==(c=n.Detail[u]).Trial&&o||"TRUE"==c.Trial&&!o)return Gt(e),Zn;if(n.bTrial=o,r.Core||r.Webcam){var I=[],E=!1;for(u=0;u<n.Detail.length;u++)if(c=n.Detail[u],l=Wi(this,ki,zi).call(this,c.EnumLicenseType,c.LicenseType),r.Core&&l.Core&&this.checkOSForAllowCore(t,c.OS,e)||r.Core&&l.Core&&Yn.bActiveXEdition&&l.ActiveX||r.Webcam&&l.Webcam&&!t){if(n.LTS);else if(!An.isString(c.Version)||0!=c.Version.indexOf(Ai)){I.push(c);continue}if(Yn.bHTML5Edition){if(l.ActiveX&&!l.Html5)continue;if(a&&!l.RemoteScan)continue;h.push(c)}else{if(!l.ActiveX&&l.Html5)continue;h.push(c)}E=!0}if(!E&&I.length>0)return I.splice(0),function(e,n){var t=yt();Wt(e,Et.LicenseVersionNotCurrent,"The current product key is not for version ".concat(n,". ").concat(t)),At(e)}(e,[On,Ln].join(".")),!1;I.splice(0)}else h=n.Detail;for(u=0;u<h.length;u++){var v=$n;if(c=h[u],l=Wi(this,ki,zi).call(this,c.EnumLicenseType,c.LicenseType),r.Core&&l.Core||this.isAllowLicenseType(l,r)){s=c.ExpireDate.replace(/-/g,"/");var b="FALSE"!=c.Trial;if(this.isExpiredOrFuture(s,b))T.push(s);else if(b&&l.Core&&this.willTrialExpire(s)&&(n.ExpireDate=s),n.LTS||l.Core&&Yn.bHTML5Edition&&parseInt(c.Version)>=yi||l.Core&&Yn.bActiveXEdition||!l.Core){var w=!1;if(l.Core)(this.checkOSForAllowCore(t,c.OS,e)||Yn.bActiveXEdition&&l.ActiveX)&&(w=!0);else{var C=t;r.Camera&&(C=!0),Wi(this,Ri,Vi).call(this,C,c.OS,e)&&(w=!0)}w?this.isBrowserOK(c.Browser)||i?(f++,v=Zn):p=$n:r.Core?g=$n:r.PDFRasterizer?m=$n:(r.Webcam||r.Camera)&&(S=$n)}else _=$n;v&&d++}}if(f>0)return $n;if(0==d)return this.setNoAllowedLicenseTypeError(e,t,r),Zn;if(T.length>0){var W,A=0,y=1e20,P="",D=(new Date).getTime();for(s="",u=0;u<T.length;u++)(W=Qi(T[u])).getTime()<D&&W.getTime()>A?(A=W.getTime(),s=T[u]):W.getTime()>D&&W.getTime()<y&&(y=W.getTime(),P=T[u]);return""!=s?(W=Qi(s),Lt(e,s=this.getLicenseDateString(W))):""!=P?(W=Qi(P),P=this.getLicenseDateString(W),function(e,n){Wt(e,Et.LicenseIsFuture,"The current product key is invalid. "+yt()),At(e)}(e)):Lt(e,""),Zn}return _?(function(e){Wt(e,-2348,"The current product key is invalid because it's generated with the licenses of a different major version."),At(e)}(e),Zn):p?(z.bEdge?function(e){Wt(e,-2330,"The current product key does not support Edge. "+yt()),At(e)}(e):z.bChrome?function(e){Wt(e,-2327,"The current product key does not support Chrome. "+yt()),At(e)}(e):z.bFirefox?function(e){Wt(e,-2328,"The current product key does not support Firefox. "+yt()),At(e)}(e):z.bIE?function(e){Wt(e,-2329,"The current product key does not support IE. "+yt()),At(e)}(e):z.bSafari?function(e){Wt(e,-2392,"The current product key does not support Safari. "+yt()),At(e)}(e):function(e){Wt(e,-2343,"The current product key does not support your browser. "+yt()),At(e)}(e),Zn):g?(this.setNoAllowedLicenseTypeError(e,t,{Core:!0}),Zn):m?(this.setNoAllowedLicenseTypeError(e,t,{PDFRasterizer:!0}),Zn):S?(this.setNoAllowedLicenseTypeError(e,t,{Webcam:!0}),Zn):(Ot(e),Zn)}function Ki(e){var n=Zn,t=Zn,r=Zn,i=Zn,o=Zn,a=Zn,s=Zn,u=Zn,c=Zn;return An.isString(e)&&""!=e&&An.each(e.split(";"),(function(e){var l=1*e;l==Pi.HTML5||l==Pi.WinMacLinux||l==Pi.ActiveX||l==Pi.Plugin?n=$n:l==Pi.Barcode1D?t=$n:l==Pi.QR?r=$n:l==Pi.PDF417?i=$n:l==Pi.DataMatrix?o=$n:l==Pi.OCR?a=$n:l==Pi.Webcam?s=$n:l==Pi.PDFRasterizer?u=$n:l==Pi.OCRPro&&(c=$n)})),{Core:n,PDFRasterizer:u,Webcam:s,barcode1D:t,QR:r,PDF417:i,DataMatrix:o,OCR:a,OCRPro:c}}function zi(e,n){var t=Wi(this,Fi,Ki).call(this,e),r=Wi(this,Mi,Ji).call(this,n);return An.each(["Core","Html5","RemoteScan","LocalScan","ActiveX","PDFRasterizer","Webcam","barcode1D","QR","PDF417","DataMatrix","OCR","OCRPro"],(function(e){t[e]=t[e]||r[e]})),t}function Ji(e){var n=Zn,t=Zn,r=Zn,i=Zn,o=Zn,a=Zn,s=Zn,u=Zn,c=Zn,l=Zn,f=Zn,d=Zn,T=Zn;return e&&""!=e&&((e=e.toLowerCase()).indexOf("html5")>-1||"win=(aph) or mac=(ph) or linux(h)"==e?(n=$n,e.indexOf("html5;activex;oldie")>-1?i=$n:e.indexOf("html5;activex")>-1?(t=$n,T=$n,i=$n):(t=$n,T=$n),e.indexOf(";remotescan")>-1&&(t=$n,d=$n,e.indexOf(";onlyremote")>-1&&(T=Zn))):"1d barcode reader"==e?r=$n:"2d barcode reader(qrcode)"==e?o=$n:"2d barcode reader(pdf417)"==e?a=$n:"2d barcode reader(data matrix)"==e?s=$n:"ocr"==e?u=$n:"webcam"==e?c=$n:"pdf rasterizer"==e?l=$n:"proocr"==e&&(f=$n)),{Core:n,Html5:t,RemoteScan:d,LocalScan:T,ActiveX:i,PDFRasterizer:l,Webcam:c,barcode1D:r,QR:o,PDF417:a,DataMatrix:s,OCR:u,OCRPro:f}}function Yi(e){var n=e.toLowerCase();return n.indexOf("wasm")>-1||n.indexOf("mobile")>-1}var qi=new Gi;function Qi(e){var n,t=e;return t=t.replace(/-/g,"/"),n=Date.parse(t),isNaN(n)&&(n=0),(n=new Date(n)).setHours(23,59,59,999),n}function Zi(e){var n=Pn.DWT.licenseException;n.code=e.code,n.message=e.message,e&&(!function(e){An.isFunction(Pn.DWT.OnWebTwainError)?Pn.DWT.OnWebTwainError(e):An.isFunction(window.Dynamsoft_OnError)&&window.Dynamsoft_OnError(e)}(e),e instanceof Error?An.error(e):An.error(An.stringify(e)))}function $i(e){var n=0,t=e.message;An.isNumber(e.code)?n=e.code:An.isString(t)&&(n=-1),0!=n&&function(e,n){An.isFunction(Pn.OnLicenseError)&&Pn.OnLicenseError(n,e)}(n,t)}function eo(e){$i(function(e){return{code:e._errorCode,message:e._errorString}}(e))}Pn.DWT.isPublicLicense=function(){return Yn.bPublicLTS};var no=z.bWin,to=z.bMac,ro=z.bLinux,io=z.bSafari,oo=z.bFirefox,ao=z.bChrome,so=location.hostname,uo=location.pathname,co=0,lo=z.bMobile,fo=parseFloat(z.strBrowserVersion);if(z.bWin||z.bMac||z.bLinux||z.bChromeOS){if(Pn.navInfo){var To=Pn.navInfo;lo=lo||To.bAndroid||To.bPad||To.biPhone||To.biPad}}else lo=!0;""===so?no&&uo.lastIndexOf("\\")>1?uo=uo.substring(1,uo.lastIndexOf("\\")).replace(/%20/g," "):(co=1,uo=uo.substring(1,uo.lastIndexOf("/")).replace(/%20/g," ")):(co=1,uo=uo.substring(0,uo.lastIndexOf("/")));var ho={bChrome:ao,bFirefox:oo,bSafari:io,bIE:z.bIE,bEdge:z.bEdge,bWin:no,bMac:to,bLinux:ro,iPluginLength:0,bFileSystem:z.bFileSystem,bMobile:lo,strIEVersion:z.IEVersion,strChromeVersion:z.bChrome?fo:"",strFirefoxVersion:z.bFirefox?fo:"",basePath:uo,pathType:co,isDesktopViewer:function(){return z.bWin||z.bLinux||z.bChromeOS||z.bMac},isPadViewer:function(){return z.bPad||z.biPad},isMobileViewer:function(){return z.bMobile||z.biPhone||z.bAndroid||z.bHarmonyOS},WSVersion:"18.5.0",WSSession:(new Date).getTime(),bDiscardBlankImage:Zn};Cn.product=Yn;var go={encodeChars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",decodeChars:[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1]},po=self||window;Cn.btoa=function(e){for(var n,t,r=String(e),i=0,o=go.encodeChars,a="";r.charAt(0|i)||(o="=",i%1);a+=o.charAt(63&n>>8-i%1*8)){if((t=r.charCodeAt(i+=3/4))>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");n=n<<8|t}return a},po.btoa||(po.btoa=Cn.btoa),Cn.atob=function(e){var n=String(e).replace(/[=]+$/,"");if(n.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var t,r,i=0,o=0,a="";r=n.charAt(o++);~r&&(t=i%4?64*t+r:r,i++%4)?a+=String.fromCharCode(255&t>>(-2*i&6)):0)r=go.encodeChars.indexOf(r);return a},po.atob||(po.atob=Cn.atob);var _o={isFunction:function(e){return e&&"function"==typeof e},isReturnSuccess:function(e){if(-2115===e._errorCode)return $n;if(-2003===e._errorCode&&!Pn.DWT.IfHttpPostErrorNoWindow){var n=window.open("","ErrorMessage","height=500,width=750,top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no");null==n||n.document.writeln(e.HTTPPostResponseString)}return 0==e._errorCode?$n:Zn},setErrorString:function(e){e._errorCode=e.getSWebTwain().ErrorCode,e._errorString=e.getSWebTwain().ErrorString},checkErrorString:function(e){return _o.setErrorString(e),_o.isReturnSuccess(e)},wrapperRet:function(e,n,t,r,i,o){if(_o.checkErrorString(e)){if(_o.isFunction(t))if(i){var a=e.getSWebTwain().HTTPPostResponseString;a&&""!=a?(e._errorCode=-2003,e._errorString="HTTP process error.",Cn.isFunction(r)&&r(e._errorCode,e._errorString,a)):t(a)}else{if(o)return t(n),!0;t()}}else _o.isFunction(r)&&(i?r(e._errorCode,e._errorString,e.getSWebTwain().HTTPPostResponseString):r(e._errorCode,e._errorString));return n},wrapperPromise:function(e,n){return _o.setErrorString(e),0==e._errorCode?Cn.Promise.resolve(n):Cn.Promise.reject({code:e._errorCode,message:e._errorString})},getImageType:function(e){if(e===undefined)return-1;if(e.length<4)return-1;var n=e.lastIndexOf(".");if(-1===n)return-1;var t=e.slice(n).toLowerCase();return".bmp"===t||".dib"===t?Pn.DWT.EnumDWT_ImageType.IT_BMP:".jpg"===t||".jpe"===t||".jpeg"===t||".jfif"===t?Pn.DWT.EnumDWT_ImageType.IT_JPG:".tif"===t||".tiff"===t?Pn.DWT.EnumDWT_ImageType.IT_TIF:".png"===t?Pn.DWT.EnumDWT_ImageType.IT_PNG:".pdf"===t?Pn.DWT.EnumDWT_ImageType.IT_PDF:".jp2"===t||".j2k"===t||".j2c"===t?Pn.DWT.EnumDWT_ImageType.IT_J2K:-1},replaceLocalFilename:function(e){var n=e;return z.bFileSystem&&(n=decodeURI(n)),n},makeParams:function(){var e=arguments;return e===undefined||0===e.length?undefined:e}};Cn.checkErrorString=_o.checkErrorString,Cn.wrapperRet=_o.wrapperRet,Cn.setErrorString=_o.setErrorString,Cn.DynamicLoadAddonFuns=[],Cn.attachAddon=function(e){if(z.bWin){var n,t=!Pn.navInfo.bOSx64||Pn.navInfo.bWOW64,r=e.getSWebTwain();n=t?"DynamicPdfCore_"+Un.ActiveXPdfVersion+".dll":"DynamicPdfCorex64_"+Un.ActiveXPdfVersion+".dll";try{r.GetAddOnVersion("pdf",n)["catch"]((function(){}))}catch(i){}Cn.each(Cn.DynamicLoadAddonFuns,(function(n){Cn.isFunction(n)&&n(e)}))}};var mo,So,Io,Eo,vo,bo,wo,Co,Wo,Ao,yo,Po,Do,Oo,Lo,No,Ro,xo,Fo,ko,Mo,Bo,Go,Uo,Ho,jo,Vo,Xo,Ko,zo,Jo,Yo,qo,Qo;Cn.attachProperty=function(e){var n=e,t=function(e,t,r){var i;0!==t&&1!==t?i=t:(i={},t&&(i.set=1==r?function(t){return t*=1,!Cn.isNumber(t)||isNaN(t)?(Dt(n),Zn):(n.getSWebTwain()[e]=t,_o.checkErrorString(n))}:2==r?function(t){return Cn.isBoolean(t)?(n.getSWebTwain()[e]=t,_o.checkErrorString(n)):(Dt(n),Zn)}:function(t){return Cn.isString(t)?(n.getSWebTwain()[e]=t,_o.checkErrorString(n)):(Dt(n),Zn)})),i.get||(i.get=function(){var t=n.getSWebTwain()[e];return n._errorCode=n.getSWebTwain().ErrorCode,n._errorString=n.getSWebTwain().ErrorString,t}),e in n||Object.defineProperty(n,e,i)};t("ErrorCode",{get:function(e){return n._errorCode}}),t("ErrorString",{get:function(e){return n._errorString}}),t("LogLevel",{get:function(){var e=n.getSWebTwain().LogLevel;return n._errorCode=n.getSWebTwain().ErrorCode,n._errorString=n.getSWebTwain().ErrorString,e},set:function(e){var t=1*e;return!Cn.isNumber(t)||isNaN(t)?(Dt(n),Zn):(n.getSWebTwain().LogLevel=t,_o.checkErrorString(n))}}),t("Manufacturer",1),t("ProductFamily",1),t("ProductKey",{get:function(){return Pn.DWT.ProductKey},set:function(e){var t=$n,r=e;if(r=Cn.isString(r)?Cn.trim(r):"",Pn.DWT.ProductKey=r,qi.reparseProductKey(),n.__licenseInfo=undefined,""==r)t=Zn,qi.checkProductKey(n,{Core:$n},Zn)||eo(n);else{var i=Pn.DWT.licenseException;if(0!=i.code)return n._errorCode=i.code,n._errorString=i.message,t;n.__licenseInfo=undefined,n.GetLicenseInfo(r),t=_o.checkErrorString(n)}return t}}),t("ProductName",1),t("VersionInfo",1),t("BitDepth",1,1),t("Brightness",1,1),t("Contrast",1,1),t("CurrentSourceName",0),t("DataSourceStatus",0),t("DefaultSourceName",0),t("Duplex",0),t("IfAppendImage",1,2),t("IfAutoBright",1,2),t("IfAutoDiscardBlankpages",1,2),t("IfAutoFeed",1,2),t("IfAutomaticBorderDetection",1,2),t("IfAutomaticDeskew",1,2),t("IfAutoScan",1,2),t("IfDisableSourceAfterAcquire",1,2),t("IfDuplexEnabled",1,2),t("IfFeederEnabled",1,2),t("IfModalUI",1,2),t("IfScanInNewThread",1,2),t("IfSortBySelectionOrder",1,2),t("IfShowCancelDialogWhenImageTransfer",1,2),t("IfShowUI",1,2),t("IfShowIndicator",1,2),t("IfUseTwainDSM",1,2),t("IfFeederLoaded",0,2),t("IfPaperDetectable",0,2),t("IfUIControllable",0,2),t("ImageBitsPerPixel",0),t("ImageCaptureDriverType",1,1),t("ImageLayoutDocumentNumber",0),t("ImageLayoutFrameBottom",0),t("ImageLayoutFrameLeft",0),t("ImageLayoutFrameNumber",0),t("ImageLayoutFrameRight",0),t("ImageLayoutFrameTop",0),t("ImageLayoutPageNumber",0),t("ImageLength",0),t("ImagePixelType",0),t("ImageWidth",0),t("ImageXResolution",0),t("ImageYResolution",0),t("MagData",0),t("MagType",0),t("PageSize",1,1),t("PendingXfers",0),t("PixelFlavor",1,1),t("PixelType",1,1),t("Resolution",1,1),t("SourceCount",0),t("TransferMode",1,1),t("Unit",1,1),t("XferCount",1,1),t("Capability",1,1),t("CapCurrentIndex",1,1),t("CapCurrentValue",1,1),t("CapDefaultIndex",0),t("CapDefaultValue",0),t("CapDescription",1),t("CapMaxValue",1,1),t("CapMinValue",1,1),t("CapNumItems",1,1),t("CapStepSize",1,1),t("CapType",1,1),t("CapValue",1,1),t("CapValueString",1),t("CapValueType",1,1),t("AllowMultiSelect",1,2),t("BackgroundColor",1,1),t("BackgroundFillColor",1,1),t("BlankImageCurrentStdDev",0),t("BlankImageMaxStdDev",1,1),t("BlankImageThreshold",1,1),t("CurrentImageIndexInBuffer",{set:function(e){return e!=n.getSWebTwain().CurrentImageIndexInBuffer&&(n.getSWebTwain().CurrentImageIndexInBuffer=e),_o.checkErrorString(n)}}),t("FitWindowType",1,1),t("HowManyImagesInBuffer",0),t("IfFitWindow",1,2),t("ImageMargin",1,1),t("MaxImagesInBuffer",1,1),t("MouseX",0),t("MouseY",0),t("SelectionImageBorderColor",1),t("Zoom",1,1),t("MouseShape",1,2),t("SelectedImagesIndices",{get:function(){for(var e=[],t=n.getSWebTwain().SelectedImagesCount,r=0;r<t;r++)e.push(n.getSWebTwain().GetSelectedImageIndex(r));return e}}),t("HTTPPostResponseString",0),t("AsyncMode",1,2),t("FTPPassword",1),t("FTPPort",{set:function(e){return""!==e?(e*=1,n.getSWebTwain().FTPPort=e,_o.checkErrorString(n)):Zn}}),t("FTPUserName",1),t("HTTPPort",{set:function(e){return""!==e?(e*=1,n.getSWebTwain().HTTPPort=e,_o.checkErrorString(n)):(e=Cn.detect.ssl?443:80,n.getSWebTwain().HTTPPort=e,_o.checkErrorString(n))}}),t("HTTPPassword",1),t("HTTPUserName",1),t("IfPASVMode",1,2),t("IfShowProgressBar",1,2),t("ProxyServer",1),t("IfShowFileDialog",1,2),t("IfTiffMultiPage",1,2),t("PDFAuthor",1),t("PDFCompressionType",1,1),t("PDFCreationDate",1),t("PDFCreator",1),t("PDFKeywords",1),t("PDFModifiedDate",1),t("PDFProducer",1),t("PDFSubject",1),t("PDFTitle",1),t("PDFVersion",1),t("TIFFCompressionType",1,1),t("JPEGQuality",{set:function(e){return(e*=1)>=100?e=100:e<0&&(e=0),n.getSWebTwain().JPEGQuality=e,_o.checkErrorString(n)}}),t("HttpContentTypeFieldValue",1),t("SelectionRectAspectRatio",1,1),t("IfAllowLocalCache",1,2),t("_AutoCropMethod",1,2),t("BrokerProcessType",1,1),t("BorderStyle",1,1),t("IfShowPrintUI",1,2),t("VScrollBar",1,2),t("EnableInteractiveZoom",1,2),t("ImageEditorIfEnableEnumerator",1,2),t("ImageEditorIfReadonly",1,2),t("ImageEditorIfModal",1,2),t("ImageEditorWindowTitle",1),t("IfSSL",1,2),t("AllowPluginAuthentication",1,2),t("HttpFieldNameOfUploadedImage",1),t("MaxInternetTransferThreads",1,1),t("MaxUploadImageSize",1,1),t("IfOpenImageWithGDIPlus",1,2),t("BufferMemoryLimit",1,1),t("Width",{get:function(){return n.getSWebTwain().style.width},set:function(e){return n._ChangeWidth(e),_o.checkErrorString(n)}}),t("Height",{get:function(){return n.getSWebTwain().style.height},set:function(e){return n._ChangeHeight(e),_o.checkErrorString(n)}}),t("IfThrowException",1,2),t("IfAutoScroll",1,2),t("ShowPageNumber",{get:function(){return Zn},set:function(e){return Zn}}),t("UseLocalService",{get:function(){return!0}})},Cn.attachMethod=function(e){var t=e,r=function(e){return qi.checkProductKey(t,{Core:$n})?$n:(Cn.isFunction(e)&&e(t.ErrorCode,t.ErrorString),Zn)},i=function(e,n){return qi.checkPDFProductKeyWhenNeeds(t,e)?$n:(Cn.isFunction(n)&&n(t.ErrorCode,t.ErrorString),Zn)},o=function(e,n){return 0!=e.HowManyImagesInBuffer||(function(e){Wt(e,-1035,"There is no image.")}(e),Cn.isFunction(n)&&n(e.ErrorCode,e.ErrorString),!1)},a=function(e,n,t){return!!o(e,t)&&(!(isNaN(n)||!Cn.isNumber(n)||n<0||n>=e.HowManyImagesInBuffer)||(Ft(e),Cn.isFunction(t)&&t(e.ErrorCode,e.ErrorString),!1))};e.UnregisterEvent=function(e,n){if(!Cn.isString(e))return Mt(t),!1;if("onwsmessage"===e.toLowerCase())return Mt(t),!1;if("OnPostAllTransfers"===e)return t.__OnPostAllTransfers=null,!0;if("OnBufferChanged"===e)return t.__OnBufferChanged=null,!0;if("OnBitmapChanged"===e)return t.__OnBitmapChanged=null,!0;t.getSWebTwain().UnregisterEvent(e,(function(){}));var r=["__",e].join("");return t[r]=null,_o.checkErrorString(t)},e.RegisterEvent=function(e,n){if(!Cn.isString(e))return Mt(t),!1;var r=e.toLowerCase();if("onwsmessage"===r)return Mt(t),!1;if(Cn.isFunction(n)){if("onpostalltransfers"===r)return t.__OnPostAllTransfers=n,!0;if("onbufferchanged"===r)return t.__OnBufferChanged=n,!0;if("onbitmapchanged"===r)return t.__OnBitmapChanged=n,!0;var i=["__",e].join("");return t[i]=n,t.getSWebTwain().RegisterEvent(e,n),_o.checkErrorString(t)}return!0},e.onEvent=function(e,n){return t.RegisterEvent(e,n)},e.on=function(e,n){return t.RegisterEvent(e,n)},e.CancelAllPendingTransfers=function(){return t.getSWebTwain().CancelAllPendingTransfers(),_o.checkErrorString(t)},e.CloseSource=function(){return t.getSWebTwain().CloseSource(),_o.checkErrorString(t)},e.CloseSourceManager=function(){return t.getSWebTwain().CloseSourceManager(),_o.checkErrorString(t)},e.DisableSource=function(){return t.getSWebTwain().DisableSource(),_o.checkErrorString(t)},e.FeedPage=function(){return t.getSWebTwain().FeedPage(),_o.checkErrorString(t)},e.GetDeviceType=function(){var e=t.getSWebTwain().GetDeviceType();return _o.setErrorString(t),e},e.GetSourceNameItems=function(e){var n=t.getSWebTwain().GetSourceNameItems(e);return _o.setErrorString(t),n},e.SourceNameItems=function(e){var n=t.getSWebTwain().GetSourceNameItems(e);return _o.setErrorString(t),n},e.GetSourceNames=function(){var n,r,i=[];for(n=t.getSWebTwain().SourceCount,r=0;r<n;r++){var o=e.GetSourceNameItems(r);i.push(o)}return i},e.GetSourceType=function(e){var n=t.getSWebTwain().GetSourceType(e);return _o.setErrorString(t),n},e.OpenSource=function(){return t.getSWebTwain().OpenSource(),_o.checkErrorString(t)},e.OpenSourceManager=function(){return t.getSWebTwain().OpenSourceManager(),_o.checkErrorString(t)},e.ResetImageLayout=function(){return t.getSWebTwain().ResetImageLayout(),_o.checkErrorString(t)},e.RewindPage=function(){return t.getSWebTwain().RewindPage(),_o.checkErrorString(t)},e.SelectSource=function(e,n){return Cn.isUndefined(e)?(t.getSWebTwain().SelectSource(),_o.checkErrorString(t)):(t.getSWebTwain().SelectSource(),_o.checkErrorString(t)?(An.isFunction(e)&&e(),!0):(An.isFunction(n)&&n(),!1))},e.SelectSourceByIndex=function(e){return t.getSWebTwain().SelectSourceByIndex(e),_o.checkErrorString(t)},e.CloseSourceAsync=function(){return _o.wrapperPromise(t,t.CloseSource())},e.CloseSourceManagerAsync=function(){return _o.wrapperPromise(t,t.CloseSourceManager())},e.GetSourceNamesAsync=function(){return _o.wrapperPromise(t,t.GetSourceNames())},e.GetSourceTypeAsync=function(e){return _o.wrapperPromise(t,t.GetSourceType(e))},e.OpenSourceAsync=function(){return _o.wrapperPromise(t,t.OpenSource())},e.OpenSourceManagerAsync=function(){return _o.wrapperPromise(t,t.OpenSourceManager())},e.SelectSourceAsync=function(e){return e&&0==(e&Qn.TWAINSCANNER)&&0==(e&Qn.WIATWAINSCANNER)?(Bt(t),Cn.Promise.reject({code:t._errorCode,message:t._errorString})):_o.wrapperPromise(t,t.SelectSource())},e.SelectSourceByIndexAsync=function(e){return _o.wrapperPromise(t,t.SelectSourceByIndex(e))},e.SetFileXferInfo=function(e,n){var r=_o.replaceLocalFilename(e);return t.getSWebTwain().SetFileXferInfo(r,n),_o.checkErrorString(t)},e.SetImageLayout=function(e,n,r,i){return t.getSWebTwain().SetImageLayout(e,n,r,i),_o.checkErrorString(t)},e.CapGet=function(){var e=t.getSWebTwain().CapGet();return _o.setErrorString(t),e},e.CapGetCurrent=function(){var e=t.getSWebTwain().CapGetCurrent();return _o.setErrorString(t),e},e.CapGetDefault=function(){var e=t.getSWebTwain().CapGetDefault();return _o.setErrorString(t),e},e.CapGetFrameBottom=function(e){var n=t.getSWebTwain().CapGetFrameBottom(e);return _o.setErrorString(t),n},e.CapGetFrameLeft=function(e){var n=t.getSWebTwain().CapGetFrameLeft(e);return _o.setErrorString(t),n},e.CapGetFrameRight=function(e){var n=t.getSWebTwain().CapGetFrameRight(e);return _o.setErrorString(t),n},e.CapGetFrameTop=function(e){var n=t.getSWebTwain().CapGetFrameTop(e);return _o.setErrorString(t),n},e.CapGetHelp=function(){var e=t.getSWebTwain().CapGetHelp();return _o.setErrorString(t),e},e.CapGetLabel=function(){var e=t.getSWebTwain().CapGetLabel();return _o.setErrorString(t),e},e.CapGetLabels=function(){var e=t.getSWebTwain().CapGetLabels();return _o.setErrorString(t),e},e.CapIfSupported=function(e){var n=t.getSWebTwain().CapIfSupported(e);return _o.setErrorString(t),n},e.CapReset=function(){return t.getSWebTwain().CapReset(),_o.checkErrorString(t)},e.CapSet=function(){return t.getSWebTwain().CapSet(),_o.checkErrorString(t)},e.CapSetFrame=function(e,n,r,i,o){return t.getSWebTwain().CapSetFrame(e,n,r,i,o),_o.checkErrorString(t)},e.GetCapItems=function(e){var n=t.getSWebTwain().GetCapItems(e);return _o.setErrorString(t),n},e.GetCapItemsString=function(e){var n=t.getSWebTwain().GetCapItemsString(e);return _o.setErrorString(t),n},e.SetCapItems=function(e,n){return t.getSWebTwain().SetCapItems(e,n),_o.checkErrorString(t)},e.SetCapItemsString=function(e,n){return t.getSWebTwain().SetCapItemsString(e,n),_o.checkErrorString(t)},e.AddText=function(e,n,r,i,o,a,s,u){var c=parseInt(e);return isNaN(c)||c<0||c>=t.HowManyImagesInBuffer?(Ft(t),!1):(t.getSWebTwain().AddText(c,n,r,i,o,a,s,u),_o.checkErrorString(t))},e.CreateTextFont=function(e,n,r,i,o,a,s,u,c,l,f,d,T,h){return t.getSWebTwain().CreateTextFont(e,n,r,i,o,a,s,u,c,l,f,d,T,h),_o.checkErrorString(t)},e.CopyToClipboard=function(e){var n=parseInt(e);return isNaN(n)||n<0||n>=t.HowManyImagesInBuffer?(Ft(t),!1):(t.getSWebTwain().CopyToClipboard(n),_o.checkErrorString(t))},e.Erase=function(e,n,r,i,o,a,s){var u,c=parseInt(e);return isNaN(c)||c<0||c>=t.HowManyImagesInBuffer?(Ft(t),Cn.isFunction(s)&&s(t.ErrorCode,t.ErrorString),!1):(u=t.getSWebTwain().Erase(c,n,r,i,o),_o.wrapperRet(t,u,a,s))},e.GetImageBitDepth=function(e){var n=parseInt(e);if(isNaN(n)||n<0||n>=t.HowManyImagesInBuffer)return Ft(t),!1;var r=t.getSWebTwain().GetImageBitDepth(n);return _o.setErrorString(t),r},e.GetImageWidth=function(e){var n=parseInt(e);if(isNaN(n)||n<0||n>=t.HowManyImagesInBuffer)return Ft(t),!1;var r=t.getSWebTwain().GetImageWidth(n);return _o.setErrorString(t),r},e.GetImageHeight=function(e){var n=parseInt(e);if(isNaN(n)||n<0||n>=t.HowManyImagesInBuffer)return Ft(t),!1;var r=t.getSWebTwain().GetImageHeight(n);return _o.setErrorString(t),r},e.GetImageSize=function(e,n,r){var i=parseInt(e);if(isNaN(i)||i<0||i>=t.HowManyImagesInBuffer)return Ft(t),!1;var o=t.getSWebTwain().GetImageSize(i,n,r);return _o.setErrorString(t),o},e.GetImageSizeWithSpecifiedType=function(e,n){var r=parseInt(e);if(isNaN(r)||r<0||r>=t.HowManyImagesInBuffer)return Ft(t),!1;var i=t.getSWebTwain().GetImageSizeWithSpecifiedType(r,n);return _o.setErrorString(t),i},e.GetImageXResolution=function(e){var n=parseInt(e);if(isNaN(n)||n<0||n>=t.HowManyImagesInBuffer)return Ft(t),!1;var r=t.getSWebTwain().GetImageXResolution(n);return _o.setErrorString(t),r},e.GetImageYResolution=function(e){var n=parseInt(e);if(isNaN(n)||n<0||n>=t.HowManyImagesInBuffer)return Ft(t),!1;var r=t.getSWebTwain().GetImageYResolution(n);return _o.setErrorString(t),r},e.CopyToClipboardAsync=function(e){return _o.wrapperPromise(t,t.CopyToClipboard(e))},e.EraseAsync=function(e,n,r,i,o){return _o.wrapperPromise(t,t.Erase(e,n,r,i,o))},e.GetImageBitDepthAsync=function(e){return _o.wrapperPromise(t,t.GetImageBitDepth(e))},e.GetImageWidthAsync=function(e){return _o.wrapperPromise(t,t.GetImageWidth(e))},e.GetImageHeightAsync=function(e){return _o.wrapperPromise(t,t.GetImageHeight(e))},e.GetImageSizeAsync=function(e,n,r){return _o.wrapperPromise(t,t.GetImageSize(e,n,r))},e.GetImageSizeWithSpecifiedTypeAsync=function(e,n){return _o.wrapperPromise(t,t.GetImageSizeWithSpecifiedType(e,n))},e.GetImageXResolutionAsync=function(e){return _o.wrapperPromise(t,t.GetImageXResolution(e))},e.GetImageYResolutionAsync=function(e){return _o.wrapperPromise(t,t.GetImageYResolution(e))},e.SelectAllImages=function(){var e,n=t.getSWebTwain().HowManyImagesInBuffer,r=[];for(t.getSWebTwain().SelectedImagesCount=n,e=0;e<n;e++)t.getSWebTwain().SetSelectedImageIndex(e,e),r.push(e);return _o.checkErrorString(t),r},e.SelectImages=function(e){var n=e.length;t.getSWebTwain().SelectedImagesCount=n;for(var r=0;r<n;r++)t.getSWebTwain().SetSelectedImageIndex(r,e[r]);return _o.checkErrorString(t)},e.GetSelectedImagesSize=function(e){var n=t.getSWebTwain().GetSelectedImagesSize(e);return _o.setErrorString(t),n},e.GetSkewAngle=function(e,n,r){var i,o=parseInt(e);return isNaN(o)||o<0||o>=t.HowManyImagesInBuffer?(Ft(t),Cn.isFunction(r)&&r(t.ErrorCode,t.ErrorString),!1):(i=t.getSWebTwain().GetSkewAngle(o),_o.wrapperRet(t,i,n,r,!1,!0))},e.GetSkewAngleEx=function(e,n,r,i,o,a,s){var u,c=parseInt(e);return isNaN(c)||c<0||c>=t.HowManyImagesInBuffer?(Ft(t),Cn.isFunction(s)&&s(t.ErrorCode,t.ErrorString),!1):(u=t.getSWebTwain().GetSkewAngleEx(c,n,r,i,o),_o.wrapperRet(t,u,a,s))},e.IsBlankImage=function(e){var n=parseInt(e);if(isNaN(n)||n<0||n>=t.HowManyImagesInBuffer)return Ft(t),!1;var r=t.getSWebTwain().IsBlankImage(n);return _o.setErrorString(t),r},e.IsBlankImageEx=function(e,n,r,i,o,a){var s=parseInt(e);if(isNaN(s)||s<0||s>=t.HowManyImagesInBuffer)return Ft(t),!1;var u=t.getSWebTwain().IsBlankImageEx(s,n,r,i,o,a);return _o.setErrorString(t),u},e.Mirror=function(e,n,r){var i,o=parseInt(e);return isNaN(o)||o<0||o>=t.HowManyImagesInBuffer?(Ft(t),Cn.isFunction(r)&&r(t.ErrorCode,t.ErrorString),!1):(i=t.getSWebTwain().Mirror(o),_o.wrapperRet(t,i,n,r))},e.OverlayRectangle=function(e,n,r,i,o,a,s){return t.getSWebTwain().OverlayRectangle(e,n,r,i,o,a,s),_o.checkErrorString(t)},e.RemoveAllImages=function(){var e;return t.getSWebTwain().RemoveAllImages(),(e=_o.checkErrorString(t))&&t.__innerRefreshImage(),An.isString(t.Width)?-1==t.Width.indexOf("%")&&(t.Width=parseInt(t.Width)+2):An.isNumber(t.Width)&&(t.Width=t.Width+2),e},e.RemoveAllSelectedImages=function(){var e;return t.getSWebTwain().RemoveAllSelectedImages(),(e=_o.checkErrorString(t))&&t.__innerRefreshImage(),e},e.RemoveImage=function(e){var n=parseInt(e);return isNaN(n)||n<0||n>=t.HowManyImagesInBuffer?(Ft(t),!1):(t.getSWebTwain().RemoveImage(n),_o.checkErrorString(t))},e.MirrorAsync=function(e){return _o.wrapperPromise(t,t.Mirror(e))},e.RemoveAllImagesAsync=function(){return _o.wrapperPromise(t,t.RemoveAllImages())},e.RemoveAllSelectedImagesAsync=function(){return _o.wrapperPromise(t,t.RemoveAllSelectedImages())},e.RemoveImageAsync=function(e){return _o.wrapperPromise(t,t.RemoveImage(e))},e.Rotate=function(e,n,r,i,o){var a,s=parseInt(e);return isNaN(s)||s<0||s>=t.HowManyImagesInBuffer?(Ft(t),Cn.isFunction(o)&&o(t.ErrorCode,t.ErrorString),!1):(a=t.getSWebTwain().Rotate(s,n,r),_o.wrapperRet(t,a,i,o))},e.RotateEx=function(e,n,r,i,o,a){var s,u=parseInt(e);return isNaN(u)||u<0||u>=t.HowManyImagesInBuffer?(Ft(t),Cn.isFunction(a)&&a(t.ErrorCode,t.ErrorString),!1):(s=t.getSWebTwain().RotateEx(u,n,r,i),_o.wrapperRet(t,s,o,a))},e.RotateLeft=function(e,n,r){var i,o=parseInt(e);return isNaN(o)||o<0||o>=t.HowManyImagesInBuffer?(Ft(t),Cn.isFunction(r)&&r(t.ErrorCode,t.ErrorString),!1):(i=t.getSWebTwain().RotateLeft(o),_o.wrapperRet(t,i,n,r))},e.RotateRight=function(e,n,r){var i,o=parseInt(e);return isNaN(o)||o<0||o>=t.HowManyImagesInBuffer?(Ft(t),Cn.isFunction(r)&&r(t.ErrorCode,t.ErrorString),!1):(i=t.getSWebTwain().RotateRight(o),_o.wrapperRet(t,i,n,r))},e.ChangeImageSize=function(e,n,r,i,o,a){var s,u=parseInt(e);return isNaN(u)||u<0||u>=t.HowManyImagesInBuffer?(Ft(t),Cn.isFunction(a)&&a(t.ErrorCode,t.ErrorString),!1):n<=0||r<=0?(Wt(t,-2307,"The width or height you entered is invalid."),Cn.isFunction(a)&&a(t.ErrorCode,t.ErrorString),!1):(s=t.getSWebTwain().ChangeImageSize(u,n,r,i),_o.wrapperRet(t,s,o,a))},e.Flip=function(e,n,r){var i,o=parseInt(e);return isNaN(o)||o<0||o>=t.HowManyImagesInBuffer?(Ft(t),Cn.isFunction(r)&&r(t.ErrorCode,t.ErrorString),!1):(i=t.getSWebTwain().Flip(o),_o.wrapperRet(t,i,n,r))},e.Crop=function(e,n,r,i,o,a,s){var u,c=parseInt(e);return isNaN(c)||c<0||c>=t.HowManyImagesInBuffer?(Ft(t),Cn.isFunction(s)&&s(t.ErrorCode,t.ErrorString),!1):(u=t.getSWebTwain().Crop(c,n,r,i,o),_o.wrapperRet(t,u,a,s))},e.CropToClipboard=function(e,n,r,i,o){var a=parseInt(e);return isNaN(a)||a<0||a>=t.HowManyImagesInBuffer?(Ft(t),!1):(t.getSWebTwain().CropToClipboard(a,n,r,i,o),_o.checkErrorString(t))},e.CutFrameToClipboard=function(e,n,r,i,o){var a=parseInt(e);return isNaN(a)||a<0||a>=t.HowManyImagesInBuffer?(Ft(t),!1):(t.getSWebTwain().CutFrameToClipboard(a,n,r,i,o),_o.checkErrorString(t))},e.CutToClipboard=function(e){var n=parseInt(e);return isNaN(n)||n<0||n>=t.HowManyImagesInBuffer?(Ft(t),!1):(t.getSWebTwain().CutToClipboard(n),_o.checkErrorString(t))},e.RotateAsync=function(e,n,r){return _o.wrapperPromise(t,t.Rotate(e,n,r))},e.RotateExAsync=function(e,n,r,i){return _o.wrapperPromise(t,t.RotateEx(e,n,r,i))},e.RotateLeftAsync=function(e){return _o.wrapperPromise(t,t.RotateLeft(e))},e.RotateRightAsync=function(e){return _o.wrapperPromise(t,t.RotateRight(e))},e.ChangeImageSizeAsync=function(e,n,r,i){return _o.wrapperPromise(t,t.ChangeImageSize(e,n,r,i))},e.FlipAsync=function(e){return _o.wrapperPromise(t,t.Flip(e))},e.CropAsync=function(e,n,r,i,o){return _o.wrapperPromise(t,t.Crop(e,n,r,i,o))},e.CropToClipboardAsync=function(e,n,r,i,o){return _o.wrapperPromise(t,t.CropToClipboard(e,n,r,i,o))},e.CutFrameToClipboardAsync=function(e,n,r,i,o){return _o.wrapperPromise(t,t.CutFrameToClipboard(e,n,r,i,o))},e.CutToClipboardAsync=function(e){return _o.wrapperPromise(t,t.CutToClipboard(e))},e.InvertAsync=function(e){return _o.wrapperPromise(t,t.Invert(e))},e.Invert=function(e){var n=parseInt(e);return isNaN(n)||n<0||n>=t.HowManyImagesInBuffer?(Ft(t),!1):(Ut(t),!1)},e.SetDPI=function(e,n,r,i,o,a,s){var u,c=parseInt(e);return isNaN(c)||c<0||c>=t.HowManyImagesInBuffer?(Ft(t),Cn.isFunction(s)&&s(t.ErrorCode,t.ErrorString),!1):(u=t.getSWebTwain().SetDPI(c,n,r,i,o),_o.wrapperRet(t,u,a,s))},e.SetViewMode=function(e,n){return t.getSWebTwain().SetViewMode(e,n),_o.checkErrorString(t)},e.GetViewModeH=function(){var e=t.getSWebTwain().GetViewModeH();return _o.setErrorString(t),e},e.GetViewModeV=function(){var e=t.getSWebTwain().GetViewModeV();return _o.setErrorString(t),e},e.MoveImage=function(e,n){var r=parseInt(e),i=parseInt(n);return isNaN(r)||r<0||r>=t.HowManyImagesInBuffer||isNaN(i)||i<0||i>=t.HowManyImagesInBuffer?(Ft(t),!1):(t.getSWebTwain().MoveImage(r,i),_o.checkErrorString(t))},e.SwitchImage=function(e,n){var r=parseInt(e),i=parseInt(n);return isNaN(r)||r<0||r>=t.HowManyImagesInBuffer||isNaN(i)||i<0||i>=t.HowManyImagesInBuffer?(Ft(t),!1):(t.getSWebTwain().SwitchImage(r,i),_o.checkErrorString(t))},e.Print=function(){return t.getSWebTwain().Print(),_o.checkErrorString(t)},e.checkErrorString=function(){return _o.isReturnSuccess(t)},e.FileExists=function(e){var n=_o.replaceLocalFilename(e),r=t.getSWebTwain().FileExists(n);return _o.setErrorString(t),r},e.SaveAllAsMultiPageTIFF=function(e,n,r){if(!o(t,r))return!1;var i,a=_o.replaceLocalFilename(e);return i=t.getSWebTwain().SaveAllAsMultiPageTIFF(a),_o.wrapperRet(t,i,n,r)},e.SaveAllAsPDF=function(e,n,r){if(!o(t,r))return!1;var i,a=_o.replaceLocalFilename(e);return i=t.getSWebTwain().SaveAllAsPDF(a),_o.wrapperRet(t,i,n,r)},e.SaveAsBMP=function(e,n,r,i){if(!a(t,n,i))return!1;var o,s=_o.replaceLocalFilename(e);return o=t.getSWebTwain().SaveAsBMP(s,n),_o.wrapperRet(t,o,r,i)},e.SaveAsJPEG=function(e,n,r,i){if(!a(t,n,i))return!1;var o,s=_o.replaceLocalFilename(e);return o=t.getSWebTwain().SaveAsJPEG(s,n),_o.wrapperRet(t,o,r,i)},e.SaveAsPDF=function(e,n,r,i){if(!a(t,n,i))return!1;var o,s=_o.replaceLocalFilename(e);return o=t.getSWebTwain().SaveAsPDF(s,n),_o.wrapperRet(t,o,r,i)},e.SaveAsPNG=function(e,n,r,i){if(!a(t,n,i))return!1;var o,s=_o.replaceLocalFilename(e);return o=t.getSWebTwain().SaveAsPNG(s,n),_o.wrapperRet(t,o,r,i)},e.SaveAsTIFF=function(e,n,r,i){if(!a(t,n,i))return!1;var o,s=_o.replaceLocalFilename(e);return o=t.getSWebTwain().SaveAsTIFF(s,n),_o.wrapperRet(t,o,r,i)},e.SaveSelectedImagesAsMultiPagePDF=function(e,n,r){var i,o=_o.replaceLocalFilename(e);return i=t.getSWebTwain().SaveSelectedImagesAsMultiPagePDF(o),_o.wrapperRet(t,i,n,r)},e.SaveSelectedImagesAsMultiPageTIFF=function(e,n,r){var i,o=_o.replaceLocalFilename(e);return i=t.getSWebTwain().SaveSelectedImagesAsMultiPageTIFF(o),_o.wrapperRet(t,i,n,r)},e.SaveSelectedImagesToBase64Binary=function(e,n){var r=t.getSWebTwain().SaveSelectedImagesToBase64Binary();return _o.wrapperRet(t,r,e,n)},e.ShowFileDialog=function(e,n,r,i,o,a,s,u){return t.getSWebTwain().ShowFileDialog(e,n,r,i,o,a,s,u),_o.checkErrorString(t)},e.FTPDownload=function(e,n,i,o){if(!r(o))return!1;var a=t.getSWebTwain().FTPDownload(e,n);return a&&Ct()&&Pn.DWT.lcvrf(t),_o.wrapperRet(t,a,i,o)},e.FTPDownloadDirectly=function(e,n,i,o,a){if(!r(a))return!1;var s=t.getSWebTwain().FTPDownloadDirectly(e,n,i);return _o.wrapperRet(t,s,o,a)},e.FTPDownloadEx=function(e,n,o,a,s){if(!r(s))return!1;if(o!=Pn.DWT.EnumDWT_ImageType.IT_BMP&&o!=Pn.DWT.EnumDWT_ImageType.IT_JPG&&o!=Pn.DWT.EnumDWT_ImageType.IT_TIF&&o!=Pn.DWT.EnumDWT_ImageType.IT_PNG&&o!=Pn.DWT.EnumDWT_ImageType.IT_PDF&&o!=Pn.DWT.EnumDWT_ImageType.IT_J2K&&(o=-1),!i(o,s))return Zn;var u=t.getSWebTwain().FTPDownloadEx(e,n,o);return _o.wrapperRet(t,u,a,s)},e.FTPUpload=function(e,n,i,o,a){if(!r(a))return!1;var s=t.getSWebTwain().FTPUpload(e,n,i);return _o.wrapperRet(t,s,o,a)},e.FTPUploadDirectly=function(e,n,i,o,a){if(!r(a))return!1;var s=t.getSWebTwain().FTPUploadDirectly(e,n,i);return _o.wrapperRet(t,s,o,a)},e.FTPUploadEx=function(e,n,i,o,a,s){if(!r(s))return!1;var u=t.getSWebTwain().FTPUploadEx(e,n,i,o);return _o.wrapperRet(t,u,a,s)},e.FTPUploadAllAsMultiPageTIFF=function(e,n,i,o){if(!r(o))return!1;var a=t.getSWebTwain().FTPUploadAllAsMultiPageTIFF(e,n);return _o.wrapperRet(t,a,i,o)},e.FTPUploadAllAsPDF=function(e,n,i,o){if(!r(o))return!1;var a=t.getSWebTwain().FTPUploadAllAsPDF(e,n);return _o.wrapperRet(t,a,i,o)},e.FTPUploadAsMultiPagePDF=function(e,n,r,i){var o=t.getSWebTwain().FTPUploadAsMultiPagePDF(e,n);return _o.wrapperRet(t,o,r,i)},e.FTPUploadAsMultiPageTIFF=function(e,n,r,i){var o=t.getSWebTwain().FTPUploadAsMultiPageTIFF(e,n);return _o.wrapperRet(t,o,r,i)},e.HTTPDownloadDirectly=function(e,n,i,o,a){if(!r(a))return!1;var s=t.getSWebTwain().HTTPDownloadDirectly(e,n,i);return _o.wrapperRet(t,s,o,a)},e.HTTPDownload=function(e,n,r,i){var o=_o.getImageType(n);return t.HTTPDownloadEx(e,n,o,r,i)},e.HTTPDownloadEx=function(e,n,o,a,s){if(!r(s))return Zn;if(o!=Pn.DWT.EnumDWT_ImageType.IT_BMP&&o!=Pn.DWT.EnumDWT_ImageType.IT_JPG&&o!=Pn.DWT.EnumDWT_ImageType.IT_TIF&&o!=Pn.DWT.EnumDWT_ImageType.IT_PNG&&o!=Pn.DWT.EnumDWT_ImageType.IT_PDF&&o!=Pn.DWT.EnumDWT_ImageType.IT_J2K&&(o=-1),!i(o,s))return Zn;var u=t.getSWebTwain().HTTPDownloadEx(e,n,o);return u&&Ct()&&Pn.DWT.lcvrf(t),_o.wrapperRet(t,u,a,s)},e.HTTPDownloadThroughGet=e.HTTPDownloadEx,e.HTTPUploadThroughPostDirectly=function(e,n,i,o,a,s){if(!r(s))return!1;var u=t.getSWebTwain().HTTPUploadThroughPostDirectly(e,n,i,o);return _o.wrapperRet(t,u,a,s,!0)},e.HTTPUploadThroughPost=function(e,n,r,i,o,a){if(!Cn.isNumber(n)||isNaN(n)||n<-2)return Ft(t),Cn.isFunction(a)&&a(t.ErrorCode,t.ErrorString),!1;var s=t.getSWebTwain().HTTPUploadThroughPost(e,n,r,i);return _o.wrapperRet(t,s,o,a,!0)},e.HTTPUploadThroughPostEx=function(e,n,r,i,o,a,s){if(!Cn.isNumber(n)||isNaN(n)||n<-2)return Ft(t),Cn.isFunction(s)&&s(t.ErrorCode,t.ErrorString),!1;var u=t.getSWebTwain().HTTPUploadThroughPostEx(e,n,r,i,o);return _o.wrapperRet(t,u,a,s,!0)},e.ClearAllHTTPFormField=function(){return t.getSWebTwain().ClearAllHTTPFormField(),_o.checkErrorString(t)},e.SetHTTPFormField=function(e,n){return t.getSWebTwain().SetHTTPFormField(e,n),_o.checkErrorString(t)},e.HTTPUploadAllThroughPostAsMultiPageTIFF=function(e,n,r,i,o){var a;return a=t.getSWebTwain().HTTPUploadAllThroughPostAsMultiPageTIFF(e,n,r),_o.wrapperRet(t,a,i,o,!0)},e.HTTPUploadThroughPostAsMultiPageTIFF=function(e,n,r,i,o){var a;return a=t.getSWebTwain().HTTPUploadThroughPostAsMultiPageTIFF(e,n,r),_o.wrapperRet(t,a,i,o,!0)},e.HTTPUploadAllThroughPostAsPDF=function(e,n,r,i,o){var a;return a=t.getSWebTwain().HTTPUploadAllThroughPostAsPDF(e,n,r),_o.wrapperRet(t,a,i,o,!0)},e.HTTPUploadThroughPostAsMultiPagePDF=function(e,n,r,i,o){var a;return a=t.getSWebTwain().HTTPUploadThroughPostAsMultiPagePDF(e,n,r),_o.wrapperRet(t,a,i,o,!0)},e.HTTPUploadThroughPutDirectly=function(e,n,r,i,o){var a;return a=t.getSWebTwain().HTTPUploadThroughPutDirectly(e,n,r),_o.wrapperRet(t,a,i,o)},e.HTTPUploadThroughPut=function(e,n,r,i,o){var a=_o.getImageType(r);return t.HTTPUploadThroughPutEx(e,n,r,a,i,o)},e.HTTPUploadThroughPutEx=function(e,n,r,i,o,a){var s;return s=t.getSWebTwain().HTTPUploadThroughPutEx(e,n,r,i),_o.wrapperRet(t,s,o,a)},e.HTTPUploadAllThroughPutAsMultiPageTIFF=function(e,n,r,i){return t.HTTPUploadThroughPutEx(e,-1,n,2,r,i)},e.HTTPUploadThroughPutAsMultiPageTIFF=function(e,n,r,i){return t.HTTPUploadThroughPutEx(e,-2,n,2,r,i)},e.HTTPUploadAllThroughPutAsPDF=function(e,n,r,i){return t.HTTPUploadThroughPutEx(e,-1,n,4,r,i)},e.HTTPUploadThroughPutAsMultiPagePDF=function(e,n,r,i){return t.HTTPUploadThroughPutEx(e,-2,n,4,r,i)},e.ShowImageEditor=function(){return t.getSWebTwain().ShowImageEditor(),_o.checkErrorString(t)},e.SetCookie=function(e){return t.getSWebTwain().SetCookie(e),_o.checkErrorString(t)},e.LoadImageFromBase64Binary=function(e,n,o,a){if(!r())return Zn;if(n!=Pn.DWT.EnumDWT_ImageType.IT_BMP&&n!=Pn.DWT.EnumDWT_ImageType.IT_JPG&&n!=Pn.DWT.EnumDWT_ImageType.IT_TIF&&n!=Pn.DWT.EnumDWT_ImageType.IT_PNG&&n!=Pn.DWT.EnumDWT_ImageType.IT_PDF&&n!=Pn.DWT.EnumDWT_ImageType.IT_J2K&&(n=-1),!i(n))return Cn.isFunction(a)&&a(t._errorCode,t._errorString),Zn;var s=t.getSWebTwain().LoadImageFromBase64Binary(e,n);return _o.setErrorString(t),s?Cn.isFunction(o)&&o():Cn.isFunction(a)&&a(t._errorCode,t._errorString),s},e.SaveSelectedImagesToBytes=function(e,n){var r=t.getSWebTwain().SaveSelectedImagesToBytes(e,n);return _o.setErrorString(t),r},e.LoadImageFromBytes=function(e,n,o){if(!r())return Zn;if(o!=Pn.DWT.EnumDWT_ImageType.IT_BMP&&o!=Pn.DWT.EnumDWT_ImageType.IT_JPG&&o!=Pn.DWT.EnumDWT_ImageType.IT_TIF&&o!=Pn.DWT.EnumDWT_ImageType.IT_PNG&&o!=Pn.DWT.EnumDWT_ImageType.IT_PDF&&o!=Pn.DWT.EnumDWT_ImageType.IT_J2K&&(o=-1),!i(o))return Zn;var a=t.getSWebTwain().LoadImageFromBytes(e,n,o);return _o.setErrorString(t),a},e.SetImageWidth=function(e,n,r,i){var o,a=parseInt(e);return isNaN(a)||a<0||a>=t.HowManyImagesInBuffer?(Ft(t),Cn.isFunction(i)&&i(t.ErrorCode,t.ErrorString),!1):(o=t.getSWebTwain().SetImageWidth(a,n),_o.wrapperRet(t,o,r,i))},e.HTTPDownloadThroughPost=function(e,n,o,a,s){if(!r(s))return!1;if(o!=Pn.DWT.EnumDWT_ImageType.IT_BMP&&o!=Pn.DWT.EnumDWT_ImageType.IT_JPG&&o!=Pn.DWT.EnumDWT_ImageType.IT_TIF&&o!=Pn.DWT.EnumDWT_ImageType.IT_PNG&&o!=Pn.DWT.EnumDWT_ImageType.IT_PDF&&o!=Pn.DWT.EnumDWT_ImageType.IT_J2K&&(o=-1),!i(o,s))return Zn;var u=t.getSWebTwain().HTTPDownloadThroughPost(e,n,o);return _o.wrapperRet(t,u,a,s)},e.SetCustomDSDataEx=function(e){return t.getSWebTwain().SetCustomDSDataEx(e),_o.checkErrorString(t)},e.SetCustomDSData=function(e){return t.getSWebTwain().SetCustomDSData(e),_o.checkErrorString(t)},e.GetCustomDSDataEx=function(){var e=t.getSWebTwain().GetCustomDSDataEx();return _o.setErrorString(t),e},e.GetCustomDSData=function(e){var n=t.getSWebTwain().GetCustomDSData(e);return _o.setErrorString(t),n},e.ChangeBitDepth=function(e,n,r){var i=parseInt(e);return isNaN(i)||i<0||i>=t.HowManyImagesInBuffer?(Ft(t),!1):(t.getSWebTwain().ChangeBitDepth(i,n,r),_o.checkErrorString(t))},e.ConvertToGrayScale=function(e,n,r){var i,o=parseInt(e);return isNaN(o)||o<0||o>=t.HowManyImagesInBuffer?(Ft(t),Cn.isFunction(r)&&r(t.ErrorCode,t.ErrorString),!1):(i=t.getSWebTwain().ConvertToGrayScale(e),_o.wrapperRet(t,i,n,r))},e.ShowImageEditorEx=function(e,n,r,i,o){return t.getSWebTwain().ShowImageEditorEx(e,n,r,i,o),_o.checkErrorString(t)},e.ClearTiffCustomTag=function(){return t.getSWebTwain().ClearTiffCustomTag(),_o.checkErrorString(t)},e.SetTiffCustomTag=function(e,n,r){var i=1*e;return Cn.isUndef(e)||Cn.isUndef(n)?(Bt(t),!1):i<=0||i>2147483647?(Wt(t,-2378,"Invalid value for the tiff tag code."),!1):(t.getSWebTwain().SetTiffCustomTag(e,n,r),_o.checkErrorString(t))},e.IsBlankImageExpress=function(e){var n=parseInt(e);if(isNaN(n)||n<0||n>=t.HowManyImagesInBuffer)return Ft(t),!1;var r=t.getSWebTwain().IsBlankImageExpress(n);return _o.setErrorString(t),r},e._ChangeWidth=function(e){var n,r=document.getElementById(t._strDWTInnerContainerID);if(Cn.isString(e)&&e.length>0&&"%"===e.charAt(e.length-1)&&(n=e),!n){var i=parseInt(e);i&&i>2&&(n=i-2+"px")}return n&&(t._strWidth=n,t.getSWebTwain().style.width=n,r&&(r.style.width=n)),$n},e._ChangeHeight=function(e){var n,r=document.getElementById(t._strDWTInnerContainerID);if(Cn.isString(e)&&e.length>0&&"%"===e.charAt(e.length-1)&&(n=e),!n){var i=parseInt(e);i&&(n=i+"px")}return n&&(t._strHeight=n,t.getSWebTwain().style.height=n,r&&(r.style.height=n)),$n},e.SetSize=function(e,n){return this._ChangeWidth(e),this._ChangeHeight(n),$n},e.SetSelectedImageArea=function(e,n,r,i,o){return t.getSWebTwain().SetSelectedImageArea(e,n,r,i,o),_o.checkErrorString(t)},e.SetVideoRotateMode=function(e){return t.getSWebTwain().SetVideoRotateMode(e),_o.checkErrorString(t)},e.SetOpenSourceTimeout=function(e){return t.getSWebTwain().SetOpenSourceTimeout(e),_o.checkErrorString(t)},e.SetHTTPHeader=function(e,n){return!1},e.GetImageURL=function(e,n,t){return""},e.GetImagePartURL=function(e){var n=parseInt(e);if(isNaN(n)||n<0||n>=t.HowManyImagesInBuffer)return Ft(t),"";var r=t.getSWebTwain().GetDIB(n);return _o.setErrorString(t),r},e.GetLicenseInfo=function(e){try{var n,r=!1;if(Ct())r=!0,n=t.getSWebTwain().GetLicenseInfo();else if(Cn.isString(e))if(qi.isLicenseMixed(e,!1)){var i=Pn.DWT.licenseException;t._errorCode=i.code,t._errorString=i.message}else qi.isLongKey(e)?(t.getSWebTwain().ProductKey=e,n=t.getSWebTwain().GetLicenseInfo()):Ot(t);else Ot(t);if(n&&_o.checkErrorString(t)){var o=Cn.parse(n);if(o&&o.message)Ot(t),t._errorString=o.message,o=undefined;else if(r){if(o&&Cn.isArray(o.Detail)&&o.Detail.length>0){var a=o.Detail[0].ExpireDate;Pn.DWT.lsexp(Pn.DWT.EnumInstance.dwt_desktop,a,"")}o.LTS=!0}u=o,(s=t).__licenseInfo=u,function(e){e.__calic||(e.__calic=e.__licenseInfo)}(s)}else t.__licenseInfo=undefined}catch(c){t.__licenseInfo=undefined}var s,u;return Cn.Promise.resolve(t.__licenseInfo)},e.LoadDibFromClipboard=function(e,n){var r=t.getSWebTwain().LoadDibFromClipboard();return r&&Ct()&&Pn.DWT.lcvrf(t),_o.wrapperRet(t,r,e,n)},e.LoadImage=function(e,n,i){if(!r(i))return!1;var o,a=_o.replaceLocalFilename(e);return(o=t.getSWebTwain().LoadImage(a))&&Ct()&&Pn.DWT.lcvrf(t),_o.wrapperRet(t,o,n,i)},e.LoadImageEx=function(e,n,o,a){if(!r(a))return Zn;if(n!=Pn.DWT.EnumDWT_ImageType.IT_BMP&&n!=Pn.DWT.EnumDWT_ImageType.IT_JPG&&n!=Pn.DWT.EnumDWT_ImageType.IT_TIF&&n!=Pn.DWT.EnumDWT_ImageType.IT_PNG&&n!=Pn.DWT.EnumDWT_ImageType.IT_PDF&&n!=Pn.DWT.EnumDWT_ImageType.IT_J2K&&(n=-1),!i(n,a))return Zn;var s,u=_o.replaceLocalFilename(e),c=n;return c==Pn.DWT.EnumDWT_ImageType.IT_ALL&&(c=-1),(s=t.getSWebTwain().LoadImageEx(u,c))&&Ct()&&Pn.DWT.lcvrf(t),_o.wrapperRet(t,s,o,a)},e.EnableSource=function(e,n,r){return this.AcquireImage(e,n,r),_o.checkErrorString(t)},e.AcquireImage=function(e,n,i){var o,a,s,u=t.getSWebTwain();if(Cn.isUndefined(i)&&(Cn.isFunction(e)&&Cn.isFunction(n)||Cn.isFunction(e)&&Cn.isUndefined(n)||Cn.isFunction(e)&&null==n||null==e&&Cn.isFunction(n))?(o=null,Cn.isFunction(e)&&(a=e),Cn.isFunction(n)&&(s=function(){n(t._errorCode,t._errorString)})):(o=Cn.isUndefined(e)||null==e?{}:Cn.clone(e),Cn.isFunction(n)&&(a=function(){n(o)}),Cn.isFunction(i)&&(s=function(){i(o,t._errorCode,t._errorString)})),!r(s))return!1;var c,l=!1;o!==undefined&&null!==o&&(null!=(c=o.SelectSourceByIndex)&&void 0!==c&&(u.SelectSourceByIndex(c),u.CloseSource()),u.OpenSource(),null!=(c=o.IfShowUI)&&void 0!==c&&(u.IfShowUI=c),null!=(c=o.PixelType)&&void 0!==c&&(u.PixelType=c),null!=(c=o.Resolution)&&void 0!==c&&(u.Resolution=c),null!=(c=o.IfFeederEnabled)&&void 0!==c&&(u.IfFeederEnabled=c),null!=(c=o.IfDuplexEnabled)&&void 0!==c&&(u.IfDuplexEnabled=c),null!=(c=o.IfDisableSourceAfterAcquire)&&void 0!==c&&(u.IfDisableSourceAfterAcquire=c),null!=(c=o.IfCloseSourceAfterAcquire)&&void 0!==c&&(l=!!c));return t.getSWebTwain().RegisterEvent("OnPostTransferAsync",(function(e){var n;e&&Cn.isString(e)&&(n=Cn.parse(e)),Cn.isFunction(t.__OnPostTransferAsync)&&t.__OnPostTransferAsync(n)})),t.getSWebTwain().RegisterEvent("OnPostAllTransfers",(function(){_o.checkErrorString(t)?(Ct()&&Pn.DWT.lcvrf(t),Cn.isFunction(a)&&a()):Cn.isFunction(s)&&s(t._errorCode,t._errorString),Cn.isFunction(t.__OnPostAllTransfers)&&t.__OnPostAllTransfers(),l&&u.CloseSource()})),u.AcquireImage(),_o.checkErrorString(t)},e.AcquireImageAsync=function(){var e=n(l.mark((function r(e){var n;return l.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e?Cn.clone(e):{},r.abrupt("return",new Cn.Promise((function(e,r){t.AcquireImage(n,(function(){e(!0)}),(function(){r({code:t._errorCode,message:t._errorString})}))})));case 2:case"end":return r.stop()}}),r)})));return function(n){return e.apply(this,arguments)}}(),e.GetDevicesAsync=function(e,n,r){var i,o=null!=e?e:nt,a=null!=n&&n,s=null!=r&&r;return i=function(e,n){var t,r=[],i=n;if(An.isString(i)&&(i=An.parse(i)),An.isArray(i))for(t=0;t<i.length;t++){var o=at(i[t]);r.push(o)}for(t=0;t<r.length;t++){var a=r[t],s=a.deviceType;a.name&&(a.name=An.base64.decode(a.name)),s&et&&a.deviceInfo&&ot(a.deviceInfo),a.serviceInfo=null==e?void 0:e._dmService,it(a,null==e?void 0:e._dmService),An.isBoolean(a.isSystemDefaultPrinter)||(a.isSystemDefaultPrinter=!1)}return r}(null,i=t.getSWebTwain().GetDevices(o,a,s)),_o.wrapperPromise(t,i)},e.SelectDeviceAsync=function(e,n){var r,i=null!=n?n:st.SMF_NAME;if(t._resetErr(),!(e&&e instanceof rt))throw Bt(t),{code:t._errorCode,message:t._errorString};return r=t.getSWebTwain().SelectDevice(e.strDevice,i),_o.wrapperPromise(t,r)},e.GenerateURLForUploadData=function(e,n,r){var i=e;return i==Pn.DWT.EnumDWT_ImageType.IT_ALL&&(i=-1),!0,_o.wrapperRet(t,true,n,r)},e._innerFun=function(e,n,r){var i=t.getSWebTwain(),o=i[e];return"function"==typeof o?o.apply(i,n):o},e.ActiveUI=function(e,n){},e.startScan=function(){return new Cn.Promise((function(e,n){}))},e.IndexToImageID=function(e){return e},e.ImageIDToIndex=function(e){return e},e.first=function(){return t.HowManyImagesInBuffer>0&&(t.CurrentImageIndexInBuffer=0,t.__innerRefreshImage()),$n},e.previous=function(){var e;return t.HowManyImagesInBuffer>0&&(e=t.CurrentImageIndexInBuffer)>0&&(t.CurrentImageIndexInBuffer=e-1,t.__innerRefreshImage()),$n},e.next=function(){var e,n=t.HowManyImagesInBuffer;return n>0&&(e=t.CurrentImageIndexInBuffer)>=0&&e<n-1&&(t.CurrentImageIndexInBuffer=e+1,t.__innerRefreshImage()),$n},e.last=function(){var e=t.HowManyImagesInBuffer;return e>0&&(t.CurrentImageIndexInBuffer=e-1,t.__innerRefreshImage()),$n},e.isUsingActiveX=function(){return!0},e.show=function(){return e.ShowImageEditor()},e.SetLTSInfo=function(e,n){return t.getSWebTwain().SetLTSInfo(e,n)},e.EnableBuffer=function(e){return t.getSWebTwain().Encrypt(e,0)},e.GetBuffer=function(e){return t.getSWebTwain().GetBuffer(e)},e.GetUUID=function(){return t.getSWebTwain().GetUUID()},e.__OnDispatchThumbnailEvt=function(n,t,r){1==r?Cn.isFunction(e["__"+n+"_Thumbnail"])&&("OnMouseClick"==n||"OnMouseDoubleClick"==n||"OnMouseMove"==n||"OnMouseWheel"==n||"OnKeyDown"==n?e["__"+n+"_Thumbnail"]():e["__"+n+"_Thumbnail"](t)):Cn.isFunction(e["__"+n])&&e["__"+n](t)},e._OnImageAreaSelected=function(n,t,r,i,o,a){var s="OnImageAreaSelected";1==a?Cn.isFunction(e["__"+s+"_Thumbnail"])&&e["__"+s+"_Thumbnail"](n,t,r,i,o):Cn.isFunction(e["__"+s])&&e["__"+s](n,t,r,i,o)};var s=function(e,n){(Cn.isFunction(e["__"+n])||Cn.isFunction(e["__"+n+"_Thumbnail"]))&&("OnImageAreaSelected"==n?e.getSWebTwain().RegisterEvent(n,e._OnImageAreaSelected):e.getSWebTwain().RegisterEvent(n,(function(t,r){return e.__OnDispatchThumbnailEvt(n,t,r)})))};e.getSourceCount=function(e){return Ut(t),Cn.Promise.resolve(t.getSWebTwain().SourceCount)},e.GetSourceCountAsync=function(e){return Ut(t),Cn.Promise.resolve(t.getSWebTwain().SourceCount)},e._resetErr=function(){this._errorCode=0,this._errorString="";var e=Pn.DWT.licenseException;e.code=0,e.message=""},e._setConvertModeInner=function(e){if(!qi.checkProductKey(t,{Core:$n}))return!1;var n=1*e;return t._resetErr(),isNaN(n)||n!=bi.CM_RENDERALL&&n!=bi.CM_IMAGEONLY&&n!=bi.CM_AUTO&&n!=bi.CM_RENDERALLWITHANNOTATION?(Vt(t),!1):(t._pdfConvertMode=n,n==bi.CM_IMAGEONLY||qi.hasPDFRProductKey(t)?t._pdfOptions.convertMode=n:t._pdfOptions.convertMode=bi.CM_IMAGEONLY,t._pdfOptions.convertMode==bi.CM_IMAGEONLY||t._pdfOptions.convertMode==bi.CM_RENDERALL?t._pdfOptions.renderOptions.renderAnnotations=!1:t._pdfOptions.convertMode==bi.CM_RENDERALLWITHANNOTATION&&(t._pdfOptions.renderOptions.renderAnnotations=!0),!0)},e._setConvertMode=function(e){return!!t._setConvertModeInner(e)&&(t.getSWebTwain().SetPDFConvertMode(t._pdfOptions.convertMode),!(t._pdfOptions.convertMode==bi.CM_IMAGEONLY&&t._pdfConvertMode==bi.CM_RENDERALL||t._pdfOptions.convertMode==bi.CM_IMAGEONLY&&t._pdfConvertMode==bi.CM_RENDERALLWITHANNOTATION)||(Rt(t),!1))},e._axNotSupportAsync=function(e){var n=this;return Ut(n),Cn.Promise.reject({code:n.ErrorCode,message:n.ErrorString})},e.ConvertToBase64=function(e,n,t,r){var i,o,a=this,s=e;s=Cn.isArray(s)?s.join(","):-1;var u,c=a.getSWebTwain().SaveImagesToBase64(s,n,(function(e,n){i=e,o=n}));return _o.checkErrorString(a)&&(u=new ut(null,o,i,c)),_o.wrapperRet(a,[u,e,n],(function(e){t&&t(e[0],e[1],e[2])}),r,!1,!0)},e.ConvertToBlob=function(e,n,t,r){var i=this,o=e;o=Cn.isArray(o)?o.join(","):-1;var a=i.getSWebTwain().SaveImagesToBytes(o,n,(function(e,n){}));return _o.checkErrorString(i)&&(a=window.VBArray(a).toArray()),_o.wrapperRet(i,[a,e,n],(function(e){t&&t(e[0],e[1],e[2])}),r,!1,!0)},e._checkIndices=function(e){var n,t,r=this;if(!Cn.isArray(e))return Wt(r,-2358,"The type of the parameter indices must be an Array."),!1;if(0==e.length)return function(e){Wt(e,-2350,"The indices cannot be empty.")}(r),!1;if(Pn.DWT.ConnectWithSocket)return!0;for(n=r.HowManyImagesInBuffer,t=0;t<e.length;t++){var i=e[t];if(Cn.isUndefined(i)||null===i)return kt(r),!1;if(i=parseInt(i),isNaN(i))return Pt(r),!1;if(i<0||i>=n)return xt(r),!1}return!0},e.HTTPUpload=function(e,n,t,r,i,o,a){var s=this,u=n,c=o,l=a,f=arguments;if(!s._checkIndices(n))return l(s._errorCode,s._errorString),!1;if(t==Pn.DWT.EnumDWT_ImageType.IT_BMP||t==Pn.DWT.EnumDWT_ImageType.IT_JPG||t==Pn.DWT.EnumDWT_ImageType.IT_PNG){if(n.length>1)return Wt(s,-2351,"You cannot upload more than one image when the format is BMP, JPG or PNG"),l(s._errorCode,s._errorString),!1}else if(t!=Pn.DWT.EnumDWT_ImageType.IT_TIF&&t!=Pn.DWT.EnumDWT_ImageType.IT_PDF)return function(e){Wt(e,-2362,"The image type is not supported.")}(s),l(s._errorCode,s._errorString),!1;if(An.isUndefined(r)||r!=Pn.DWT.EnumDWT_UploadDataFormat.Binary&&r!=Pn.DWT.EnumDWT_UploadDataFormat.Base64)return function(e){Wt(e,-2363,"The data format is not supported.")}(s),l(n),!1;u=Cn.isArray(u)?u.join(","):-1;var d=s.IfSSL,T=s.HTTPPort,h=new Zt(e),g=h.scheme,p=h.port;Cn.isString(g)&&(g=g.toLowerCase()),"https"==g?(s.IfSSL=!0,s.HTTPPort=443):(s.IfSSL=!1,s.HTTPPort=80),p&&(s.HTTPPort=p);var _="RemoteFile";f.length>4&&(Cn.isFunction(i)?(c=i,f.length>5&&(l=o)):Cn.isString(i)&&(_=i));var m=s.getSWebTwain().HTTPUpload(h.hostname,u,h.path,_,t,r);return m=_o.wrapperRet(s,m,(function(e){Cn.isFunction(c)&&c(e,n,f)}),l,!0),s.IfSSL=d,s.HTTPPort=T,m},e._getConvertMode=function(){return this._pdfConvertMode},e.__innerRefreshImage=function(){var e,n=t.HowManyImagesInBuffer;n>0&&(e=t.CurrentImageIndexInBuffer,An.isFunction(t.__OnRefreshUI)&&t.__OnRefreshUI(e,n))},e._canConsume=function(){return e._blts},e.__OnBitmapChangedEx=function(n,r,i,o,a){var s=r,u=a;if(u>-1&&e._canConsume()&&(1==s||2==s)){var c=Pn.DWT.lgct(u);Cn.isFunction(t.__OnLtsverify)&&t.__OnLtsverify(c,1)}if(Cn.isFunction(t.__OnBitmapChanged)&&t.__OnBitmapChanged(n,r,i,o),Cn.isFunction(t.__OnBufferChanged)){var l=t.CurrentImageIndexInBuffer,f={action:1==s||2==s?"add":3==s?"remove":4==s?"modify":5==s?"shift":"",currentId:l,imageIds:[],selectedIds:[]};-1!=l&&f.selectedIds.push(l),t.__OnBufferChanged(f)}},e._attachEvents=function(){var e,n=t.getSWebTwain();(e=qn(String(t.VersionInfo))).length<=2||e[0]<9||9==e[0]&&e[1]<=2||(""!=t.__OnPostTransfer&&n.RegisterEvent("OnPostTransfer",t.__OnPostTransfer),""!=t.__OnPostAllTransfers&&n.RegisterEvent("OnPostAllTransfers",t.__OnPostAllTransfers),""!=t.__OnPostLoad&&n.RegisterEvent("OnPostLoad",t.__OnPostLoad),s(t,"OnMouseClick"),s(t,"OnImageAreaSelected"),s(t,"OnTopImageInTheViewChanged"),s(t,"OnImageAreaDeSelected"),s(t,"OnMouseDoubleClick"),s(t,"OnMouseRightClick"),s(t,"OnMouseMove"),""!=t.__OnGetFilePath&&n.RegisterEvent("OnGetFilePath",t.__OnGetFilePath),""!=t.__OnAfterOperate&&n.RegisterEvent("OnAfterOperate",t.__OnAfterOperate),""!=t.__OnBeforeOperate&&n.RegisterEvent("OnBeforeOperate",t.__OnBeforeOperate),""!=t.__OnOperateStatus&&n.RegisterEvent("OnOperateStatus",t.__OnOperateStatus),n.RegisterEvent("OnBitmapChangedEx",t.__OnBitmapChangedEx),""!=t.__OnPreAllTransfers&&n.RegisterEvent("OnPreAllTransfers",t.__OnPreAllTransfers),""!=t.__OnPreTransfer&&n.RegisterEvent("OnPreTransfer",t.__OnPreTransfer),""!=t.__OnSourceUIClose&&n.RegisterEvent("OnSourceUIClose",t.__OnSourceUIClose),""!=t.__OnTransferCancelled&&n.RegisterEvent("OnTransferCancelled",t.__OnTransferCancelled),""!=t.__OnTransferError&&n.RegisterEvent("OnTransferError",t.__OnTransferError),""!=t.__OnInternetTransferPercentage&&n.RegisterEvent("OnInternetTransferPercentage",t.__OnInternetTransferPercentage),""!=t.__OnInternetTransferPercentageEx&&n.RegisterEvent("OnInternetTransferPercentageEx",t.__OnInternetTransferPercentageEx),s(t,"OnMouseWheel"),s(t,"OnKeyDown"),s(t,"OnPaintDone"))},e._isMobileMode=function(){return!1}},Cn.noControl=function(e){if(Pn.DWT.IfUseEmbeddedDownloadNoticeForActiveX)!function(e,n,t,r){var i,o,a=!1;e&&(Cn.one(e).before(Cn.install._strNonInstallDIV),(i=Cn.get(Cn.install._divDWTNonInstallContainerID))&&(i.style.width=n,i.style.height=t),Cn.show(Cn.install._divDWTNonInstallContainerID),Cn.hide(e));""!=Cn.install._divDWTemessageContainer&&Cn.hide(Cn.install._divDWTemessageContainer);if(o=jn.getDSPath(),r){if(Cn.isFunction(Pn.OnWebTwainNeedUpgradeCallback)){var s={"default":o};Pn.OnWebTwainNeedUpgradeCallback(Cn.product.name,s,Cn.product.bHTML5Edition,Gn.enumWindow,z.bIE,z.bSafari,Cn.detect.ssl,ho.strIEVersion)}}else Cn.isFunction(Pn.OnWebTwainNotFoundOnWindowsCallback)&&Pn.OnWebTwainNotFoundOnWindowsCallback(Cn.product.name,o,Cn.product.bHTML5Edition,z.bIE,z.bSafari,Cn.detect.ssl,ho.strIEVersion,a)}(e._containerElement,e._strWidth,e._strHeight,!1);else{var n="";Cn.isFunction(Pn.OnWebTwainNotFoundOnWindowsCallback)&&(n=z.bIE||Cn.product.bHTML5Edition?jn.getDSPath():Cn.product.getMSIPath(),Pn.OnWebTwainNotFoundOnWindowsCallback(Pn.DWT.ProductName,n,Cn.product.bHTML5Edition,z.bIE,z.bSafari,Cn.detect.ssl,ho.strIEVersion,!1))}},function(e){e.CAP_NONE=0,e.CAP_XFERCOUNT=1,e.ICAP_COMPRESSION=256,e.ICAP_PIXELTYPE=257,e.ICAP_UNITS=258,e.ICAP_XFERMECH=259,e.CAP_AUTHOR=4096,e.CAP_CAPTION=4097,e.CAP_FEEDERENABLED=4098,e.CAP_FEEDERLOADED=4099,e.CAP_TIMEDATE=4100,e.CAP_SUPPORTEDCAPS=4101,e.CAP_EXTENDEDCAPS=4102,e.CAP_AUTOFEED=4103,e.CAP_CLEARPAGE=4104,e.CAP_FEEDPAGE=4105,e.CAP_REWINDPAGE=4106,e.CAP_INDICATORS=4107,e.CAP_SUPPORTEDCAPSEXT=4108,e.CAP_PAPERDETECTABLE=4109,e.CAP_UICONTROLLABLE=4110,e.CAP_DEVICEONLINE=4111,e.CAP_AUTOSCAN=4112,e.CAP_THUMBNAILSENABLED=4113,e.CAP_DUPLEX=4114,e.CAP_DUPLEXENABLED=4115,e.CAP_ENABLEDSUIONLY=4116,e.CAP_CUSTOMDSDATA=4117,e.CAP_ENDORSER=4118,e.CAP_ALARMS=4120,e.CAP_ALARMVOLUME=4121,e.CAP_AUTOMATICCAPTURE=4122,e.CAP_TIMEBEFOREFIRSTCAPTURE=4123,e.CAP_TIMEBETWEENCAPTURES=4124,e.CAP_CLEARBUFFERS=4125,e.CAP_MAXBATCHBUFFERS=4126,e.CAP_DEVICETIMEDATE=4127,e.CAP_POWERSUPPLY=4128,e.CAP_CAMERAPREVIEWUI=4129,e.CAP_SERIALNUMBER=4132,e.CAP_PRINTER=4134,e.CAP_PRINTERENABLED=4135,e.CAP_PRINTERINDEX=4136,e.CAP_PRINTERMODE=4137,e.CAP_PRINTERSTRING=4138,e.CAP_PRINTERSUFFIX=4139,e.CAP_LANGUAGE=4140,e.CAP_FEEDERALIGNMENT=4141,e.CAP_FEEDERORDER=4142,e.CAP_REACQUIREALLOWED=4144,e.CAP_BATTERYMINUTES=4146,e.CAP_BATTERYPERCENTAGE=4147,e.CAP_CAMERASIDE=4148,e.CAP_SEGMENTED=4149,e.CAP_CAMERAENABLED=4150,e.CAP_CAMERAORDER=4151,e.CAP_MICRENABLED=4152,e.CAP_FEEDERPREP=4153,e.CAP_FEEDERPOCKET=4154,e.CAP_AUTOMATICSENSEMEDIUM=4155,e.CAP_CUSTOMINTERFACEGUID=4156,e.ICAP_AUTOBRIGHT=4352,e.ICAP_BRIGHTNESS=4353,e.ICAP_CONTRAST=4355,e.ICAP_CUSTHALFTONE=4356,e.ICAP_EXPOSURETIME=4357,e.ICAP_FILTER=4358,e.ICAP_FLASHUSED=4359,e.ICAP_GAMMA=4360,e.ICAP_HALFTONES=4361,e.ICAP_HIGHLIGHT=4362,e.ICAP_IMAGEFILEFORMAT=4364,e.ICAP_LAMPSTATE=4365,e.ICAP_LIGHTSOURCE=4366,e.ICAP_ORIENTATION=4368,e.ICAP_PHYSICALWIDTH=4369,e.ICAP_PHYSICALHEIGHT=4370,e.ICAP_SHADOW=4371,e.ICAP_FRAMES=4372,e.ICAP_XNATIVERESOLUTION=4374,e.ICAP_YNATIVERESOLUTION=4375,e.ICAP_XRESOLUTION=4376,e.ICAP_YRESOLUTION=4377,e.ICAP_MAXFRAMES=4378,e.ICAP_TILES=4379,e.ICAP_BITORDER=4380,e.ICAP_CCITTKFACTOR=4381,e.ICAP_LIGHTPATH=4382,e.ICAP_PIXELFLAVOR=4383,e.ICAP_PLANARCHUNKY=4384,e.ICAP_ROTATION=4385,e.ICAP_SUPPORTEDSIZES=4386,e.ICAP_THRESHOLD=4387,e.ICAP_XSCALING=4388,e.ICAP_YSCALING=4389,e.ICAP_BITORDERCODES=4390,e.ICAP_PIXELFLAVORCODES=4391,e.ICAP_JPEGPIXELTYPE=4392,e.ICAP_TIMEFILL=4394,e.ICAP_BITDEPTH=4395,e.ICAP_BITDEPTHREDUCTION=4396,e.ICAP_UNDEFINEDIMAGESIZE=4397,e.ICAP_EXTIMAGEINFO=4399,e.ICAP_MINIMUMHEIGHT=4400,e.ICAP_MINIMUMWIDTH=4401,e.ICAP_AUTODISCARDBLANKPAGES=4404,e.ICAP_FLIPROTATION=4406,e.ICAP_BARCODEDETECTIONENABLED=4407,e.ICAP_SUPPORTEDBARCODETYPES=4408,e.ICAP_BARCODEMAXSEARCHPRIORITIES=4409,e.ICAP_BARCODESEARCHPRIORITIES=4410,e.ICAP_BARCODESEARCHMODE=4411,e.ICAP_BARCODEMAXRETRIES=4412,e.ICAP_BARCODETIMEOUT=4413,e.ICAP_ZOOMFACTOR=4414,e.ICAP_PATCHCODEDETECTIONENABLED=4415,e.ICAP_SUPPORTEDPATCHCODETYPES=4416,e.ICAP_PATCHCODEMAXSEARCHPRIORITIES=4417,e.ICAP_PATCHCODESEARCHPRIORITIES=4418,e.ICAP_PATCHCODESEARCHMODE=4419,e.ICAP_PATCHCODEMAXRETRIES=4420,e.ICAP_PATCHCODETIMEOUT=4421,e.ICAP_FLASHUSED2=4422,e.ICAP_IMAGEFILTER=4423,e.ICAP_NOISEFILTER=4424,e.ICAP_OVERSCAN=4425,e.ICAP_AUTOMATICBORDERDETECTION=4432,e.ICAP_AUTOMATICDESKEW=4433,e.ICAP_AUTOMATICROTATE=4434,e.ICAP_JPEGQUALITY=4435,e.ICAP_FEEDERTYPE=4436,e.ICAP_ICCPROFILE=4437,e.ICAP_AUTOSIZE=4438,e.ICAP_AUTOMATICCROPUSESFRAME=4439,e.ICAP_AUTOMATICLENGTHDETECTION=4440,e.ICAP_AUTOMATICCOLORENABLED=4441,e.ICAP_AUTOMATICCOLORNONCOLORPIXELTYPE=4442,e.ICAP_COLORMANAGEMENTENABLED=4443,e.ICAP_IMAGEMERGE=4444,e.ICAP_IMAGEMERGEHEIGHTTHRESHOLD=4445,e.ICAP_SUPPORTEDEXTIMAGEINFO=4446}(mo||(mo={})),function(e){e.TWLG_DAN=0,e.TWLG_DUT=1,e.TWLG_ENG=2,e.TWLG_FCF=3,e.TWLG_FIN=4,e.TWLG_FRN=5,e.TWLG_GER=6,e.TWLG_ICE=7,e.TWLG_ITN=8,e.TWLG_NOR=9,e.TWLG_POR=10,e.TWLG_SPA=11,e.TWLG_SWE=12,e.TWLG_USA=13,e.TWLG_USERLOCALE=-1,e.TWLG_AFRIKAANS=14,e.TWLG_ALBANIA=15,e.TWLG_ARABIC=16,e.TWLG_ARABIC_ALGERIA=17,e.TWLG_ARABIC_BAHRAIN=18,e.TWLG_ARABIC_EGYPT=19,e.TWLG_ARABIC_IRAQ=20,e.TWLG_ARABIC_JORDAN=21,e.TWLG_ARABIC_KUWAIT=22,e.TWLG_ARABIC_LEBANON=23,e.TWLG_ARABIC_LIBYA=24,e.TWLG_ARABIC_MOROCCO=25,e.TWLG_ARABIC_OMAN=26,e.TWLG_ARABIC_QATAR=27,e.TWLG_ARABIC_SAUDIARABIA=28,e.TWLG_ARABIC_SYRIA=29,e.TWLG_ARABIC_TUNISIA=30,e.TWLG_ARABIC_UAE=31,e.TWLG_ARABIC_YEMEN=32,e.TWLG_BASQUE=33,e.TWLG_BYELORUSSIAN=34,e.TWLG_BULGARIAN=35,e.TWLG_CATALAN=36,e.TWLG_CHINESE=37,e.TWLG_CHINESE_HONGKONG=38,e.TWLG_CHINESE_PRC=39,e.TWLG_CHINESE_SINGAPORE=40,e.TWLG_CHINESE_SIMPLIFIED=41,e.TWLG_CHINESE_TAIWAN=42,e.TWLG_CHINESE_TRADITIONAL=43,e.TWLG_CROATIA=44,e.TWLG_CZECH=45,e.TWLG_DANISH=0,e.TWLG_DUTCH=1,e.TWLG_DUTCH_BELGIAN=46,e.TWLG_ENGLISH=2,e.TWLG_ENGLISH_AUSTRALIAN=47,e.TWLG_ENGLISH_CANADIAN=48,e.TWLG_ENGLISH_IRELAND=49,e.TWLG_ENGLISH_NEWZEALAND=50,e.TWLG_ENGLISH_SOUTHAFRICA=51,e.TWLG_ENGLISH_UK=52,e.TWLG_ENGLISH_USA=13,e.TWLG_ESTONIAN=53,e.TWLG_FAEROESE=54,e.TWLG_FARSI=55,e.TWLG_FINNISH=4,e.TWLG_FRENCH=5,e.TWLG_FRENCH_BELGIAN=56,e.TWLG_FRENCH_CANADIAN=3,e.TWLG_FRENCH_LUXEMBOURG=57,e.TWLG_FRENCH_SWISS=58,e.TWLG_GERMAN=6,e.TWLG_GERMAN_AUSTRIAN=59,e.TWLG_GERMAN_LUXEMBOURG=60,e.TWLG_GERMAN_LIECHTENSTEIN=61,e.TWLG_GERMAN_SWISS=62,e.TWLG_GREEK=63,e.TWLG_HEBREW=64,e.TWLG_HUNGARIAN=65,e.TWLG_ICELANDIC=7,e.TWLG_INDONESIAN=66,e.TWLG_ITALIAN=8,e.TWLG_ITALIAN_SWISS=67,e.TWLG_JAPANESE=68,e.TWLG_KOREAN=69,e.TWLG_KOREAN_JOHAB=70,e.TWLG_LATVIAN=71,e.TWLG_LITHUANIAN=72,e.TWLG_NORWEGIAN=9,e.TWLG_NORWEGIAN_BOKMAL=73,e.TWLG_NORWEGIAN_NYNORSK=74,e.TWLG_POLISH=75,e.TWLG_PORTUGUESE=10,e.TWLG_PORTUGUESE_BRAZIL=76,e.TWLG_ROMANIAN=77,e.TWLG_RUSSIAN=78,e.TWLG_SERBIAN_LATIN=79,e.TWLG_SLOVAK=80,e.TWLG_SLOVENIAN=81,e.TWLG_SPANISH=11,e.TWLG_SPANISH_MEXICAN=82,e.TWLG_SPANISH_MODERN=83,e.TWLG_SWEDISH=12,e.TWLG_THAI=84,e.TWLG_TURKISH=85,e.TWLG_UKRANIAN=86,e.TWLG_ASSAMESE=87,e.TWLG_BENGALI=88,e.TWLG_BIHARI=89,e.TWLG_BODO=90,e.TWLG_DOGRI=91,e.TWLG_GUJARATI=92,e.TWLG_HARYANVI=93,e.TWLG_HINDI=94,e.TWLG_KANNADA=95,e.TWLG_KASHMIRI=96,e.TWLG_MALAYALAM=97,e.TWLG_MARATHI=98,e.TWLG_MARWARI=99,e.TWLG_MEGHALAYAN=100,e.TWLG_MIZO=101,e.TWLG_NAGA=102,e.TWLG_ORISSI=103,e.TWLG_PUNJABI=104,e.TWLG_PUSHTU=105,e.TWLG_SERBIAN_CYRILLIC=106,e.TWLG_SIKKIMI=107,e.TWLG_SWEDISH_FINLAND=108,e.TWLG_TAMIL=109,e.TWLG_TELUGU=110,e.TWLG_TRIPURI=111,e.TWLG_URDU=112,e.TWLG_VIETNAMESE=113}(So||(So={})),function(e){e.TWSS_NONE=0,e.TWSS_A4LETTER=1,e.TWSS_B5LETTER=2,e.TWSS_USLETTER=3,e.TWSS_USLEGAL=4,e.TWSS_A5=5,e.TWSS_B4=6,e.TWSS_B6=7,e.TWSS_USLEDGER=9,e.TWSS_USEXECUTIVE=10,e.TWSS_A3=11,e.TWSS_B3=12,e.TWSS_A6=13,e.TWSS_C4=14,e.TWSS_C5=15,e.TWSS_C6=16,e.TWSS_4A0=17,e.TWSS_2A0=18,e.TWSS_A0=19,e.TWSS_A1=20,e.TWSS_A2=21,e.TWSS_A4=1,e.TWSS_A7=22,e.TWSS_A8=23,e.TWSS_A9=24,e.TWSS_A10=25,e.TWSS_ISOB0=26,e.TWSS_ISOB1=27,e.TWSS_ISOB2=28,e.TWSS_ISOB3=12,e.TWSS_ISOB4=6,e.TWSS_ISOB5=29,e.TWSS_ISOB6=7,e.TWSS_ISOB7=30,e.TWSS_ISOB8=31,e.TWSS_ISOB9=32,e.TWSS_ISOB10=33,e.TWSS_JISB0=34,e.TWSS_JISB1=35,e.TWSS_JISB2=36,e.TWSS_JISB3=37,e.TWSS_JISB4=38,e.TWSS_JISB5=2,e.TWSS_JISB6=39,e.TWSS_JISB7=40,e.TWSS_JISB8=41,e.TWSS_JISB9=42,e.TWSS_JISB10=43,e.TWSS_C0=44,e.TWSS_C1=45,e.TWSS_C2=46,e.TWSS_C3=47,e.TWSS_C7=48,e.TWSS_C8=49,e.TWSS_C9=50,e.TWSS_C10=51,e.TWSS_USSTATEMENT=52,e.TWSS_BUSINESSCARD=53,e.TWSS_MAXSIZE=54}(Io||(Io={})),function(e){e.TWON_NONE=0,e.TWON_ARRAY=3,e.TWON_ENUMERATION=4,e.TWON_ONEVALUE=5,e.TWON_RANGE=6}(Eo||(Eo={})),function(e){e.TWTY_INT8=0,e.TWTY_INT16=1,e.TWTY_INT32=2,e.TWTY_UINT8=3,e.TWTY_UINT16=4,e.TWTY_int=5,e.TWTY_BOOL=6,e.TWTY_FIX32=7,e.TWTY_FRAME=8,e.TWTY_STR32=9,e.TWTY_STR64=10,e.TWTY_STR128=11,e.TWTY_STR255=12}(vo||(vo={})),function(e){e.TWFA_NONE=0,e.TWFA_LEFT=1,e.TWFA_CENTER=2,e.TWFA_RIGHT=3}(bo||(bo={})),function(e){e.TWFO_FIRSTPAGEFIRST=0,e.TWFO_LASTPAGEFIRST=1}(wo||(wo={})),function(e){e.TWPR_IMPRINTERTOPBEFORE=0,e.TWPR_IMPRINTERTOPAFTER=1,e.TWPR_IMPRINTERBOTTOMBEFORE=2,e.TWPR_IMPRINTERBOTTOMAFTER=3,e.TWPR_ENDORSERTOPBEFORE=4,e.TWPR_ENDORSERTOPAFTER=5,e.TWPR_ENDORSERBOTTOMBEFORE=6,e.TWPR_ENDORSERBOTTOMAFTER=7}(Co||(Co={})),function(e){e.TWPM_SINGLESTRING=0,e.TWPM_MULTISTRING=1,e.TWPM_COMPOUNDSTRING=2}(Wo||(Wo={})),function(e){e.TWBR_THRESHOLD=0,e.TWBR_HALFTONE=1,e.TWBR_CUSTHALFTONE=2,e.TWBR_DIFFUSION=3}(Ao||(Ao={})),function(e){e.TWBO_LSBFIRST=0,e.TWBO_MSBFIRST=1}(yo||(yo={})),function(e){e.TWFT_RED=0,e.TWFT_GREEN=1,e.TWFT_BLUE=2,e.TWFT_NONE=3,e.TWFT_WHITE=4,e.TWFT_CYAN=5,e.TWFT_MAGENTA=6,e.TWFT_YELLOW=7,e.TWFT_BLACK=8}(Po||(Po={})),function(e){e.TWFL_NONE=0,e.TWFL_OFF=1,e.TWFL_ON=2,e.TWFL_AUTO=3,e.TWFL_REDEYE=4}(Do||(Do={})),function(e){e.TWFR_BOOK=0,e.TWFR_FANFOLD=1}(Oo||(Oo={})),function(e){e.TWIF_NONE=0,e.TWIF_AUTO=1,e.TWIF_LOWPASS=2,e.TWIF_BANDPASS=3,e.TWIF_HIGHPASS=4,e.TWIF_TEXT=3,e.TWIF_FINELINE=4}(Lo||(Lo={})),function(e){e.TWLP_REFLECTIVE=0,e.TWLP_TRANSMISSIVE=1}(No||(No={})),function(e){e.TWLS_RED=0,e.TWLS_GREEN=1,e.TWLS_BLUE=2,e.TWLS_NONE=3,e.TWLS_WHITE=4,e.TWLS_UV=5,e.TWLS_IR=6}(Ro||(Ro={})),function(e){e.TWNF_NONE=0,e.TWNF_AUTO=1,e.TWNF_LONEPIXEL=2,e.TWNF_MAJORITYRULE=3}(xo||(xo={})),function(e){e.TWOR_ROT0=0,e.TWOR_ROT90=1,e.TWOR_ROT180=2,e.TWOR_ROT270=3,e.TWOR_PORTRAIT=0,e.TWOR_LANDSCAPE=3,e.TWOR_AUTO=4,e.TWOR_AUTOTEXT=5,e.TWOR_AUTOPICTURE=6}(Fo||(Fo={})),function(e){e.TWOV_NONE=0,e.TWOV_AUTO=1,e.TWOV_TOPBOTTOM=2,e.TWOV_LEFTRIGHT=3,e.TWOV_ALL=4}(ko||(ko={})),function(e){e.TWPF_CHOCOLATE=0,e.TWPF_VANILLA=1}(Mo||(Mo={})),function(e){e.TWPC_CHUNKY=0,e.TWPC_PLANAR=1}(Bo||(Bo={})),function(e){e.TWBP_DISABLE=-2,e.TWBP_AUTO=-1}(Go||(Go={})),function(e){e.TWAIN=0,e.ICA=3,e.SANE=3,e.TWAIN_AND_ICA=4,e.TWAIN_AND_TWAIN64=4,e.TWAIN64=5}(Uo||(Uo={})),function(e){e.URL=0,e.Blob=1,e.Base64=2}(Ho||(Ho={})),function(e){e.IT_BMP=0,e.IT_JPG=1,e.IT_TIF=2,e.IT_PNG=3,e.IT_PDF=4,e.IT_ALL=5,e.IT_MULTIPAGE_PDF=7,e.IT_MULTIPAGE_TIF=8,e.IT_J2K=14}(jo||(jo={})),function(e){e.RGBA=15,e.Auto=16}(Vo||(Vo={})),function(e){e.Info=1,e.Error=2,e.NotInstalledError=3}(Xo||(Xo={})),function(e){e.Text=0,e.Blob=1,e.ArrayBuffer=2,e.XML=3,e.JSON=4,e.UserDefined=5}(Ko||(Ko={})),function(e){e.Binary=0,e.Base64=1}(zo||(zo={})),function(e){e.CONNECTING=0,e.OPEN=1,e.CLOSING=2,e.CLOSED=3}(Jo||(Jo={})),function(e){e.normal=0,e.balance=1}(Yo||(Yo={})),function(e){e.TWPT_BW=0,e.TWPT_GRAY=1,e.TWPT_RGB=2,e.TWPT_PALLETE=3,e.TWPT_CMY=4,e.TWPT_CMYK=5,e.TWPT_YUV=6,e.TWPT_YUVK=7,e.TWPT_CIEXYZ=8,e.TWPT_LAB=9,e.TWPT_SRGB=10,e.TWPT_SCRGB=11,e.TWPT_INFRARED=16}(qo||(qo={})),function(e){e.TWUN_INCHES=0,e.TWUN_CENTIMETERS=1,e.TWUN_PICAS=2,e.TWUN_POINTS=3,e.TWUN_TWIPS=4,e.TWUN_PIXELS=5,e.TWUN_MILLIMETERS=6}(Qo||(Qo={})),An.mix(Pn.DWT,{EnumDWT_DeviceType:Qn,EnumDWT_Cap:mo,EnumDWT_CapLanguage:So,EnumDWT_CapSupportedSizes:Io,EnumDWT_CapType:Eo,EnumDWT_CapValueType:vo,EnumDWT_CapFeederAlignment:bo,EnumDWT_CapFeederOrder:wo,EnumDWT_CapPrinter:Co,EnumDWT_CapPrinterMode:Wo,EnumDWT_CapBitdepthReduction:Ao,EnumDWT_CapBitOrder:yo,EnumDWT_CapFilterType:Po,EnumDWT_CapFlash:Do,EnumDWT_CapFlipRotation:Oo,EnumDWT_CapImageFilter:Lo,EnumDWT_CapLightPath:No,EnumDWT_CapLightSource:Ro,EnumDWT_CapNoiseFilter:xo,EnumDWT_CapORientation:Fo,EnumDWT_CapOverscan:ko,EnumDWT_CapPixelFlavor:Mo,EnumDWT_CapPlanarChunky:Bo,EnumDWT_ImageType:jo,EnumDWT_ImageFormatType:Ho,EnumDWT_ResponseType:Ko,EnumDWT_SourceMatchField:st,EnumDWT_UploadDataFormat:zo,EnumDWT_WorkMode:Yo,EnumDWT_ConvertMode:bi,EnumDWT_PixelType:qo,EnumDWT_UnitType:Qo});var Zo,$o,ea,na,ta,ra=Pn.DWT;function ia(e){var n=this;n._stwain=e,Cn.attachAxViewerPropertyUI(n),Cn.attachAxViewerFunctions(n),n._thumbnailViewer=null}ra.EnumPDF_Page={Page_Default:0,Page_Custom:1,Page_A4:2,Page_A4_Reverse:3,Page_A3:4,Page_A3_Reverse:5,Page_Letter:6,Page_Letter_Reverse:7,Page_Legal:8,Page_Legal_Reverse:9},ra.EnumDWT_BorderStyle={TWBS_NONE:0,TWBS_SINGLEFLAT:1,TWBS_SINGLE3D:2},ra.EnumDWT_MessageType={TWQC_GET:1,TWQC_SET:2,TWQC_GETDEFAULT:4,TWQC_GETCURRENT:8,TWQC_RESET:16},ra.EnumDWT_TransferMode={TWSX_NATIVE:0,TWSX_FILE:1,TWSX_MEMORY:2},ra.EnumDWT_FileFormat={TWFF_TIFF:0,TWFF_PICT:1,TWFF_BMP:2,TWFF_XBM:3,TWFF_JFIF:4,TWFF_FPX:5,TWFF_TIFFMULTI:6,TWFF_PNG:7,TWFF_SPIFF:8,TWFF_EXIF:9,TWFF_PDF:10,TWFF_JP2:11,TWFF_JPN:12,TWFF_JPX:13,TWFF_DEJAVU:14,TWFF_PDFA:15,TWFF_PDFA2:16},ra.EnumDWT_TIFFCompressionType={TIFF_AUTO:0,TIFF_NONE:1,TIFF_RLE:2,TIFF_FAX3:3,TIFF_T4:3,TIFF_FAX4:4,TIFF_T6:4,TIFF_LZW:5,TIFF_JPEG:7,TIFF_PACKBITS:32773},ra.EnumDWT_InterpolationMethod={IM_NEARESTNEIGHBOUR:1,IM_BILINEAR:2,IM_BICUBIC:3,IM_BESTQUALITY:5},ra.EnumDWT_PDFCompressionType={PDF_AUTO:0,PDF_FAX3:1,PDF_FAX4:2,PDF_LZW:3,PDF_RLE:4,PDF_JPEG:5,PDF_JP2000:6,PDF_JBIG2:7},ra.EnumDWT_ShowMode={SW_ACTIVE:0,SW_MAX:1,SW_MIN:2,SW_CLOSE:3,SW_IFLIVE:4},ra.EnumDWT_DUPLEX={TWDX_NONE:0,TWDX_1PASSDUPLEX:1,TWDX_2PASSDUPLEX:2},ra.EnumDWT_MagType={TWMD_MICR:0,TWMD_RAW:1,TWMD_INVALID:2},ra.EnumDWT_DataSourceStatus={TWDSS_CLOSED:0,TWDSS_OPENED:1,TWDSS_ENABLED:2,TWDSS_ACQUIRING:3},function(e){e.enumFitWindow=0,e.enumFitWindowHeight=1,e.enumFitWindowWidth=2}(Zo||(Zo={})),ra.EnumDWT_FitWindowType={enumFitWindow:Zo.enumFitWindow,enumFitWindowHeight:Zo.enumFitWindowHeight,enumFitWindowWidth:Zo.enumFitWindowWidth},ra.EnumDWT_PlatformType={enumUnknown:Gn.enumUnknown,enumWindow:Gn.enumWindow,enumMac:Gn.enumMac,enumLinux:Gn.enumLinux,enumEmbed:Gn.enumEmbed,enumChromeOS:Gn.enumChromeOS,enumHarmonyOS:Gn.enumHarmonyOS,enumAndroid:Gn.enumAndroid,enumiOS:Gn.enumiOS},function(e){e.Default=0,e.Hand=1,e.Crosshair=2,e.Zoom=3,e.NWResize=4,e.EResize=5,e.NResize=6,e.Resize=7,e.Move=8}($o||($o={})),ra.EnumDWT_MouseShape={Default:$o.Default,Hand:$o.Hand,Crosshair:$o.Crosshair,Zoom:$o.Zoom,NWResize:$o.NWResize,EResize:$o.EResize,NResize:$o.NResize,Resize:$o.Resize,Move:$o.Move},ra.EnumDWT_Language={English:0,French:1,Arabic:2,Spanish:3,Portuguese:4,German:5,Italian:6,Russian:7,Chinese:8},ra.EnumDWT_InitMsg={Info:Xo.Info,Error:Xo.Error,NotInstalledError:Xo.NotInstalledError},ra.EnumDWT_Driver={TWAIN:Uo.TWAIN,ICA:Uo.ICA,SANE:Uo.SANE,TWAIN_AND_ICA:Uo.TWAIN_AND_ICA,TWAIN_AND_TWAIN64:Uo.TWAIN_AND_TWAIN64,TWAIN64:Uo.TWAIN64},ra.EnumDWT_CompressionType={TWCP_NONE:0,TWCP_PACKBITS:1,TWCP_GROUP31D:2,TWCP_GROUP31DEOL:3,TWCP_GROUP32D:4,TWCP_GROUP4:5,TWCP_JPEG:6,TWCP_LZW:7,TWCP_JBIG:8,TWCP_PNG:9,TWCP_RLE4:10,TWCP_RLE8:11,TWCP_BITFIELDS:12,TWCP_ZIP:13,TWCP_JPEG2000:14},function(e){e.Single=0,e.Multiple=1}(ea||(ea={})),ra.EnumDWT_SelectionMode={Single:ea.Single,Multiple:ea.Multiple},ra.EnumDWT_ConfirmExitType={Cancel:0,Exit:1,SaveAndExit:2},ra.EnumDWT_WebsocketReadyState={CONNECTING:Jo.CONNECTING,OPEN:Jo.OPEN,CLOSING:Jo.CLOSING,CLOSED:Jo.CLOSED},function(e){e.TwainService=1}(na||(na={})),ra.EnumDWT_ServiceType={TwainService:na.TwainService},function(e){e["default"]=0,e.standard=1,e.supported=2}(ta||(ta={})),ra.EnumDWT_ExtImageInfo={"default":ta["default"],standard:ta.standard,supported:ta.supported},Cn.attachAxViewerPropertyUI=function(e){var n=function(n,t){n in e||Object.defineProperty(e,n,t)};n("width",{get:function(){return e._stwain.Width},set:function(n){return e._stwain.Width=n,Cn.checkErrorString(e._stwain)}}),n("height",{get:function(){return e._stwain.Height},set:function(n){return e._stwain.Height=n,Cn.checkErrorString(e._stwain)}}),n("background",{get:function(){return e._stwain.BackgroundColor},set:function(n){return e._stwain.BackgroundColor=n,n}}),n("cursor",{get:function(){return e._stwain.MouseShape?"pointer":"crosshair"},set:function(n){return e._stwain.MouseShape="pointer"==n,n}}),n("showPageNumber",{get:function(){return!1},set:function(e){return!1}}),n("ifAutoScroll",{get:function(){return e._stwain.IfAutoScroll},set:function(n){return e._stwain.IfAutoScroll=n,n}}),n("pageMargin",{get:function(){return e._stwain.ImageMargin},set:function(n){return e._stwain.ImageMargin=n,n}}),n("zoom",{get:function(){return e._stwain.Zoom},set:function(n){return e._stwain.Zoom=n,n}})},Cn.attachAxViewerFunctions=function(e){e.next=function(){return this._stwain.next()},e.previous=function(){return this._stwain.previous()},e.first=function(){return this._stwain.first()},e.last=function(){return this._stwain.last()},e.gotoPage=function(e){var n=this,t=1*e;return Cn.isNaN(t)||!Cn.isNumber(t)?(Pt(n._stwain),!1):t<0||t>=n._stwain.HowManyImagesInBuffer?(Ft(n._stwain),!1):(n._stwain.CurrentImageIndexInBuffer=t,t)},e.setSelectedAreas=function(e){return this._stwain.SetSelectedImageArea(this._stwain.CurrentImageIndexInBuffer,e.left,e.top,e.right,e.bottom)},e.fitWindow=function(e){var n=this;return"height"==e?(n._stwain.IfFitWindow=!0,n._stwain.FitWindowType=Zo.enumFitWindowHeight):"width"==e?(n._stwain.IfFitWindow=!0,n._stwain.FitWindowType=Zo.enumFitWindowWidth):(n._stwain.IfFitWindow=!0,n._stwain.FitWindowType=Zo.enumFitWindow),!0},e.setViewMode=function(e,n){return this._stwain.SetViewMode(e,n)},e.createImageEditor=function(){return this._stwain},e.on=function(e,n){var t,r=this;return""!=(t=r._convertEvtName(e))&&("OnImageAreaSelected"==t?(r.OnImageAreaSelected=function(e,t,r,i,o){n(e,[{x:t,y:r,width:i-t,height:o-r}])},r._stwain.RegisterEvent(t,r.OnImageAreaSelected)):r._stwain.RegisterEvent(t,n))},e.off=function(e,n){var t;return""!=(t=this._convertEvtName(e))&&this._stwain.UnregisterEvent(t,(function(){}))},e.createThumbnailViewer=function(e){var n=this;if(n._thumbnailViewer)Wt(n._stwain,-2501,"A ThumbnailViewer already exists.");else{var t=new Cn.UI.ThumbnailViewer(n._stwain,e);n._thumbnailViewer=t.getInstance()}return n._thumbnailViewer},e._convertEvtName=function(e){if(!Cn.isString(e))return"";var n=Cn.trim(e).toLowerCase();return"toppagechanged"==n?"OnTopImageInTheViewChanged":"click"==n?"OnMouseClick":"dblclick"==n?"OnMouseDoubleClick":"mousemove"==n?"OnMouseMove":"rightclick"==n?"OnMouseRightClick":"wheel"==n?"OnMouseWheel":"keydown"==n?"OnKeyDown":"pageareaselected"==n?"OnImageAreaSelected":"pageareaunselected"==n?"OnImageAreaDeSelected":Cn.trim(e)}},ia.prototype.getInstance=function(){return this};var oa={showThumbnail:!1,location:"horizontal",sequence:-1,size:"30%",columns:1,rows:3,scrollDirection:"vertical",pageMargin:10,border:"",allowKeyboardControl:!0,allowPageDragging:!0,allowResizing:!1,pageBackground:"transparent",pageBorder:"1px solid rgb(238, 238, 238)",hoverPageBackground:"rgb(239, 246, 253)",hoverPageBorder:"1px solid rgb(238, 238, 238)",placeholderBackground:"rgb(251, 236, 136)",autoChangeIndex:!1};function aa(e,n){var t=this,r=n;if(r){if(r.location)switch(r.location){case"left":default:r.location="horizontal",r.sequence=-1;break;case"right":r.location="horizontal",r.sequence=1;break;case"top":r.location="vertical",r.sequence=-1;break;case"bottom":r.location="vertical",r.sequence=1}else r.location="horizontal",r.sequence=-1;Cn.isUndefined(r.size)&&(r.size=oa.size),Cn.isUndefined(r.columns)&&(r.columns=oa.columns),Cn.isUndefined(r.rows)&&(r.rows=oa.rows),(Cn.isUndefined(r.scrollDirection)||"horizontal"!=r.scrollDirection)&&(r.scrollDirection=oa.scrollDirection),Cn.isUndefined(r.pageMargin)&&(r.pageMargin=oa.pageMargin),Cn.isUndefined(r.allowKeyboardControl)&&(r.allowKeyboardControl=oa.allowKeyboardControl),Cn.isUndefined(r.allowPageDragging)&&(r.allowPageDragging=oa.allowPageDragging),Cn.isUndefined(r.allowResizing)&&(r.allowResizing=oa.allowResizing),Cn.isUndefined(r.border)&&(r.border=oa.border),Cn.isUndefined(r.pageBackground)&&(r.pageBackground=oa.pageBackground),Cn.isUndefined(r.pageBorder)&&(r.pageBorder=oa.pageBorder),Cn.isUndefined(r.hoverPageBackground)&&(r.hoverPageBackground=oa.hoverPageBackground),Cn.isUndefined(r.hoverPageBorder)&&(r.hoverPageBorder=oa.hoverPageBorder),Cn.isUndefined(r.placeholderBackground)&&(r.placeholderBackground=oa.placeholderBackground),Cn.isUndefined(r.autoChangeIndex)&&(r.autoChangeIndex=oa.autoChangeIndex)}else r=oa;t._stwain=e,t._settings=r,Cn.attachViewerPropertyThumbnailUI(t),Cn.attachViewerFunctionsThumbnailUI(t),e.getSWebTwain().SetViewMode(-1,-1),e.getSWebTwain().ShowThumbnail(Cn.stringify(r))}aa.prototype.getInstance=function(){return this},Cn.attachViewerFunctionsThumbnailUI=function(e){e.show=function(){e._stwain?(e._stwain.getSWebTwain().SetViewMode(-1,-1),e._stwain.getSWebTwain().ShowThumbnail('{"mode":"show"}')):Ht(e._stwain)},e.hide=function(){e._stwain?e._stwain.getSWebTwain().ShowThumbnail('{"mode":"hide"}'):Ht(e._stwain)},e.dispose=function(){e.hide(),e._stwain=null},e.updateViewMode=function(n){if(e._stwain){if(n&&n.columns&&n.rows){if(n.columns<0||n.rows<0)return Wt(e._stwain,-2514,"Invalid property value."),!1;e._stwain.getSWebTwain().ShowThumbnail('{"columns":'+n.columns+',"rows":'+n.rows+"}")}}else Ht(e._stwain)},e.on=function(n,t){var r=n,i=!1;Cn.isFunction(t)&&("click"==r&&(r="OnMouseClick"),"rightclick"==r&&(r="OnMouseRightClick"),"dblclick"==r&&(r="OnMouseDoubleClick"),"mousemove"==r&&(r="OnMouseMove"),"wheel"==r&&(r="OnMouseWheel"),"keydown"==r&&(r="OnKeyDown"),"toppagechanged"==r&&(r="OnTopImageInTheViewChanged"),"pageareaselected"==r&&(r="OnImageAreaSelected"),"pageareaunselected"==r&&(r="OnImageAreaDeSelected"),"OnMouseClick"==r||"OnMouseDoubleClick"==r||"OnMouseRightClick"==r||"OnMouseMove"==r||"OnMouseWheel"==r||"OnKeyDown"==r||"OnPaintDone"==r||"OnImageAreaDeSelected"==r||"OnTopImageInTheViewChanged"==r?(Cn.isFunction(e._stwain["__"+r])||Cn.isFunction(e._stwain["__"+r+"_Thumbnail"])||(i=!0),e._stwain["__"+r+"_Thumbnail"]=t,i&&e._stwain.getSWebTwain().RegisterEvent(r,(function(n,t){return e._stwain.__OnDispatchThumbnailEvt(r,n,t)}))):"OnImageAreaSelected"==r&&(Cn.isFunction(e._stwain["__"+r])||Cn.isFunction(e._stwain["__"+r+"_Thumbnail"])||(i=!0),e._stwain["__"+r+"_Thumbnail"]=t,i&&e._stwain.getSWebTwain().RegisterEvent(r,e._stwain._OnImageAreaSelected)))},e.off=function(n,t){e._stwain["__"+n+"_Thumbnail"]=""}},Cn.attachViewerPropertyThumbnailUI=function(e){var n=function(n,t){n in e||Object.defineProperty(e,n,t)};n("location",{get:function(){return e._settings.location},set:function(n){e._settings.location=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"location":"'+n+'"}')}}),n("size",{get:function(){return e._settings.size},set:function(n){e._settings.size=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"size":"'+n+'"}')}}),n("pageMargin",{get:function(){return e._settings.pageMargin},set:function(n){e._settings.pageMargin=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"pageMargin":"'+n+'"}')}}),n("background",{get:function(){return e._settings.background},set:function(n){e._settings.background=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"background":"'+n+'"}')}}),n("pageBackground",{get:function(){return e._settings.pageBackground},set:function(n){e._settings.pageBackground=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"pageBackground":"'+n+'"}')}}),n("selectedPageBorder",{get:function(){return e._settings.selectedPageBorder},set:function(n){e._settings.selectedPageBorder=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"selectedPageBorder":"'+n+'"}')}}),n("selectedPageBackground",{get:function(){return e._settings.selectedPageBackground},set:function(n){e._settings.selectedPageBackground=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"selectedPageBackground":"'+n+'"}')}}),n("scrollDirection",{get:function(){return e._settings.scrollDirection},set:function(n){e._settings.scrollDirection=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"scrollDirection":"'+n+'"}')}}),n("showPageNumber",{get:function(){return e._settings.showPageNumber},set:function(n){e._settings.showPageNumber=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"showPageNumber":"'+n+'"}')}}),n("border",{get:function(){return e._settings.border},set:function(n){e._settings.border=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"border":"'+n+'"}')}}),n("pageBorder",{get:function(){return e._settings.pageBorder},set:function(n){e._settings.pageBorder=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"pageBorder":"'+n+'"}')}}),n("hoverPageBackground",{get:function(){return e._settings.hoverPageBackground},set:function(n){e._settings.hoverPageBackground=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"hoverPageBackground":"'+n+'"}')}}),n("hoverPageBorder",{get:function(){return e._settings.hoverPageBorder},set:function(n){e._settings.hoverPageBorder=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"hoverPageBorder":"'+n+'"}')}}),n("placeholderBackground",{get:function(){return e._settings.placeholderBackground},set:function(n){e._settings.placeholderBackground=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"placeholderBackground":"'+n+'"}')}}),n("allowKeyboardControl",{get:function(){return e._settings.allowKeyboardControl},set:function(n){e._settings.allowKeyboardControl=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"allowKeyboardControl":"'+n+'"}')}}),n("allowPageDragging",{get:function(){return e._settings.allowPageDragging},set:function(n){e._settings.allowPageDragging=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"allowPageDragging":"'+n+'"}')}}),n("allowResizing",{get:function(){return e._settings.allowResizing},set:function(n){e._settings.allowResizing=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"allowResizing":"'+n+'"}')}}),n("autoChangeIndex",{get:function(){return e._settings.autoChangeIndex},set:function(n){e._settings.autoChangeIndex=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"autoChangeIndex":"'+n+'"}')}})},Cn.UI=Cn.UI||{},Cn.UI.DWTAxViewer=ia,Cn.UI.ThumbnailViewer=aa;var sa=An.isString,ua=An.isArray,ca=An.each;function la(e,n){if(sa(n))e.push('"'),e.push(n),e.push('"');else if(ua(n)){var t=$n;e.push("["),ca(n,(function(n){t?t=Zn:e.push(","),la(e,n)})),e.push("]")}else n===undefined?e.push('""'):e.push(n)}var fa=1;var da=function(){function e(n,t){d(this,e),xn(this,"m_server",""),xn(this,"m_iUsingTime",0),xn(this,"m_countMap",{}),xn(this,"m_newConsum",!1),xn(this,"m_mapSavedToDb",!1),this.clearData(),this.m_enumInstance=n,n==Pn.DWT.EnumInstance.dwt_desktop?(this.m_deploymentType="desktop",this.m_server=t):n==Pn.DWT.EnumInstance.dbr&&(this.m_deploymentType="browser",this.m_server="")}return g(e,[{key:"clearData",value:function(){this.m_iUsingTime=0,this.m_jvUsingTime=An.nil,this.m_countMap={},this.m_newConsum=!1,this.m_mapSavedToDb=!1,this.m_minExpiredTime=An.nil,this.m_maxExpiredTime=An.nil,this.m_cu=An.nil,this.m_ar=An.nil,this.m_ltsInstance=An.nil}},{key:"set_cu",value:function(e){this.m_cu=e}},{key:"get_cu",value:function(){return this.m_cu}},{key:"set_ar",value:function(e){this.m_ar=e}},{key:"get_ar",value:function(){return this.m_ar}},{key:"get_ltsInstance",value:function(e){return this.m_ltsInstance||(this.m_ltsInstance=e(this.m_enumInstance)),this.m_ltsInstance}},{key:"inited_ltsInstance",value:function(){return!!this.m_ltsInstance}},{key:"set_maxExpiredTime",value:function(e){this.m_maxExpiredTime=e}},{key:"get_maxExpiredTime",value:function(){return this.m_maxExpiredTime}},{key:"set_minExpiredTime",value:function(e){this.m_minExpiredTime=e}},{key:"get_minExpiredTime",value:function(){return this.m_minExpiredTime}},{key:"get_deploymentType",value:function(){return this.m_deploymentType}},{key:"get_enumDeploymentType",value:function(){return this.m_enumInstance}}]),e}();var Ta=Pn.DWT;Ta.LTS=Ta.LTS||{},Ta.licenseException={code:0,message:"",fromLTS:!1},Ta.bLTSOnline=!0,Ta.axInstance=undefined,Ta.lOnUpdateDWObj=[],Ta.EnumInstance={dwt_desktop:0,dwt_browser:1,dbr:2};var ha,ga=0,pa={},_a=!1,ma=!1,Sa=!1,Ia=!1,Ea=!1;function va(){var e=Yn.handshakeCode;return An.isString(e)||(e=""),e}function ba(){var e=Yn.organizationID;return An.isNumber(e)?e=""+e:An.isString(e)||(e=""),e}function wa(){return An.replaceAll(Un.JSVersion,",",".")}function Ca(e,n){var t=e;return t===An.nil&&(t=Ta.EnumInstance.dwt_desktop),t==Ta.EnumInstance.dbr?(Ta._dbrLicense||(Ta._dbrLicense=new da(t,"")),Ta._dbrLicense):(Ta._dwtDLicense||(Ta._dwtDLicense=new da(t,"")),Ta._dwtDLicense)}Ta.lupverfy=function(){Ca(Ta.EnumInstance.dwt_desktop).get_ltsInstance(ya),Ca(Ta.EnumInstance.dbr).get_ltsInstance(ya)},Ta.lsmid=function(e,n){Ca(Ta.EnumInstance.dwt_desktop).set_cu(e)},Ta.lsar=function(e,n){Ca(Ta.EnumInstance.dwt_desktop).set_ar(e)},Ta.lsmid2b=function(e){Ca(Ta.EnumInstance.dwt_desktop).set_cu(e)},Ta.lgar=function(e,n){Ca(e).get_ar()},Ta.laddDWTObj=function(e){var n=!1;An.each(Ta.lOnUpdateDWObj,(function(t){if(t==e)return n=!0,!1})),n||Ta.lOnUpdateDWObj.push(e)},Ta.lremoveDWTObj=function(e){An.each(Ta.lOnUpdateDWObj,(function(n,t){if(n==e)return Ta.lOnUpdateDWObj.splice(t,1),!1}))},Ta.lsendUpdateEvt=function(e,n){var t=[];if(An.each(Ta.lOnUpdateDWObj,(function(n){e==Ta.EnumInstance.dwt_desktop&&t.push(n)})),0==t.length)return Cn.Promise.resolve();var r,i=t[0];return i._bAx?(An.each(t,(function(n){n.SetLTSInfo(Ca(e).get_ar(),Ca(e).get_cu())})),i.GetLicenseInfo().then((function(t){t&&An.isArray(t.Detail)&&t.Detail.length>0&&Ta.lsexp(e,t.Detail[0].ExpireDate,n)}))):(r=i.SetLTSLicenseAsync(Ca(e).get_ar()).then((function(t){t&&An.isArray(t.Detail)&&t.Detail.length>0&&Ta.lsexp(e,t.Detail[0].ExpireDate,n)})),An.each(t,(function(n,t){0!=t&&n.SetLTSLicenseAsync(Ca(e).get_ar())})),r)},Ta.lgcb=function(){var e=[];return z.bChrome?e.push("Chrome"):z.bFirefox?e.push("Firefox"):z.bEdge?e.push("Edge"):z.bIE?e.push("IE"):z.bSafari?e.push("Safari"):z.bOpera?e.push("Opera"):z.b360SE?e.push("360SE"):z.bTencentTraveler?e.push("TencentTraveler"):z.bMaxthon?e.push("Maxthon"):z.bMetaSr?e.push("MetaSr"):z.bTheWorld?e.push("TheWorld"):z.bUC?e.push("UC"):z.bHuaWeiBrowser&&e.push("HuaWeiBrowser"),e.push(z.strBrowserVersion),z.bWin?e.push("Windows"):z.bMac?e.push("Mac"):z.bLinux?e.push("Linux"):z.bAndroid?e.push("Android"):z.bChromeOS?e.push("ChromeOS"):z.bHarmonyOS?e.push("HarmonyOS"):ho.bMobile?e.push("Mobile OS"):Pn.navInfo.bEmbed&&e.push("Embed OS"),e.join(" ")};var Wa,Aa={NetworkError:-2440,Timedout:-2441,JsonError:-2442,CorsError:-2443,Expired:-2445,LtsJsLoadError:-2446,UUIDError:-2447};function ya(e){var n,t,r=Yn.licenseServer;if(r&&r.length>0)for(n=0;n<r.length;n++)t=r[n],An.endsWith(t,"/")||(r[n]=t+"/");var i={dm:location.origin?An.startsWith(location.origin,"http")?location.origin:"https://localhost":An.startsWith(location.href,"http")?location.href:"https://localhost",lf:Cn.localforage,btoa:An.btoa,atob:An.atob,sutlcb:function(){An.isFunction(Ta.lonsend)&&Ta.lonsend()},fol:Ta.OnFirstOffline,dwt:!0};if(e==Ta.EnumInstance.dwt_browser||e==Ta.EnumInstance.dbr?i.feab=Ta.lfeab_wasm:i.feab=Ta.lfeab_ax,!z.bIE&&Yn.ltsDebug&&(i.debugLog=console.log),Pn.LTS&&Pn.LTS._)return Pn.LTS._.createLtsInstance(i);var o={},a=function(){return Cn.Promise.reject({code:Aa.LtsJsLoadError,message:"The dynamsoft.lts.js load failed."})};return o.i=a,o.s=a,o.u=a,o.caret=a,o}function Pa(e,n){var t=null!=n?n:"",r=Ca(e),i=r.get_enumDeploymentType();if(Ta.lclex(),r.get_ar()&&r.get_cu())return Cn.Promise.resolve({ar:r.get_ar(),cu:r.get_cu()});var o={pd:Ta.lgpd(e),v:wa(),os:Ta.lgcb(),fn:Ta.DeviceFriendlyName||"",ls:Yn.licenseServer,sp:Yn.sessionPassword,l:qi.getLTSLicense(),mnet:function(){return r.get_maxExpiredTime()},mxet:function(){return r.get_minExpiredTime()},fol:Ta.OnFirstOffline};if(o.dt=r.get_deploymentType(),i==Ta.EnumInstance.dwt_desktop){var a;if(""==r.get_cu())return Ot(a={}),Cn.Promise.reject({code:a._errorCode,message:a._errorString});o.lsu=r.get_cu()}else i==Ta.EnumInstance.dbr||(o.dwt=!0,""!=r.get_cu()&&(o.lsu=r.get_cu()),o.updateLicense=function(e){r.set_ar(e.ar),r.get_cu()||r.set_cu(e.cu),Ta.lsendUpdateEvt(i,t)});return r.get_ltsInstance(ya).i(o).then((function(e){return r.get_ar()||r.set_ar(e.ar),r.get_cu()||r.set_cu(e.cu),e}),(function(e){throw r.clearData(),e}))}function Da(){return Date.now()}function Oa(e){var n=e?new Date(e):new Date,t="yyyy-MM-ddTHH:mm:ss.SSSZ",r={"M+":n.getUTCMonth()+1,"d+":n.getUTCDate(),"H+":n.getUTCHours(),"h+":n.getUTCHours()%12||12,"m+":n.getUTCMinutes(),"s+":n.getUTCSeconds(),"q+":Math.floor((n.getUTCMonth()+3)/3),"S+":n.getUTCMilliseconds()};for(var i in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(n.getUTCFullYear()+"").substr(4-RegExp.$1.length))),r)new RegExp("("+i+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?r[i]:("000"+r[i]).substr(("000"+r[i]).length-RegExp.$1.length)));return t}function La(e){var n=this,t=e||{};n._id=t.id,n._containerID=(t.container?t.container.id:t.containerId)||"dwtcontrolContainer",n._containerElement=Cn.get(n._containerID),n._strWidth=t.width||270,n._strHeight=t.height||350,Cn.isString(n._strWidth)&&n._strWidth.indexOf("%")>0||(n._strWidth=[parseInt(n._strWidth),"px"].join("")),Cn.isString(n._strHeight)&&n._strHeight.indexOf("%")>0||(n._strHeight=[parseInt(n._strHeight),"px"].join("")),n._strObjectName=n._containerID+"_Obj",function(e,n){n&&Cn.each(["onAfterOperate","onBeforeOperate","onOperateStatus","onBitmapChanged","onGetFilePath","onImageAreaDeSelected","onImageAreaSelected","onMouseClick","onMouseDoubleClick","onMouseMove","onMouseRightClick","onPreAllTransfers","onPreTransfer","onPostLoad","onPostTransfer","onPostTransferAsync","onPreAllTransfersAsync","onPostAllTransfers","onSourceUIClose","onTopImageInTheViewChanged","onTransferCancelled","onTransferError","onInternetTransferPercentage","onInternetTransferPercentageEx","onRemoteScanStatusAsync","onKeyDown","onMouseWheel"],(function(t){e["__O"+t.substring(1)]=n[t]||""}))}(n,t),n.__OnAxReady=t.onAxReady,n.__OnAxNotInstalled=t.onAxNotInstalled,n.__OnRefreshUI=t.onRefreshUI||"",n._objectWebTwain=null,n._strDWTInnerContainerID=n._containerID+"_CID",n._strDWTNonInstallInnerContainerID=n._containerID+"_NonInstallCID",n.Addon={},n._pdfConvertMode=3,n._pdfOptions={convertMode:3,password:"",renderOptions:{renderAnnotations:!1,resolution:200,maxWidth:0,maxHeight:0,renderGrayscale:!1}},n._bAx=!0,Cn.UI.DWTAxViewer&&(n.Viewer=new Cn.UI.DWTAxViewer(n))}function Na(e){return e&&!An.isString(e)?$n:Zn}Ta.lgpd=function(e){return z.bWin&&e==Ta.EnumInstance.dwt_desktop?"dwt|dbr":"dwt"},Ta.lglic=Pa,Ta.lgbuuid=function(){return""},Ta.lshow=function(){return{t:ha,t2:ga,m:An.stringify(pa)}},Ta.lgct=function(e){switch(e){case 0:return"3011";case 1:return"3012";case 2:return"3014";case 3:return"3013";case 4:return"3015";case 14:return"3016";case 3001:return"3001";case 3002:return"3002";case 3003:return"3003";case 3004:return"3004";case 3005:return"3005";case 3006:return"3006";case 3007:return"3007";case 3008:return"3008";case 3009:return"3009";case 5001:return"5001";case 4001:return"4001";case 4002:return"4002";case 4003:return"4003"}return""},Ta.lcvrf=function(e){e&&(e._canConsume&&!e._canConsume()||setTimeout((function(){Ta.lcvrf_(e)}),1))},Ta.lcvrf_=function(e){var n;n=Ta.EnumInstance.dwt_desktop;var t,r=Ta.DeviceFriendlyName||"",i=Ta.lgcb(),o=Ca(n),a={hs:va(),og:ba(),cu:o.get_cu(),fn:r,cw:"",os:i,v:wa(),dt:o.get_deploymentType(),ed:"js"},s=function(e,n){var t,r,i=0;if(An.isString(e)&&""!=e&&"{}"!=e&&n&&An.isArray(n)&&!(n.length<1)){if(r=Ca(n[0]),t=An.parse(e),Ta.lclex(),0==ga){var o=Da(),a="";ga=o,ha=Oa(o),pa={},i=0,An.each(t,(function(e,n){(n<i||0==i)&&(i=n,a=e)})),i>0&&r.get_ltsInstance(ya).s(Yn.licenseServer,a,i,!0).then((function(){}),(function(e){}))}An.each(t,(function(e,n){var t=!1,o=parseInt(n);o>0&&o!=i&&(o+18e4<Da()&&(t=!0),r.get_ltsInstance(ya).s(Yn.licenseServer,e,n,t).then((function(){}),(function(e){})))}))}};if(a.pd=Ta.lgpd(n),t=An.stringify(a),!e._bAx){var u="GetBuffer",c=function(){for(var e=[],n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];if(t.length>0)if(1===t.length){var i=t[0];e.push("["),la(e,i),e.push("]")}else if(2===t.length){var o=t[0],a=t[1];e.push("["),la(e,o),e.push(","),la(e,a),e.push("]")}else la(e,Array.prototype.slice.call(t));return e.join("")}(An.replaceAll(t,'"','\\"')),l={cmd:u,cmdId:(++fa).toString(),sFun:s,fFun:function(){},params:[n]};return e._innerSendByWS(u,c,l,null,!0)}s(e.GetBuffer(t),[n,""])},Ta.lavrf=function(e,n,t,r){var i=1;if(""!=e){n>1&&(i=n);var o=Da();if(ga>0&&ga+18e4<o){ma?(pa={},Ta.lavrf__unload()):Ta.lavrf__(!0,t,r);var a=Da()+1;ga=a,ha=Oa(a),pa={}}_a=!0,ma=!1,pa[e]?pa[e]+=i:pa[e]=i,0==ga&&Ta.lavrf__(!0,t,r)}},Ta.lavrf_=function(e,n,t){if(_a){var r=1;e&&(r=e),setTimeout((function(){Ta.lavrf__(!1,n,t)}),r)}},Ta.lavrf__=function(e,n,t){var r,i,o,a=Da(),s=!1,u=!!e,c=0,l=n;An.isUndefined(l)&&(l=Ta.EnumInstance.dwt_desktop),o=Ca(l),_a=!1,0==ga&&(s=!0,ga=a,ha=Oa(a)),r=ga,i=ha;var f={};f.ut=i;var d={};if(An.each(pa,(function(e,n){d[n]=e,e>0&&c++})),f.cts=d,u||r+18e4<a){u=!0;var T=Da()+1;if(ga=T,ha=Oa(T),pa={},ma=!1,0==c)return}else{if(0==c)return;ma=!0}f.dur=s?1:180;var h,g=Ta.DeviceFriendlyName||"",p=Ta.lgcb(),_={hs:va(),og:ba(),cu:o.get_cu(),fn:g,cw:"",os:p,v:wa(),dt:o.get_deploymentType(),ed:"js",rcs:[f]};_.product=Ta.lgpd(n),h=An.stringify(_),Yn.ltsDebug&&Oa(),Ta.lclex(),o.get_ltsInstance(ya).s(Yn.licenseServer,h,""+r,u).then((function(){}),(function(e){}))},Ta.lavrf__unload=n(l.mark((function qa(){var e,n,t,r,i,o,a;return l.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(e=Da(),n=!0,r=!1,i=Ca(Ta.EnumInstance.dwt_desktop),o=Ca(Ta.EnumInstance.dbr),_a=!1,0==ga&&(ga=e,ha=Oa(e)),t=ga,a=Da()+1,ga=a,ha=Oa(a),pa={},ma=!1,t+=1,Ta.lclex(),!i.inited_ltsInstance()){s.next=20;break}return s.prev=13,s.next=16,i.get_ltsInstance(ya).s(Yn.licenseServer,r,""+t,n);case 16:s.next=20;break;case 18:s.prev=18,s.t0=s["catch"](13);case 20:if(!o.inited_ltsInstance()){s.next=28;break}return s.prev=21,s.next=24,o.get_ltsInstance(ya).s(Yn.licenseServer,r,""+t,n);case 24:s.next=28;break;case 26:s.prev=26,s.t1=s["catch"](21);case 28:case"end":return s.stop()}}),qa,null,[[13,18],[21,26]])}))),Ta.lclex=function(){var e=Ta.licenseException;e.code=0,e.message="",e.httpResponse="",e.fromLTS=!1},Ta.li=function(e,n){var t;if(e.axInstance&&(Ta.axInstance=e.axInstance,Ta.axInstance))return t=Ta.axInstance.GetUUID(),Yn.ltsDebug&&An.log("ActiveX cu: "+t),Ca(e.instanceMode).set_cu(t),t;return Ca(e.instanceMode).get_cu()},Ta.lfeab_ax=function(e){return new Cn.Promise((function(n,t){var r="";if(Ta.axInstance)try{r=Ta.axInstance.Encrypt(e,0)}catch(i){}n(r)}))},Ta.lfeab_wasm=function(e){return Cn.Promise.resolve("")},Ta.lwsproc=function(e,n){try{e=An.parse(e)}catch(t){return void(n.fFun&&n.fFun(t))}"GetBuffer"==e.method?n.sFun&&e.result.length>0?n.sFun(e.result[0],n.params):n.sFun("",n.params):n.sFun&&n.sFun(e)},Ta.lsexp=function(e,n,t){var r,i=n;if(3==(r=(i=An.replaceAll(i,"/","-")).split("-")).length){var o=r[0],a=r[1],s=r[2];a.length<2&&(a=(a="00"+a).substr(a.length-2)),s.length<2&&(s=(s="00"+s).substr(s.length-2)),i=[o,a,s].join("-")}var u=[i,"T23:59:59.999Z"].join("");Ca(e).set_minExpiredTime(u),Ca(e).set_maxExpiredTime(u)},Ta.lunload=n(l.mark((function Qa(){return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ta.lavrf__unload();case 2:ga=0,ha=An.nil,pa={},ma=!1,_a=!1,Sa=!1,Ia=!1,Ea=!1,Ta.lclex(),Ta.bLTSOnline=!0,Ta.axInstance=An.nil,Ta.lOnUpdateDWObj=[];case 14:case"end":return e.stop()}}),Qa)}))),Ta.lcexp=function(e,n){return Ca(e).get_ltsInstance(ya).caret().then((function(){return!1}),(function(e){var n=Ta.licenseException,t="";return e instanceof Error||"message"in e?t=e.message:An.isString(e)&&(t=e),Ta.lsetException(Aa.Expired,t,!1),Ia||(Ia=!0,An.error(t),Pn.OnLTSLicenseError&&Pn.OnLTSLicenseError(qi.getPublicLicenseContent(n.message),n.code)),!0}))},Ta.OnLicenseException=function(){var e=Ta.licenseException,n=e.message;if(An.isString(n)&&(n.indexOf("Error Code")>-1?n=An.replaceAll(n,"Error Code","error code"):n.indexOf("Error code")>-1&&(n=An.replaceAll(n,"Error code","error code"))),n.indexOf("(https://www.dynamsoft.com/purchase-center/)")>-1&&(n=n.replace("(https://www.dynamsoft.com/purchase-center/)","(https://www.dynamsoft.com/store/dynamic-web-twain/)"),e.message=n),n.indexOf("error code:")>-1){var t=n.substr(0,n.indexOf("message")),r=n.substr(n.indexOf("message"));t.indexOf("{")>-1&&(t=t.substr(t.indexOf("{")+1)),r.indexOf("}")>-1&&(r=r.substr(0,r.indexOf("}"))),t=An.replaceAll(t,"error code:",""),r=An.replaceAll(r,"message: ",""),Ta.lsetException(parseInt(t),r,!0),An.error(r),Pn.OnLTSLicenseError&&Pn.OnLTSLicenseError(qi.getPublicLicenseContent(n),e.code)}else{if(!e.code){var i=Aa.NetworkError;n.indexOf("timed out")>-1||n.indexOf("timeout")>-1?i=Aa.Timedout:(n.indexOf("access-control-allow-origin")>-1||n.indexOf("cors")>-1)&&(i=Aa.CorsError),Ta.lsetException(i,n,!0)}if(An.error(e.message),e.code==Aa.LtsJsLoadError)return;Pn.OnLTSLicenseError&&Pn.OnLTSLicenseError(qi.getPublicLicenseContent(e.message),e.code)}},Ta.lol=function(){return Ta.bLTSOnline},Ta.OnFirstOffline=function(e){Ta.bLTSOnline=!1},Ta.lpubdlg=function(e,n){if(An.isString(e)&&""!=e){if(e=An.atob(e),console&&console.warn,1==n)return Sa||(Sa=!0,Pn.OnLTSPublicLicenseWarning&&Pn.OnLTSPublicLicenseWarning(qi.getPublicLicenseContent(e))),!0;2==n&&(Sa||(Sa=!0))}return!1},Ta.lcheckLic=function(e,n,t){var r=!1;if(n){if(An.isArray(n.Detail)&&n.Detail.length>0){var i=n.Detail[0].ExpireDate;return Ta.lsexp(e,i,t),Ta.lcexp(e,t).then((function(e){var t=!1;e?t=!0:1!=n.Trial&&2!=n.Trial||(t=Ta.lpubdlg(n.Message,n.Trial)),t||Ta.bLTSOnline||Ea||(Ea=!0,Pn.OnLTSConnectionWarning&&Pn.OnLTSConnectionWarning())}))}1!=n.Trial&&2!=n.Trial||(r=Ta.lpubdlg(n.Message,n.Trial))}return r||Ta.bLTSOnline||Ea||(Ea=!0,Pn.OnLTSConnectionWarning&&Pn.OnLTSConnectionWarning()),Cn.Promise.resolve()},Ta.lisValidID=function(e){if(An.isString(e)&&""!=e)return!0;var n,t=Ta.licenseException;return Ta.lsetException(Aa.UUIDError,"Failed to generate an ID for your device to license it: not enough permission.",!0),An.error(t.message),n=t.message,Pn.OnLTSLicenseError&&Pn.OnLTSLicenseError(n,t.code),!1},Ta.lsetException=function(e,n,t){var r=Ta.licenseException;r.code=e,r.message=n,An.isUndefined(t)||(r.fromLTS=t)},Ta.lgcuid=function(e){var n=Pn.DWT.li({instanceMode:e},"");return n?Cn.Promise.resolve(n):Ca(e).get_ltsInstance(ya).u().then((function(e){return Pn.DWT.lsmid(e,""),Pn.DWT.lsmid2b(e),e}))},(Wa=La.prototype).getSWebTwain=function(){return this._objectWebTwain},Wa.getInstance=function(){return!!this._objectWebTwain&&this},Wa._createControl=function(){var e,n,t=this,r=t._strWidth,i=t._strHeight;if(Cn.isString(r)&&(r=r.indexOf("%")>0?"100%":parseInt(r)+2+"px"),Cn.isString(i)&&(i=i.indexOf("%")>0?"100%":parseInt(i)+2+"px"),n=['<div id="',t._strDWTInnerContainerID,'" style="width:',r,";height:",i,'">'],z.bIE)Pn.DWT.ActiveXInstallWithCAB?n.push('<object id="',t._strObjectName,'" style="width:',t._strWidth,";height:",t._strHeight,';border:1px solid #AAAAAA"',' codebase="',z.bWin64?Yn.getActiveXCABx64Path():Yn.getActiveXCABx86Path(),"#version=",Un.ActiveXVersion,'"',' classid="clsid:',Yn.strFullClassID,'" viewastext>','<param name="wmode" value="transparent"/>',"</object>"):n.push('<object id="',t._strObjectName,'" style="width:',t._strWidth,";height:",t._strHeight,';border:1px solid #AAAAAA"',' classid="clsid:',Yn.strFullClassID,'" viewastext>','<param name="wmode" value="transparent"/>',"</object>");else{var o=t._strWidth;Cn.isString(o)&&-1==o.indexOf("%")&&(o=parseInt(o)-2+"px"),n.push('<embed id="',t._strObjectName,'" style="display: inline; width:',o,";height:",t._strHeight,'" type="',Yn.strMIMEType,'"',' pluginspage="',z.bWin?Yn.getMSIPath():Yn.getPKGPath(),'"></embed>')}n.push('</div><div id="',t._strDWTNonInstallInnerContainerID,'" style="width: ',r,';display:none"></div>'),(e=t._containerElement)&&(e.innerHTML=n.join("")),t._objectWebTwain=Cn.get(t._strObjectName)},Wa._createNonAllowedDivPlugin=function(){var e=this,n=Cn.get(e._strDWTNonInstallInnerContainerID);if(""==n.innerHTML){var t=e._strHeight;Cn.isString(t)&&-1==t.indexOf("%")&&(t=parseInt(t)-10+"px");var r=['<div style="display: block; border:1px solid black; width:',e._strWidth,";height:",t,'">','<div style="margin: 200px 0 0 0; padding: 5px; font-size: 16px;line-height: 30px; ">',"<div>The Component is not allowed to run on this site.</div>",'<div>Please click <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJeSURBVDhPvZRNSxthEMeX0mNpKS09tP04tdBqobT9WCGJ5kU9pIk5xB4KaoJGmoiNMS+IUiqNB08mjUoUN2vU3WyS9d+ZIbvEZREP0j8Mk5ln5sfs7jxRcM/6f8BKpYKZmRlEIhGUSiUYhjE8uV2eQIal0xmobQ3aeQc/CwWUy+Xh6e3yBM7OzuJMbcPs9cUYzNPeRQLc29tDKpVCOBx2LJ3JQDe66Jo9fI3HEY1GnTOurdVqAnBLgFxwcNBAp3N5w0yTJiTTtA5UVXPy9XpDerwkwOnpaZydtWma/p3s8OgYcZraSwIMhULoXFx6NntZvf4XyWRSAG45QO38wrO51x/Asq7F27nbJMBEIoFm8wiLS0uYm0s6j88QfXUF6ucJXNMe2lAWx+qXD3I+KgHu7OwgEAjI/q2vr2N5eUUaebIWwRovFLTG38AaQtlzLPlP4wKyJcB8Pi83IpfLoVqtYmFh0ZnQ0nU0qHn/uSJ+0G7fiPl8VAL0+/20cyZdsTLm57+hdXIqQAdKE+1T869nCnZfK+I5dsNYAgwGg7i8MhwIG8cbG0Wafo1+X6FPk5VfPUDxqSK+r6oCcEuAU1NT0GhhDQLZVtwsIZvNShFPuDX+FqtPFORfPhS/9X5M8m4JkO/pyakKo0uwof3e/SMF3FQg2PfHCgoEMWlS9nbshgqQt755eIwr3RTYOV+vRlMK1j5OIPlIwY93YxgM39mAIBxzns9HJcDt7W3EYjH5OD6fD5OTk7KbrDo99go12TBbDOV8Peuxh5Zl0Z8ATUdFOjWy55jztt1VArw/Af8A9+n0bhYJ0I4AAAAASUVORK5CYII="/>','at the right end of the address bar and click "<b>Always allow plug-ins</b>". Then refresh/restart the browser.</div>',"</div></div>"].join("");n.innerHTML=r;for(var i=window.document,o=0;o<i.links.length;o++)"DWT_CloseNonAllowedDiv"==i.links[o].className&&(i.links[o].onclick=a)}function a(){Cn.get(e._strDWTNonInstallInnerContainerID).style.display="none",Cn.get(e._strDWTInnerContainerID).style.display="inline"}},Wa.__unload=Wa.dispose=function(){var e,n=this;if(n._containerElement)e=n._containerElement;else{var t=n._containerID;t&&(e=Cn.get(t))}e&&(e.innerHTML=""),this._containerElement=null,delete Pn.DWT.ContainerMap[n._containerID],delete Pn.DWT.WebTwainIdMap[n._id]},Wa._getErrorString=function(){return this._errorString},Cn.detect._controlDetect=function(){var e=Cn.detect.arySTwains,n=e[0],t=n&&n._objectWebTwain;if(t){var r,i=!1;if(z.bIE)r=!Pn.navInfo.bOSx64||Pn.navInfo.bWOW64?"DynamicPdfCore_"+Un.ActiveXPdfVersion+".dll":"DynamicPdfCorex64_"+Un.ActiveXPdfVersion+".dll",0==t.ErrorCode&&""!=t.GetAddOnVersion("pdf",r)&&(i=!0);else 0==t.ErrorCode&&(i=!0);if(i){clearInterval(Cn.detect._varSeed);var o=function(n,t,r){var i,o;for(i=0;i<e.length;i++)o=e[i],Cn.attachProperty(o),Cn.attachMethod(o),o._attachEvents(),Cn.detect.ssl&&(o.IfSSL=!0,o.HTTPPort=443),0==n?o.GetLicenseInfo(t).then((function(e){e&&o._setConvertMode(o._pdfConvertMode)})):(o._blts=!0,""!=t&&""!=r?(o.SetLTSInfo(t,r),o.GetLicenseInfo().then((function(e){return e&&o._setConvertMode(o._pdfConvertMode),Pn.DWT.lcheckLic(Pn.DWT.EnumInstance.dwt_desktop,e,"")}))):o.__licenseInfo={LTS:!0,Detail:[]},Pn.DWT.laddDWTObj(o)),Cn.attachAddon(o),o._objectWebTwain.BrokerProcessType=Yn._iBrokerProcessType,z.bWin||(o._objectWebTwain.ImageCaptureDriverType=Yn._iImageCaptureDriverType),Cn.isFunction(o.__OnAxReady)&&o.__OnAxReady()};if(Ct()){var a=Pn.DWT.li({instanceMode:Pn.DWT.EnumInstance.dwt_desktop,axInstance:t},"");if(!Pn.DWT.lisValidID(a))return void o(1,"","");Pa(Pn.DWT.EnumInstance.dwt_desktop,"").then((function(e){o(1,e.ar,e.cu)}),(function(e){e&&(Pn.DWT.lsetException(e.code||e.ltsErrorCode,e.message,!0),Pn.DWT.OnLicenseException()),o(1,"","")}))}else o(0,Pn.DWT.ProductKey,"")}else Cn.detect.bNoControlEvent||(Cn.noControl(n),Cn.detect.bNoControlEvent=!0),Cn.isFunction(n.__OnAxNotInstalled)&&n.__OnAxNotInstalled()}else clearInterval(Cn.detect._varSeed)},Cn.ie={},Cn.ie.DynamicWebTwain=function(e){var n=new La(e);return n._createControl(),Cn.detect.arySTwains.push(n),n},Cn.ie.closeAll=function(){var e,n,t,r=Cn.detect.arySTwains;for(e=0;e<r.length;e++)(n=r[e])&&n._objectWebTwain&&(t=n._objectWebTwain)&&0==t.ErrorCode&&t.RemoveAllImages();Cn.detect.arySTwains=[]},Cn.closeAll=Cn.ie.closeAll,Pn.DWT.RemoveAllAuthorizations=function(){return!1},Pn.DWT.GetWebTwain=Pn.DWT.GetWebTwainEx=function(e){var n=e,t=Pn.DWT.WebTwainIdMap;if(!n){var r=Object.keys(t);return r.length>0?t[n=r[0]]:void 0}if(n in t)return t[n];var i=Pn.DWT.ContainerMap;return n in i?i[n]:void 0};var Ra=!1;function xa(e,n){return Fa.apply(this,arguments)}function Fa(){return(Fa=n(l.mark((function e(n,t){var r,i;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&vi(wi),qi.isLicenseMixed(null,!0)||qi.reparseProductKey(t),0==(r=Pn.DWT.licenseException).code){e.next=6;break}throw n&&$i(r),{code:r.code,message:r.message};case 6:if(Ra){e.next=14;break}if(i=!1,z.bIE&&(i=z.IEVersion<=7),i||!Ct()){e.next=14;break}if(!Pn.DWT.bChromeExtension){e.next=13;break}return Ra=!0,e.abrupt("return");case 13:return e.abrupt("return",new Cn.Promise((function(e,n){var t=Pn.DWT.ResourcesPath,r="";z.bFileSystem||(r=Cn.timestamp),An.addScript([t,"/src/dynamsoft.lts.js",r].join(""),!0,!1,(function(t){if(Pn.LTS&&Pn.LTS._)return Ra=!0,void e();if(t){if(z.bIE)return void n({code:-2822,message:"The WebTwain JavaScript lts.js load failed."});if("error"==t.type)return void n({code:-2822,message:"The WebTwain JavaScript lts.js load failed."})}Ra=!0,e()}))})));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ka,Ma=window;Ma.console=Ma.console||((ka={}).log=ka.warn=ka.debug=ka.info=ka.error=ka.time=ka.dir=ka.profile=ka.clear=ka.exception=ka.trace=ka.assert=function(){},ka),Pn.DWT.OnBeforeUnload=function(e){Cn.page.bUnload=!0,Pn.DWT.Unload(e)},Ma.addEventListener("beforeunload",(function(e){if(Cn.isFunction(Pn.DWT.OnBeforeUnload))return Pn.DWT.OnBeforeUnload(e)}));var Ba,Ga,Ua=function(e){var n=e.VersionInfo;if(!Cn.detect.bNeedUpgradeEvent&&!function(e){if(An.isUndefined(e))return!1;var n,t,r=qn(e.toString().toLowerCase());n=Yn.bActiveXEdition?Un.ActiveXVersion:Yn.getServerVersionInfo(!0),t=(n=An.replaceAll(String(n),"[.]",",")).split(",");for(var i=r.length>t.length?r.length:t.length,o=0;o<i;o++){if(null==r[o]&&(r[o]=0),null==t[o]&&(t[o]=0),parseInt(r[o])<parseInt(t[o]))return!1;if(parseInt(r[o])>parseInt(t[o]))return!0}return!0}(n)){if(Cn.detect.bNeedUpgradeEvent=$n,Cn.isFunction(Pn.DWT.OnWebTwainNeedUpgrade)&&Pn.DWT.OnWebTwainNeedUpgrade())return;var t=e._containerElement;t&&(Cn.one(t).before(Cn.install._strNonInstallDIV),Cn.show(Cn.install._divDWTNonInstallContainerID),Cn.hide(t)),""!=Cn.install._divDWTemessageContainer&&Cn.hide(Cn.install._divDWTemessageContainer),function(e,n){if(Cn.isFunction(Pn.OnWebTwainNeedUpgradeCallback)){var t,r,i={};z.bWin&&(r=z.bIE||Cn.product.bHTML5Edition?jn.getDSPath():Cn.product.getMSIPath(),t=Gn.enumWindow),i["default"]=r;var o=Cn.one(".dynamsoft-dialog-license");o&&o.getEL()&&(o.getEL().style.display="none"),Cn.detect.needUpgrade=$n,Pn.OnWebTwainNeedUpgradeCallback(Cn.product.name,i,Cn.product.bHTML5Edition,t,z.bIE,z.bSafari,Cn.detect.ssl,ho.strIEVersion,Cn.detect.bPromptJSOrServerOutdated,e,n)}}()}};function Ha(e){var n=!0,t="";e.__licenseInfo&&(n=e.__licenseInfo.bTrial,e.__licenseInfo.ExpireDate&&(t=e.__licenseInfo.ExpireDate));var r=function(e){if(""==e)return 65536;var n=Qi(e),t=(new Date).getTime(),r=(n.getTime()-t)/864e5;return n.getTime()<t?0:Math.ceil(r)}(t);r<=0&&(n||Mn(e._getErrorString()),An.isFunction(Pn.OnLicenseExpiredWarning)&&Pn.OnLicenseExpiredWarning(t,r,n))}function ja(){var e,n,t,r,i,o=Pn.DWT.Containers,a=Pn.DWT.licenseException;if(o&&o.length>0){for(0==a.code?Ma.DCP_DWT_OnClickCloseInstall&&Ma.DCP_DWT_OnClickCloseInstall(!1,!0):Cn.error(a.message),n=0;n<o.length;n++)if(o[n].Container?r=o[n].Container:o[n].ContainerId&&(r=Cn.get(o[n].ContainerId)),Na(r)&&r.id){if(i=Pn.DWT.ContainerMap[r.id])break;if(t=o[n].WebTwainId,i=Pn.DWT.WebTwainIdMap[t])break}i&&Ua(i)}var s=!1,u=!1;for(Ct()&&Cn.isNumber(a.code)&&0!==a.code&&!0===a.fromLTS&&(s=!0),n=0;n<o.length;n++)t=o[n].ContainerId,(e=Pn.DWT.ContainerMap[t])||(t=o[n].WebTwainId,e=Pn.DWT.WebTwainIdMap[t]),e&&(s?Cn.hide(e._containerElement):(e.IfAllowLocalCache=!0,e.IfShowFileDialog=!0,e.IfDisableSourceAfterAcquire=!0,e.BrokerProcessType=Cn.product._iBrokerProcessType,0==n&&e.__licenseInfo&&(qi.checkProductKey(e,{Core:!0})||z.bWin&&qi.checkProductKey(e,{Webcam:!0},!0)||(u?Cn.hide(e._containerElement):qi.checkProductKey(e,{Core:!0},!1)||(Cn.hide(e._containerElement),i=e,u=!0))))),e=null;o=null,u&&(i._errorCode==Et.LicenseExpired?Ha(i):eo(i)),s?(Pn.DWT.WebTwainIdMap={},Pn.DWT.ContainerMap={},Cn.detect.arySTwains.splice(0)):setTimeout((function(){try{Cn.isFunction(Pn.DWT.OnWebTwainReady)?Pn.DWT.OnWebTwainReady():Cn.isFunction(Ma.Dynamsoft_OnReady)&&Ma.Dynamsoft_OnReady()}catch(e){Mn(e)}}),100)}function Va(e,n,t){var r,i,o,a,s,u={id:e.WebTwainId,width:e.Width,height:e.Height};if(e.ContainerId?(u.container=Cn.get(e.ContainerId),u.containerId=e.ContainerId):e.Container&&(u.container=e.Container,u.containerId=e.Container.id),(""==(r=u.id)||!An.isString(r)&&!An.isNumber(r)?Zn:$n)||(u.id=["dwt_",An.getRandom()].join("")),function(e){var n=e||{};n.basePath&&(ho.basePath=n.basePath),n.pathType&&(ho.pathType=n.pathType),An.isUndefined(n.bDiscardBlankImage)||(ho.bDiscardBlankImage=n.bDiscardBlankImage),n.msgPrefix&&n.msgPrefix,n.msgSuffix&&n.msgSuffix,n.detectType&&(Cn.detect.detectType=n.detectType),n.tryTimes&&(Cn.detect.tryTimes=n.tryTimes);var t=Pn.DWT.RemoteScanConfig;t||(t={sessionTimeout:300,keepAwake:!0},Pn.DWT.RemoteScanConfig=t),t.keepAwake===undefined&&(t.keepAwake=!0)}(u),u.onAxReady=function(){if(Pn.DWT.ContainerMap[u.containerId]=i.getInstance(),Pn.DWT.WebTwainIdMap[u.id]=i.getInstance(),Cn.isFunction(n)){var e={stwain:i.getInstance(),bError:!1};n(e)}},u.onAxNotInstalled=function(){var e={};!function(e){Wt(e,-2800,wt.ErrStr_Service_NOT_INSTALLED)}(e),Cn.isFunction(t)&&t({code:e._errorCode,message:e._errorString})},i=new Cn.ie.DynamicWebTwain(u),a=0,s=Pn.DWT.Containers)for(o=s.length-1;o>=0;o--){var c=s[o];c.Container?Na(c.Container)&&a++:c.ContainerId&&Na(Cn.get(c.ContainerId))&&a++}return Cn.detect.arySTwains.length==a&&(Cn.detect._varSeed=setInterval(Cn.detect._controlDetect,200)),i}function Xa(){if(!Cn.detect.axAutoLoadDone){var e,n=Pn.DWT.Containers;if(n)for(e=0;e<n.length;e++){var t=void 0;if(Na(Cn.get(n[e].ContainerId))&&(t=n[e].ContainerId),t)if(!Pn.DWT.ContainerMap[t])return void setTimeout(Xa,200)}n=null,ja(),Cn.detect.axAutoLoadDone=!0,Ba()}}Pn.DWT._innerLoad=n(l.mark((function Za(){var e,n,t,r;return l.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return Cn.page.bUnload=Zn,i.next=3,xa(!0,!1);case 3:if(e=Pn.DWT.Containers,n=$n,e&&0!==e.length){i.next=7;break}return Cn.log("Dynamsoft.DWT.Containers was not set."),i.abrupt("return",Zn);case 7:for(t=0;t<e.length;t++)r=e[t],!Cn.isString(r.WebTwainId)||Cn.isString(r.ContainerId)&&""!=r.ContainerId||(r.ContainerId=r.WebTwainId),a=void 0,s=void 0,(o=r).ContainerId?a=o.ContainerId:o.Container&&(a=o.Container.id),(Na(Cn.get(a))?((s=Pn.DWT.ContainerMap[a])||Cn.isString(o.WebTwainId)&&(s=Pn.DWT.WebTwainIdMap[o.WebTwainId]),s?Zn:$n):Zn)&&Va(r,(function(){}),(function(e){n&&(Zi(e),n=!1),Ga(e),Cn.detect.axAutoLoadDone=!0}));return i.abrupt("return",Cn.detect.axAutoLoadDone?Cn.Promise.resolve():new Cn.Promise((function(e,n){Ba=e,Ga=n,setTimeout(Xa,200)})));case 9:case"end":return i.stop()}var o,a,s}),Za)})));var Ka=Pn.DWT.ShowMessage;Pn.DWT.ShowMessage=function(e,n){var t=Ka(e,n),r=document.createElement("iframe");r.frameborder="0",r.marginheight="0",r.marginwidth="0",r.style.border="0",r.style.backgroundColor="transparent",r.style.position="absolute",r.style.left=0,r.style.top=0,r.style.width="100%",r.style.height=document.body.clientHeight+"px",r.style.margin="0 auto",r.style.zIndex="10000",r.src=["javas","cript:",'""'].join("");var i=Pn.Lib.one(".dynamsoft-backdrop");return i&&i.length>0&&(i[0].innerHTML="",i[0].style.zIndex="10000",i[0].appendChild(r)),t}}();
